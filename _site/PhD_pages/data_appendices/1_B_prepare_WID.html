<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Joe Hasell - Appendix 1.B: Preparing WID inequality data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Appendix 1.B: Preparing WID inequality data</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Joe Hasell</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">DPhil: Triangulating the key facts about global income distribution</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Papers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/overview.html" class="sidebar-item-text sidebar-link">Overview of papers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/paper1.html" class="sidebar-item-text sidebar-link">Paper 1: Triangulating trends in inequality around the world from secondary databases</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/paper3.html" class="sidebar-item-text sidebar-link">Paper 3: Housing and the capital share of income</a>
  </div>
</li>
          <li class="sidebar-item">
  PhD_pages/paper_pages/test_page.qmd
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Data appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Paper 1</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_A_prepare_PIP.html" class="sidebar-item-text sidebar-link">Appendix 1.A: Preparing PIP inequality data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_B_prepare_WID.html" class="sidebar-item-text sidebar-link active">Appendix 1.B: Preparing WID inequality data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_C_prepare_LIS.html" class="sidebar-item-text sidebar-link">Appendix 1.C: Preparing LIS inequality data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_D_prepare_population.html" class="sidebar-item-text sidebar-link">Appendix 1.D: Preparing population data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_E_prepare_region_classifications.html" class="sidebar-item-text sidebar-link">Appendix 1.E: Preparing region classifications</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_F_within_country_trends.html" class="sidebar-item-text sidebar-link">Appendix 1.F: Analysing global trends in within-country inequality</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Paper 3</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/3_A_prepare_KLEMS.html" class="sidebar-item-text sidebar-link">Appendix 3.A: Preparing EU KLEMS industry data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/3_B_prepare_OECD.html" class="sidebar-item-text sidebar-link">Appendix 3.B: Preparing OECD industry data</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Presentations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../presentations/DSPI_CSP_masters_Jan2023/DSPI_CSP_masters_Jan2023.html" class="sidebar-item-text sidebar-link">From $1.90 to $2.15: the updated International Poverty Line</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">About this site</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../how_to.html" class="sidebar-item-text sidebar-link">How I built this site</a>
  </div>
</li>
          <li class="sidebar-item">
  test_pages/test_passing_r_to_python.qmd
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../test_pages/test_with_shinylive.html" class="sidebar-item-text sidebar-link">Shinylive in Quarto example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../test_pages/test_with_iframe_shiny.html" class="sidebar-item-text sidebar-link">A test notebook with Shiny app mbedded as an iframe</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../test_pages/test_with_ipywidgets.html" class="sidebar-item-text sidebar-link">Ipywidgets in Quarto example</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Appendix 1.B: Preparing WID inequality data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Packages and settings
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Load WID data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We load the data from a file prepared from the WID Stata package by Our World in Data.</p>
<p>The data was prepared in three separate files according to three income concepts: post_tax disposable income, post_tax national income and pretax national income.</p>
<p>These we append into a single file.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_wid&lt;- read.csv("https://raw.githubusercontent.com/owid/notebooks/main/BetterDataDocs/PabloArriagada/WID/data/final/wid_pretax.csv")</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>inc_concepts <span class="op">=</span> [</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'posttax_dis'</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'posttax_nat'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'pretax'</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># filepaths = [f'data/original/wid_{inc_concept}.csv' for inc_concept in inc_concepts]</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>filepaths <span class="op">=</span> [<span class="ss">f'https://raw.githubusercontent.com/owid/notebooks/main/BetterDataDocs/PabloArriagada/WID/data/final/wid_</span><span class="sc">{</span>inc_concept<span class="sc">}</span><span class="ss">.csv'</span> <span class="cf">for</span> inc_concept <span class="kw">in</span> inc_concepts]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>wid_dfs <span class="op">=</span> [pd.read_csv(filepath) <span class="cf">for</span> filepath <span class="kw">in</span> filepaths]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> pd.concat(wid_dfs, keys<span class="op">=</span>inc_concepts)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidy up indexes</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.reset_index()</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.drop(<span class="st">'level_1'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid<span class="op">\</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  .rename(columns<span class="op">=</span>{<span class="st">"level_0"</span>: <span class="st">"inc_concept"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting dataframe looks like this:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df_wid.head(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>inc_concept</th>
      <th>Entity</th>
      <th>Year</th>
      <th>Gini coefficient</th>
      <th>Palma ratio (S90/S40 ratio)</th>
      <th>S90/S10 ratio</th>
      <th>S80/S20 ratio</th>
      <th>S90/S50 ratio</th>
      <th>P90/P10 ratio</th>
      <th>P90/P50 ratio</th>
      <th>...</th>
      <th>P50 - income threshold (median)</th>
      <th>P60 - income threshold</th>
      <th>P70 - income threshold</th>
      <th>P80 - income threshold</th>
      <th>P90 - income threshold of the top 10%</th>
      <th>P99.999 - income threshold of the top 0.001%</th>
      <th>P99.99 - income threshold of the top 0.01%</th>
      <th>P99.9 - income threshold of the top 0.1%</th>
      <th>P99 - income threshold of the top 1%</th>
      <th>P0-P40 - share of the bottom 40%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>1996</td>
      <td>0.443678</td>
      <td>2.422797</td>
      <td>-333.000000</td>
      <td>25.670330</td>
      <td>1.490303</td>
      <td>25.732002</td>
      <td>2.317264</td>
      <td>...</td>
      <td>5598.351958</td>
      <td>6677.413311</td>
      <td>8006.281754</td>
      <td>9828.944789</td>
      <td>12972.860259</td>
      <td>3.422160e+05</td>
      <td>1.510025e+05</td>
      <td>6.662973e+04</td>
      <td>29400.308601</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2002</td>
      <td>0.457921</td>
      <td>2.658412</td>
      <td>-518.833310</td>
      <td>27.597702</td>
      <td>1.622199</td>
      <td>22.376900</td>
      <td>2.413228</td>
      <td>...</td>
      <td>6694.514303</td>
      <td>7975.635075</td>
      <td>9737.097324</td>
      <td>12066.302508</td>
      <td>16155.386192</td>
      <td>4.734979e+05</td>
      <td>2.035016e+05</td>
      <td>8.746166e+04</td>
      <td>37589.584734</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2005</td>
      <td>0.450608</td>
      <td>2.535596</td>
      <td>-3063.000000</td>
      <td>25.782608</td>
      <td>1.554034</td>
      <td>21.295458</td>
      <td>2.335103</td>
      <td>...</td>
      <td>7686.136668</td>
      <td>9047.728429</td>
      <td>10957.297531</td>
      <td>13599.462132</td>
      <td>17947.917954</td>
      <td>5.249345e+05</td>
      <td>2.257264e+05</td>
      <td>9.706431e+04</td>
      <td>41738.495620</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2008</td>
      <td>0.449409</td>
      <td>2.516900</td>
      <td>-1526.500000</td>
      <td>26.379889</td>
      <td>1.544259</td>
      <td>23.671341</td>
      <td>2.287115</td>
      <td>...</td>
      <td>8896.834378</td>
      <td>10535.777463</td>
      <td>12746.381573</td>
      <td>15715.719306</td>
      <td>20348.079121</td>
      <td>6.605182e+05</td>
      <td>2.767225e+05</td>
      <td>1.159322e+05</td>
      <td>48569.517624</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2012</td>
      <td>0.448045</td>
      <td>2.490733</td>
      <td>441.571440</td>
      <td>23.009708</td>
      <td>1.545500</td>
      <td>20.856731</td>
      <td>2.309005</td>
      <td>...</td>
      <td>9237.230442</td>
      <td>10833.767569</td>
      <td>13111.034275</td>
      <td>16134.512223</td>
      <td>21328.810393</td>
      <td>7.254662e+05</td>
      <td>3.004032e+05</td>
      <td>1.243918e+05</td>
      <td>51508.541439</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2015</td>
      <td>0.454367</td>
      <td>2.561644</td>
      <td>99.343750</td>
      <td>18.937500</td>
      <td>1.614525</td>
      <td>14.074163</td>
      <td>2.474667</td>
      <td>...</td>
      <td>9373.105143</td>
      <td>11023.116961</td>
      <td>13685.740204</td>
      <td>16946.858143</td>
      <td>23195.315519</td>
      <td>7.946113e+05</td>
      <td>3.284476e+05</td>
      <td>1.357618e+05</td>
      <td>56116.281830</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2016</td>
      <td>0.461121</td>
      <td>2.696459</td>
      <td>71.066666</td>
      <td>19.140625</td>
      <td>1.690275</td>
      <td>16.278803</td>
      <td>2.567514</td>
      <td>...</td>
      <td>9639.325184</td>
      <td>11562.745214</td>
      <td>14300.537763</td>
      <td>17777.603581</td>
      <td>24749.103918</td>
      <td>7.507099e+05</td>
      <td>3.198851e+05</td>
      <td>1.363063e+05</td>
      <td>58081.474818</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2017</td>
      <td>0.454116</td>
      <td>2.577143</td>
      <td>68.630432</td>
      <td>18.078358</td>
      <td>1.624807</td>
      <td>15.629199</td>
      <td>2.510383</td>
      <td>...</td>
      <td>9978.637893</td>
      <td>11909.588865</td>
      <td>14669.536394</td>
      <td>18131.390209</td>
      <td>25050.198975</td>
      <td>7.536452e+05</td>
      <td>3.217940e+05</td>
      <td>1.374007e+05</td>
      <td>58667.844949</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>posttax_dis</td>
      <td>Albania</td>
      <td>2018</td>
      <td>0.447469</td>
      <td>2.472930</td>
      <td>72.232559</td>
      <td>17.850746</td>
      <td>1.562374</td>
      <td>15.320574</td>
      <td>2.447565</td>
      <td>...</td>
      <td>10459.202046</td>
      <td>12392.437320</td>
      <td>15164.734593</td>
      <td>18848.563541</td>
      <td>25599.579922</td>
      <td>7.440504e+05</td>
      <td>3.204498e+05</td>
      <td>1.380122e+05</td>
      <td>59439.508772</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2004</td>
      <td>0.326530</td>
      <td>1.334253</td>
      <td>8.267806</td>
      <td>4.805300</td>
      <td>0.984396</td>
      <td>3.096185</td>
      <td>1.762371</td>
      <td>...</td>
      <td>35286.670484</td>
      <td>39035.236480</td>
      <td>43363.663231</td>
      <td>49921.128086</td>
      <td>62188.220292</td>
      <td>2.431403e+06</td>
      <td>1.320109e+06</td>
      <td>7.774640e+05</td>
      <td>211588.042089</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2005</td>
      <td>0.345903</td>
      <td>1.465773</td>
      <td>9.363914</td>
      <td>5.291109</td>
      <td>1.077410</td>
      <td>3.403942</td>
      <td>1.855844</td>
      <td>...</td>
      <td>34716.135165</td>
      <td>38197.112972</td>
      <td>42718.653949</td>
      <td>49946.254954</td>
      <td>64427.749511</td>
      <td>3.612437e+06</td>
      <td>1.702892e+06</td>
      <td>7.095053e+05</td>
      <td>248950.528592</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2006</td>
      <td>0.367595</td>
      <td>1.633964</td>
      <td>10.285267</td>
      <td>5.700629</td>
      <td>1.200512</td>
      <td>3.426140</td>
      <td>1.898158</td>
      <td>...</td>
      <td>34663.420551</td>
      <td>38676.077697</td>
      <td>43407.700010</td>
      <td>50532.721225</td>
      <td>65796.645717</td>
      <td>4.996613e+06</td>
      <td>3.172447e+06</td>
      <td>1.139762e+06</td>
      <td>242768.542032</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2007</td>
      <td>0.350346</td>
      <td>1.488813</td>
      <td>9.656152</td>
      <td>5.438356</td>
      <td>1.093214</td>
      <td>3.486120</td>
      <td>1.921174</td>
      <td>...</td>
      <td>36767.860475</td>
      <td>41341.468466</td>
      <td>47024.544231</td>
      <td>54943.652176</td>
      <td>70637.453336</td>
      <td>1.698754e+06</td>
      <td>1.433770e+06</td>
      <td>8.638599e+05</td>
      <td>247555.469358</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2008</td>
      <td>0.347730</td>
      <td>1.468288</td>
      <td>9.652038</td>
      <td>5.304982</td>
      <td>1.084155</td>
      <td>3.364637</td>
      <td>1.913161</td>
      <td>...</td>
      <td>37081.428241</td>
      <td>41027.512140</td>
      <td>46463.463867</td>
      <td>54460.542813</td>
      <td>70942.731826</td>
      <td>8.245163e+06</td>
      <td>2.147393e+06</td>
      <td>7.680208e+05</td>
      <td>221238.961102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2009</td>
      <td>0.335487</td>
      <td>1.370213</td>
      <td>9.288462</td>
      <td>5.154689</td>
      <td>1.006250</td>
      <td>3.405491</td>
      <td>1.881750</td>
      <td>...</td>
      <td>34889.950919</td>
      <td>38569.223749</td>
      <td>43501.083884</td>
      <td>51367.088655</td>
      <td>65654.173788</td>
      <td>9.567820e+06</td>
      <td>1.983310e+06</td>
      <td>5.631204e+05</td>
      <td>205141.575820</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2010</td>
      <td>0.339232</td>
      <td>1.411793</td>
      <td>9.365931</td>
      <td>5.190012</td>
      <td>1.035216</td>
      <td>3.315426</td>
      <td>1.846056</td>
      <td>...</td>
      <td>35778.198642</td>
      <td>39896.932616</td>
      <td>44373.141615</td>
      <td>51523.937298</td>
      <td>66048.561994</td>
      <td>1.400596e+06</td>
      <td>1.400468e+06</td>
      <td>1.184037e+06</td>
      <td>206816.527636</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2011</td>
      <td>0.332465</td>
      <td>1.364235</td>
      <td>9.174050</td>
      <td>5.098540</td>
      <td>0.998278</td>
      <td>3.253533</td>
      <td>1.789999</td>
      <td>...</td>
      <td>37501.331875</td>
      <td>41360.248857</td>
      <td>46049.906710</td>
      <td>53181.015363</td>
      <td>67127.333543</td>
      <td>7.742503e+06</td>
      <td>2.371002e+06</td>
      <td>7.773831e+05</td>
      <td>210209.431887</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2012</td>
      <td>0.314739</td>
      <td>1.235832</td>
      <td>8.450000</td>
      <td>4.772674</td>
      <td>0.907687</td>
      <td>3.301658</td>
      <td>1.836239</td>
      <td>...</td>
      <td>37611.682860</td>
      <td>41727.696916</td>
      <td>46606.971956</td>
      <td>54286.468019</td>
      <td>69064.045150</td>
      <td>4.139564e+06</td>
      <td>1.108600e+06</td>
      <td>4.574044e+05</td>
      <td>183772.599610</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2013</td>
      <td>0.310547</td>
      <td>1.219973</td>
      <td>7.929824</td>
      <td>4.594071</td>
      <td>0.898906</td>
      <td>3.165626</td>
      <td>1.805434</td>
      <td>...</td>
      <td>37121.320382</td>
      <td>41132.034729</td>
      <td>45785.167960</td>
      <td>53036.989193</td>
      <td>67020.091036</td>
      <td>2.418154e+06</td>
      <td>1.461007e+06</td>
      <td>6.258436e+05</td>
      <td>184835.958287</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2014</td>
      <td>0.324911</td>
      <td>1.323705</td>
      <td>8.491177</td>
      <td>4.828107</td>
      <td>0.974350</td>
      <td>3.100024</td>
      <td>1.764432</td>
      <td>...</td>
      <td>36268.820161</td>
      <td>40043.031105</td>
      <td>44370.680736</td>
      <td>51127.735812</td>
      <td>63993.857724</td>
      <td>3.006590e+06</td>
      <td>1.731662e+06</td>
      <td>8.180580e+05</td>
      <td>201882.465663</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2015</td>
      <td>0.310730</td>
      <td>1.226906</td>
      <td>8.290909</td>
      <td>4.648899</td>
      <td>0.901780</td>
      <td>3.050093</td>
      <td>1.711939</td>
      <td>...</td>
      <td>36770.062314</td>
      <td>40566.421167</td>
      <td>44807.940041</td>
      <td>50986.688602</td>
      <td>62948.113758</td>
      <td>1.168543e+06</td>
      <td>1.159790e+06</td>
      <td>8.295021e+05</td>
      <td>201581.461331</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>posttax_dis</td>
      <td>Austria</td>
      <td>2016</td>
      <td>0.330063</td>
      <td>1.350535</td>
      <td>9.251593</td>
      <td>5.032491</td>
      <td>0.990116</td>
      <td>3.163156</td>
      <td>1.756769</td>
      <td>...</td>
      <td>36751.411444</td>
      <td>40493.371923</td>
      <td>45240.407108</td>
      <td>51834.526105</td>
      <td>64563.745444</td>
      <td>2.149281e+06</td>
      <td>1.742189e+06</td>
      <td>9.534938e+05</td>
      <td>198458.606147</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>22</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1980</td>
      <td>0.323922</td>
      <td>1.247872</td>
      <td>11.590697</td>
      <td>5.407459</td>
      <td>0.899964</td>
      <td>3.839829</td>
      <td>1.797241</td>
      <td>...</td>
      <td>1639.240511</td>
      <td>1994.820908</td>
      <td>2171.272102</td>
      <td>2437.436675</td>
      <td>2946.110056</td>
      <td>1.765769e+05</td>
      <td>5.606848e+04</td>
      <td>1.840047e+04</td>
      <td>6626.441560</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1981</td>
      <td>0.323916</td>
      <td>1.247872</td>
      <td>11.590697</td>
      <td>5.407459</td>
      <td>0.899964</td>
      <td>3.839418</td>
      <td>1.797382</td>
      <td>...</td>
      <td>1636.711278</td>
      <td>1991.845340</td>
      <td>2168.147755</td>
      <td>2433.865994</td>
      <td>2941.795482</td>
      <td>1.763219e+05</td>
      <td>5.598621e+04</td>
      <td>1.837309e+04</td>
      <td>6616.473407</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1982</td>
      <td>0.323933</td>
      <td>1.247872</td>
      <td>11.590697</td>
      <td>5.407459</td>
      <td>0.899964</td>
      <td>3.839744</td>
      <td>1.797327</td>
      <td>...</td>
      <td>1636.264943</td>
      <td>1991.101448</td>
      <td>2167.552641</td>
      <td>2432.973323</td>
      <td>2940.902812</td>
      <td>1.762545e+05</td>
      <td>5.596835e+04</td>
      <td>1.836818e+04</td>
      <td>6614.836844</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1983</td>
      <td>0.323813</td>
      <td>1.247371</td>
      <td>11.586046</td>
      <td>5.406077</td>
      <td>0.899603</td>
      <td>3.840825</td>
      <td>1.797468</td>
      <td>...</td>
      <td>1633.735710</td>
      <td>1989.018550</td>
      <td>2164.428295</td>
      <td>2429.700198</td>
      <td>2936.588238</td>
      <td>1.760670e+05</td>
      <td>5.588861e+04</td>
      <td>1.833679e+04</td>
      <td>6602.934572</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1984</td>
      <td>0.332829</td>
      <td>1.310010</td>
      <td>11.930233</td>
      <td>5.586014</td>
      <td>0.944404</td>
      <td>3.875636</td>
      <td>1.842521</td>
      <td>...</td>
      <td>1600.409346</td>
      <td>1958.667755</td>
      <td>2149.848011</td>
      <td>2431.634317</td>
      <td>2948.788067</td>
      <td>1.966119e+05</td>
      <td>6.113870e+04</td>
      <td>1.959516e+04</td>
      <td>6855.560310</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1985</td>
      <td>0.329238</td>
      <td>1.283461</td>
      <td>11.785047</td>
      <td>5.511142</td>
      <td>0.923810</td>
      <td>3.874683</td>
      <td>1.827472</td>
      <td>...</td>
      <td>1616.031079</td>
      <td>1975.926051</td>
      <td>2162.940511</td>
      <td>2451.273067</td>
      <td>2953.251420</td>
      <td>1.812664e+05</td>
      <td>5.725261e+04</td>
      <td>1.868121e+04</td>
      <td>6684.465140</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>28</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1986</td>
      <td>0.330885</td>
      <td>1.283854</td>
      <td>11.850962</td>
      <td>5.697540</td>
      <td>0.914996</td>
      <td>4.151808</td>
      <td>1.839873</td>
      <td>...</td>
      <td>1634.330823</td>
      <td>1997.945255</td>
      <td>2205.044800</td>
      <td>2515.396562</td>
      <td>3006.960425</td>
      <td>1.246632e+05</td>
      <td>4.461567e+04</td>
      <td>1.642811e+04</td>
      <td>6502.211589</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1987</td>
      <td>0.335034</td>
      <td>1.321058</td>
      <td>12.186603</td>
      <td>5.715308</td>
      <td>0.946840</td>
      <td>4.125128</td>
      <td>1.858080</td>
      <td>...</td>
      <td>1610.228721</td>
      <td>1968.338352</td>
      <td>2168.742869</td>
      <td>2466.746022</td>
      <td>2991.933806</td>
      <td>1.699842e+05</td>
      <td>5.540225e+04</td>
      <td>1.860459e+04</td>
      <td>6786.973464</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>1990</td>
      <td>0.320483</td>
      <td>1.215903</td>
      <td>11.185185</td>
      <td>5.347165</td>
      <td>0.873464</td>
      <td>3.852868</td>
      <td>1.805231</td>
      <td>...</td>
      <td>1655.308579</td>
      <td>2028.444829</td>
      <td>2215.310511</td>
      <td>2498.882158</td>
      <td>2988.214346</td>
      <td>1.388150e+05</td>
      <td>4.702499e+04</td>
      <td>1.650756e+04</td>
      <td>6361.467214</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>31</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>2001</td>
      <td>0.449018</td>
      <td>2.542276</td>
      <td>62.540001</td>
      <td>18.671875</td>
      <td>1.576109</td>
      <td>16.790304</td>
      <td>2.282341</td>
      <td>...</td>
      <td>7427.315736</td>
      <td>8770.933548</td>
      <td>10367.177099</td>
      <td>12791.223717</td>
      <td>16951.663148</td>
      <td>9.660877e+05</td>
      <td>3.277422e+05</td>
      <td>1.132455e+05</td>
      <td>41170.258907</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>2004</td>
      <td>0.448017</td>
      <td>2.494118</td>
      <td>37.857143</td>
      <td>15.062112</td>
      <td>1.591592</td>
      <td>12.100798</td>
      <td>2.491139</td>
      <td>...</td>
      <td>7614.330196</td>
      <td>8913.165707</td>
      <td>10929.113150</td>
      <td>13588.080876</td>
      <td>18968.354483</td>
      <td>4.784235e+05</td>
      <td>2.217401e+05</td>
      <td>1.015686e+05</td>
      <td>45307.935241</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>33</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>2007</td>
      <td>0.446135</td>
      <td>2.476790</td>
      <td>39.848103</td>
      <td>15.405751</td>
      <td>1.570858</td>
      <td>12.668105</td>
      <td>2.453044</td>
      <td>...</td>
      <td>8546.873264</td>
      <td>9964.136389</td>
      <td>12123.506218</td>
      <td>14997.756302</td>
      <td>20965.853402</td>
      <td>4.764216e+05</td>
      <td>2.281581e+05</td>
      <td>1.077264e+05</td>
      <td>49305.611092</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>34</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>2011</td>
      <td>0.445600</td>
      <td>2.457562</td>
      <td>36.193180</td>
      <td>14.569277</td>
      <td>1.572063</td>
      <td>11.591341</td>
      <td>2.461620</td>
      <td>...</td>
      <td>8413.865367</td>
      <td>9742.754116</td>
      <td>11890.668008</td>
      <td>14743.196444</td>
      <td>20711.739880</td>
      <td>7.115255e+05</td>
      <td>2.922715e+05</td>
      <td>1.202510e+05</td>
      <td>49670.862086</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>35</th>
      <td>posttax_dis</td>
      <td>Bosnia and Herzegovina</td>
      <td>2015</td>
      <td>0.443763</td>
      <td>2.420532</td>
      <td>34.978024</td>
      <td>14.191176</td>
      <td>1.559530</td>
      <td>11.082072</td>
      <td>2.427410</td>
      <td>...</td>
      <td>9608.407213</td>
      <td>11177.870650</td>
      <td>13642.682552</td>
      <td>16955.828943</td>
      <td>23323.544850</td>
      <td>8.772548e+05</td>
      <td>3.535390e+05</td>
      <td>1.425581e+05</td>
      <td>57563.854243</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>36</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1985</td>
      <td>0.351327</td>
      <td>1.384282</td>
      <td>21.644068</td>
      <td>7.483577</td>
      <td>0.968525</td>
      <td>6.848332</td>
      <td>2.068584</td>
      <td>...</td>
      <td>23829.068265</td>
      <td>27899.253575</td>
      <td>32625.798097</td>
      <td>39228.214895</td>
      <td>49292.433060</td>
      <td>8.818798e+05</td>
      <td>4.287973e+05</td>
      <td>2.084946e+05</td>
      <td>101376.582380</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>37</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1988</td>
      <td>0.370274</td>
      <td>1.548986</td>
      <td>14.790322</td>
      <td>7.517361</td>
      <td>1.090369</td>
      <td>6.423766</td>
      <td>2.194749</td>
      <td>...</td>
      <td>25194.860150</td>
      <td>29659.959058</td>
      <td>36011.518790</td>
      <td>42503.997708</td>
      <td>55296.400849</td>
      <td>1.539870e+06</td>
      <td>6.703277e+05</td>
      <td>2.918035e+05</td>
      <td>127026.357897</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1991</td>
      <td>0.368910</td>
      <td>1.498574</td>
      <td>23.666666</td>
      <td>8.297088</td>
      <td>1.042047</td>
      <td>6.839683</td>
      <td>2.149004</td>
      <td>...</td>
      <td>28077.428760</td>
      <td>32664.492048</td>
      <td>39096.969197</td>
      <td>49400.671544</td>
      <td>60338.510227</td>
      <td>1.206567e+06</td>
      <td>5.705741e+05</td>
      <td>2.698192e+05</td>
      <td>127595.002107</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1992</td>
      <td>0.374494</td>
      <td>1.542874</td>
      <td>22.191668</td>
      <td>8.248566</td>
      <td>1.074657</td>
      <td>6.738485</td>
      <td>2.188536</td>
      <td>...</td>
      <td>27621.990502</td>
      <td>32363.829592</td>
      <td>38835.131415</td>
      <td>51993.558415</td>
      <td>60451.716177</td>
      <td>1.323129e+06</td>
      <td>6.117217e+05</td>
      <td>2.828170e+05</td>
      <td>130754.572345</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>40</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1993</td>
      <td>0.375440</td>
      <td>1.543174</td>
      <td>25.931372</td>
      <td>8.527668</td>
      <td>1.071718</td>
      <td>6.342574</td>
      <td>2.209555</td>
      <td>...</td>
      <td>27384.074994</td>
      <td>32278.467599</td>
      <td>38399.693746</td>
      <td>51535.374978</td>
      <td>60506.619756</td>
      <td>1.171194e+06</td>
      <td>5.583706e+05</td>
      <td>2.662048e+05</td>
      <td>126913.936284</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>41</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1994</td>
      <td>0.381199</td>
      <td>1.597403</td>
      <td>30.404495</td>
      <td>9.146138</td>
      <td>1.104039</td>
      <td>7.695202</td>
      <td>2.243350</td>
      <td>...</td>
      <td>28217.040718</td>
      <td>33113.132720</td>
      <td>39294.752804</td>
      <td>49518.975684</td>
      <td>63300.689026</td>
      <td>1.306447e+06</td>
      <td>6.129441e+05</td>
      <td>2.875742e+05</td>
      <td>134920.838917</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>42</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1995</td>
      <td>0.373736</td>
      <td>1.551127</td>
      <td>22.754238</td>
      <td>8.313461</td>
      <td>1.078313</td>
      <td>6.813639</td>
      <td>2.250014</td>
      <td>...</td>
      <td>28612.607931</td>
      <td>33690.927526</td>
      <td>39921.699385</td>
      <td>49321.061355</td>
      <td>64378.760013</td>
      <td>1.214490e+06</td>
      <td>5.827483e+05</td>
      <td>2.796199e+05</td>
      <td>134169.836393</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>43</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1996</td>
      <td>0.376857</td>
      <td>1.576182</td>
      <td>25.961538</td>
      <td>8.507843</td>
      <td>1.094003</td>
      <td>6.346833</td>
      <td>2.251962</td>
      <td>...</td>
      <td>28619.144071</td>
      <td>33712.888957</td>
      <td>39877.253630</td>
      <td>49481.196793</td>
      <td>64449.219606</td>
      <td>1.236080e+06</td>
      <td>5.906622e+05</td>
      <td>2.822487e+05</td>
      <td>134872.863647</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1997</td>
      <td>0.373875</td>
      <td>1.580496</td>
      <td>23.817390</td>
      <td>8.161290</td>
      <td>1.096477</td>
      <td>5.784953</td>
      <td>2.153851</td>
      <td>...</td>
      <td>30487.042256</td>
      <td>35769.158707</td>
      <td>41906.594481</td>
      <td>51014.313870</td>
      <td>65664.549540</td>
      <td>1.641316e+06</td>
      <td>7.340521e+05</td>
      <td>3.282929e+05</td>
      <td>146823.804081</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>45</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1998</td>
      <td>0.386830</td>
      <td>1.684940</td>
      <td>27.155340</td>
      <td>8.959432</td>
      <td>1.161545</td>
      <td>6.504806</td>
      <td>2.323375</td>
      <td>...</td>
      <td>30387.954369</td>
      <td>35771.511717</td>
      <td>42407.524277</td>
      <td>52293.959425</td>
      <td>70602.603563</td>
      <td>1.426664e+06</td>
      <td>6.728934e+05</td>
      <td>3.173738e+05</td>
      <td>149690.947401</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>46</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>1999</td>
      <td>0.383610</td>
      <td>1.651079</td>
      <td>26.228571</td>
      <td>8.784000</td>
      <td>1.138017</td>
      <td>6.885853</td>
      <td>2.306537</td>
      <td>...</td>
      <td>31224.711055</td>
      <td>36985.142255</td>
      <td>43371.474253</td>
      <td>53264.184096</td>
      <td>72020.946016</td>
      <td>1.358278e+06</td>
      <td>6.517876e+05</td>
      <td>3.127690e+05</td>
      <td>150086.253168</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>47</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>2000</td>
      <td>0.389392</td>
      <td>1.697917</td>
      <td>27.166666</td>
      <td>9.134297</td>
      <td>1.169198</td>
      <td>6.751075</td>
      <td>2.354764</td>
      <td>...</td>
      <td>31990.877425</td>
      <td>38023.473508</td>
      <td>46006.192422</td>
      <td>57582.742738</td>
      <td>75330.978204</td>
      <td>1.426642e+06</td>
      <td>6.838798e+05</td>
      <td>3.278268e+05</td>
      <td>157148.029909</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>2001</td>
      <td>0.380524</td>
      <td>1.620155</td>
      <td>27.724489</td>
      <td>8.758064</td>
      <td>1.115353</td>
      <td>6.319833</td>
      <td>2.237169</td>
      <td>...</td>
      <td>32423.700638</td>
      <td>38281.389606</td>
      <td>45501.602389</td>
      <td>55852.364946</td>
      <td>72537.301102</td>
      <td>1.423077e+06</td>
      <td>6.761790e+05</td>
      <td>3.212883e+05</td>
      <td>152661.100292</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>49</th>
      <td>posttax_dis</td>
      <td>Belgium</td>
      <td>2002</td>
      <td>0.385071</td>
      <td>1.665060</td>
      <td>30.043478</td>
      <td>9.045455</td>
      <td>1.144988</td>
      <td>6.501324</td>
      <td>2.251273</td>
      <td>...</td>
      <td>32086.958688</td>
      <td>37881.247095</td>
      <td>44751.776369</td>
      <td>54902.271587</td>
      <td>72236.507924</td>
      <td>1.554368e+06</td>
      <td>7.216963e+05</td>
      <td>3.350852e+05</td>
      <td>155580.794180</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>50 rows  57 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Drop subnational, regional and historical geographical entities
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Here we create a list of entities in the WID data that do not correspond to countries in existence today. These we drop from the data.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>drop_entities <span class="op">=</span>  [</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"China - rural"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"China - urban"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East Germany"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other Russia and Central Asia"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other East Asia"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other Western Europe"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other Latin America"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other MENA"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other South &amp; South-East Asia"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Other Sub-Saharan Africa"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Africa"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Asia"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Europe"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Oceania"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Central Asia"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East Africa"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"East Asia"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Asia"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Eastern Europe"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle Africa"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North Africa"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North America"</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South-East Asia"</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Africa region"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Africa"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Asia"</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Western Europe"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"European Union"</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"World"</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Asia (excluding Middle East)"</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"North America and Oceania"</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sub-Saharan Africa"</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Latin America"</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle East"</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MENA"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Russia and Central Asia"</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South &amp; South-East Asia"</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.loc[<span class="op">~</span>df_wid[<span class="st">"Entity"</span>].isin(drop_entities)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Calculate some additional inequality metrics
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gini as index</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df_wid[<span class="st">"Gini"</span>] <span class="op">=</span> df_wid[<span class="st">'Gini coefficient'</span>] <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Rename and select needed variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.rename(columns<span class="op">=</span>{</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P90-P100 - share of the top 10%'</span>:<span class="st">'Top_10_share'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P0-P50 - share of the bottom 50%'</span>:<span class="st">'Bottom_50_share'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'P99-P100 - share of the top 1%'</span>:<span class="st">'Top_1_share'</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>keep_cols <span class="op">=</span> [</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Year"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Entity"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Gini"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Top_10_share"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Bottom_50_share"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"inc_concept"</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid[keep_cols]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Pivot the data wider by income concept
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.set_index([<span class="st">'Year'</span>,<span class="st">'Entity'</span>,<span class="st">'inc_concept'</span>]).unstack()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df_wid.columns <span class="op">=</span> df_wid.columns.<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="st">'</span><span class="sc">{}</span><span class="st">_</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(x[<span class="dv">0</span>], x[<span class="dv">1</span>]))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.reset_index()</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> df_wid.sort_values(by<span class="op">=</span>[<span class="st">'Entity'</span>, <span class="st">'Year'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
See the prepared WID data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The first 100 rows of the dataframe looks like this:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_wid.head(<span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Entity</th>
      <th>Gini_posttax_dis</th>
      <th>Gini_posttax_nat</th>
      <th>Gini_pretax</th>
      <th>Top_10_share_posttax_dis</th>
      <th>Top_10_share_posttax_nat</th>
      <th>Top_10_share_pretax</th>
      <th>Bottom_50_share_posttax_dis</th>
      <th>Bottom_50_share_posttax_nat</th>
      <th>Bottom_50_share_pretax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2986</th>
      <td>2008</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>52.452389</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>41.94</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.16</td>
    </tr>
    <tr>
      <th>3318</th>
      <td>2012</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.265584</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.76</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.00</td>
    </tr>
    <tr>
      <th>3742</th>
      <td>2017</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>51.539312</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>41.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.79</td>
    </tr>
    <tr>
      <th>2192</th>
      <td>1996</td>
      <td>Albania</td>
      <td>44.367788</td>
      <td>41.414440</td>
      <td>46.762984</td>
      <td>29.97</td>
      <td>28.65</td>
      <td>32.57</td>
      <td>20.11</td>
      <td>22.10</td>
      <td>18.80</td>
    </tr>
    <tr>
      <th>2523</th>
      <td>2002</td>
      <td>Albania</td>
      <td>45.792148</td>
      <td>42.288218</td>
      <td>48.169805</td>
      <td>31.13</td>
      <td>29.51</td>
      <td>33.64</td>
      <td>19.19</td>
      <td>21.54</td>
      <td>17.96</td>
    </tr>
    <tr>
      <th>2739</th>
      <td>2005</td>
      <td>Albania</td>
      <td>45.060796</td>
      <td>41.501583</td>
      <td>47.448188</td>
      <td>30.63</td>
      <td>29.00</td>
      <td>33.12</td>
      <td>19.71</td>
      <td>22.10</td>
      <td>18.43</td>
    </tr>
    <tr>
      <th>2987</th>
      <td>2008</td>
      <td>Albania</td>
      <td>44.940856</td>
      <td>41.277974</td>
      <td>47.213163</td>
      <td>30.53</td>
      <td>28.86</td>
      <td>33.07</td>
      <td>19.77</td>
      <td>22.23</td>
      <td>18.59</td>
    </tr>
    <tr>
      <th>3319</th>
      <td>2012</td>
      <td>Albania</td>
      <td>44.804508</td>
      <td>40.975732</td>
      <td>46.751532</td>
      <td>30.91</td>
      <td>29.12</td>
      <td>33.00</td>
      <td>20.00</td>
      <td>22.56</td>
      <td>19.05</td>
    </tr>
    <tr>
      <th>3571</th>
      <td>2015</td>
      <td>Albania</td>
      <td>45.436682</td>
      <td>41.710782</td>
      <td>49.306721</td>
      <td>31.79</td>
      <td>30.01</td>
      <td>35.23</td>
      <td>19.69</td>
      <td>22.17</td>
      <td>17.61</td>
    </tr>
    <tr>
      <th>3659</th>
      <td>2016</td>
      <td>Albania</td>
      <td>46.112099</td>
      <td>42.233368</td>
      <td>50.504972</td>
      <td>31.98</td>
      <td>30.14</td>
      <td>35.78</td>
      <td>18.92</td>
      <td>21.53</td>
      <td>16.48</td>
    </tr>
    <tr>
      <th>3743</th>
      <td>2017</td>
      <td>Albania</td>
      <td>45.411562</td>
      <td>41.619377</td>
      <td>49.776038</td>
      <td>31.57</td>
      <td>29.77</td>
      <td>35.45</td>
      <td>19.43</td>
      <td>21.98</td>
      <td>17.06</td>
    </tr>
    <tr>
      <th>3816</th>
      <td>2018</td>
      <td>Albania</td>
      <td>44.746907</td>
      <td>41.062778</td>
      <td>49.126580</td>
      <td>31.06</td>
      <td>29.33</td>
      <td>35.03</td>
      <td>19.88</td>
      <td>22.36</td>
      <td>17.49</td>
    </tr>
    <tr>
      <th>362</th>
      <td>1932</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>383</th>
      <td>1933</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>408</th>
      <td>1934</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>435</th>
      <td>1935</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>460</th>
      <td>1936</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>485</th>
      <td>1937</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>509</th>
      <td>1938</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>534</th>
      <td>1939</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>557</th>
      <td>1940</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>576</th>
      <td>1941</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>668</th>
      <td>1946</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>688</th>
      <td>1947</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>711</th>
      <td>1948</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>737</th>
      <td>1949</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>764</th>
      <td>1950</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>790</th>
      <td>1951</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>817</th>
      <td>1952</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>845</th>
      <td>1953</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>875</th>
      <td>1954</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>904</th>
      <td>1955</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>960</th>
      <td>1957</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1824</th>
      <td>1988</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60.861157</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>51.09</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.27</td>
    </tr>
    <tr>
      <th>2138</th>
      <td>1995</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>54.793733</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>42.81</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.34</td>
    </tr>
    <tr>
      <th>3234</th>
      <td>2011</td>
      <td>Algeria</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.798551</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.08</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.02</td>
    </tr>
    <tr>
      <th>2139</th>
      <td>1995</td>
      <td>Angola</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>68.246577</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>58.03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.15</td>
    </tr>
    <tr>
      <th>2405</th>
      <td>2000</td>
      <td>Angola</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>68.246581</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>58.03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.15</td>
    </tr>
    <tr>
      <th>2988</th>
      <td>2008</td>
      <td>Angola</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>60.936785</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.32</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.23</td>
    </tr>
    <tr>
      <th>3817</th>
      <td>2018</td>
      <td>Angola</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>68.559672</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>58.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.04</td>
    </tr>
    <tr>
      <th>363</th>
      <td>1932</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>384</th>
      <td>1933</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>409</th>
      <td>1934</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>436</th>
      <td>1935</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>461</th>
      <td>1936</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>486</th>
      <td>1937</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>510</th>
      <td>1938</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>535</th>
      <td>1939</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>558</th>
      <td>1940</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>577</th>
      <td>1941</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>595</th>
      <td>1942</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>610</th>
      <td>1943</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>629</th>
      <td>1944</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>646</th>
      <td>1945</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>669</th>
      <td>1946</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>689</th>
      <td>1947</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>712</th>
      <td>1948</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>738</th>
      <td>1949</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>765</th>
      <td>1950</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>791</th>
      <td>1951</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>818</th>
      <td>1952</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>846</th>
      <td>1953</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>876</th>
      <td>1954</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>933</th>
      <td>1956</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>991</th>
      <td>1958</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>1959</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>1961</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2463</th>
      <td>2001</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>61.275055</td>
      <td>66.088806</td>
      <td>NaN</td>
      <td>47.46</td>
      <td>50.54</td>
      <td>NaN</td>
      <td>10.86</td>
      <td>7.85</td>
    </tr>
    <tr>
      <th>2524</th>
      <td>2002</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>62.559468</td>
      <td>66.674702</td>
      <td>NaN</td>
      <td>49.18</td>
      <td>51.58</td>
      <td>NaN</td>
      <td>10.41</td>
      <td>7.79</td>
    </tr>
    <tr>
      <th>2593</th>
      <td>2003</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>58.788309</td>
      <td>61.895195</td>
      <td>NaN</td>
      <td>45.85</td>
      <td>47.99</td>
      <td>NaN</td>
      <td>12.71</td>
      <td>10.96</td>
    </tr>
    <tr>
      <th>2665</th>
      <td>2004</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>57.168198</td>
      <td>60.244077</td>
      <td>NaN</td>
      <td>44.27</td>
      <td>46.24</td>
      <td>NaN</td>
      <td>13.55</td>
      <td>11.78</td>
    </tr>
    <tr>
      <th>2740</th>
      <td>2005</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>56.009221</td>
      <td>59.255115</td>
      <td>NaN</td>
      <td>42.66</td>
      <td>44.64</td>
      <td>NaN</td>
      <td>14.02</td>
      <td>12.09</td>
    </tr>
    <tr>
      <th>2822</th>
      <td>2006</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>54.506041</td>
      <td>57.935620</td>
      <td>NaN</td>
      <td>41.33</td>
      <td>43.49</td>
      <td>NaN</td>
      <td>14.76</td>
      <td>12.73</td>
    </tr>
    <tr>
      <th>2903</th>
      <td>2007</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>55.349858</td>
      <td>58.750425</td>
      <td>NaN</td>
      <td>43.11</td>
      <td>45.31</td>
      <td>NaN</td>
      <td>14.85</td>
      <td>12.86</td>
    </tr>
    <tr>
      <th>2989</th>
      <td>2008</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>55.500095</td>
      <td>58.648372</td>
      <td>NaN</td>
      <td>43.94</td>
      <td>45.44</td>
      <td>NaN</td>
      <td>15.01</td>
      <td>13.06</td>
    </tr>
    <tr>
      <th>3064</th>
      <td>2009</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>52.588365</td>
      <td>56.898668</td>
      <td>NaN</td>
      <td>39.82</td>
      <td>42.39</td>
      <td>NaN</td>
      <td>15.78</td>
      <td>13.22</td>
    </tr>
    <tr>
      <th>3147</th>
      <td>2010</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>52.869671</td>
      <td>57.094291</td>
      <td>NaN</td>
      <td>41.21</td>
      <td>43.63</td>
      <td>NaN</td>
      <td>16.21</td>
      <td>13.64</td>
    </tr>
    <tr>
      <th>3235</th>
      <td>2011</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>50.721697</td>
      <td>55.481900</td>
      <td>NaN</td>
      <td>39.26</td>
      <td>42.05</td>
      <td>NaN</td>
      <td>17.36</td>
      <td>14.43</td>
    </tr>
    <tr>
      <th>3320</th>
      <td>2012</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>48.685044</td>
      <td>53.666061</td>
      <td>NaN</td>
      <td>36.11</td>
      <td>39.05</td>
      <td>NaN</td>
      <td>18.00</td>
      <td>14.95</td>
    </tr>
    <tr>
      <th>3407</th>
      <td>2013</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>48.957375</td>
      <td>54.173771</td>
      <td>NaN</td>
      <td>36.77</td>
      <td>40.13</td>
      <td>NaN</td>
      <td>17.97</td>
      <td>14.87</td>
    </tr>
    <tr>
      <th>3487</th>
      <td>2014</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>50.984577</td>
      <td>55.939785</td>
      <td>NaN</td>
      <td>38.30</td>
      <td>41.35</td>
      <td>NaN</td>
      <td>16.80</td>
      <td>13.83</td>
    </tr>
    <tr>
      <th>3572</th>
      <td>2015</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>51.498334</td>
      <td>56.288187</td>
      <td>NaN</td>
      <td>39.82</td>
      <td>43.24</td>
      <td>NaN</td>
      <td>16.90</td>
      <td>14.45</td>
    </tr>
    <tr>
      <th>3660</th>
      <td>2016</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>52.012087</td>
      <td>56.671475</td>
      <td>NaN</td>
      <td>41.34</td>
      <td>45.29</td>
      <td>NaN</td>
      <td>17.01</td>
      <td>15.13</td>
    </tr>
    <tr>
      <th>3744</th>
      <td>2017</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>52.525841</td>
      <td>58.135411</td>
      <td>NaN</td>
      <td>42.86</td>
      <td>46.41</td>
      <td>NaN</td>
      <td>17.12</td>
      <td>13.76</td>
    </tr>
    <tr>
      <th>3818</th>
      <td>2018</td>
      <td>Argentina</td>
      <td>NaN</td>
      <td>53.612730</td>
      <td>58.662965</td>
      <td>NaN</td>
      <td>43.86</td>
      <td>46.85</td>
      <td>NaN</td>
      <td>16.53</td>
      <td>13.46</td>
    </tr>
    <tr>
      <th>2193</th>
      <td>1996</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>58.842226</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.48</td>
    </tr>
    <tr>
      <th>2352</th>
      <td>1999</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>55.291180</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>44.17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>15.68</td>
    </tr>
    <tr>
      <th>2525</th>
      <td>2002</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>53.526514</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>42.91</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.84</td>
    </tr>
    <tr>
      <th>2594</th>
      <td>2003</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>52.679758</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>42.55</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>17.53</td>
    </tr>
    <tr>
      <th>2666</th>
      <td>2004</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>55.557885</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>45.67</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.14</td>
    </tr>
    <tr>
      <th>2741</th>
      <td>2005</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>54.878909</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>45.00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16.48</td>
    </tr>
    <tr>
      <th>2823</th>
      <td>2006</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.488536</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37.77</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.32</td>
    </tr>
    <tr>
      <th>2904</th>
      <td>2007</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.655285</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>38.41</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.56</td>
    </tr>
    <tr>
      <th>2990</th>
      <td>2008</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.113928</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>36.96</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.33</td>
    </tr>
    <tr>
      <th>3065</th>
      <td>2009</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>47.468036</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>36.37</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.74</td>
    </tr>
    <tr>
      <th>3148</th>
      <td>2010</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.801407</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39.12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.78</td>
    </tr>
    <tr>
      <th>3236</th>
      <td>2011</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.204984</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37.29</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.48</td>
    </tr>
    <tr>
      <th>3321</th>
      <td>2012</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.179293</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37.70</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.63</td>
    </tr>
    <tr>
      <th>3408</th>
      <td>2013</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>48.938826</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>37.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>19.06</td>
    </tr>
    <tr>
      <th>3488</th>
      <td>2014</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>49.911902</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>39.16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.57</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Save the data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I save the prepared data locally:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_wid.to_csv(<span class="st">"data/clean/wid.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>