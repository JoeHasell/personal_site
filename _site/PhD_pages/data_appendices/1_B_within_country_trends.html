<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Joe Hasell - Appendix 1.B: Analysing global trends in within-country inequality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content="../..">
<script src="../../site_libs/quarto-contrib/shinylive-0.0.11/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="../../site_libs/quarto-contrib/shinylive-0.0.11/shinylive/run-python-blocks.js" type="module"></script>
<link href="../../site_libs/quarto-contrib/shinylive-0.0.11/shinylive/shinylive.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Appendix 1.B: Analysing global trends in within-country inequality</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Joe Hasell</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">DPhil: Triangulating the key facts about global income distribution</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Papers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/overview.html" class="sidebar-item-text sidebar-link">Overview of papers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/paper1.html" class="sidebar-item-text sidebar-link">Paper 1: Triangulating trends in inequality around the world from secondary databases</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/paper_pages/paper3.html" class="sidebar-item-text sidebar-link">Paper 3: Housing and the capital share of income</a>
  </div>
</li>
          <li class="sidebar-item">
  PhD_pages/paper_pages/test_page.qmd
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Data appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_A_prepare_PIP_and_WID.html" class="sidebar-item-text sidebar-link">Appendix 1.A: Preparing PIP and WID inequality data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/1_B_within_country_trends.html" class="sidebar-item-text sidebar-link active">Appendix 1.B: Analysing global trends in within-country inequality</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/3_A_prepare_KLEMS.html" class="sidebar-item-text sidebar-link">Appendix 3.A: Preparing EU KLEMS industry data</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../PhD_pages/data_appendices/3_B_prepare_OECD.html" class="sidebar-item-text sidebar-link">Appendix 3.B: Preparing OECD industry data</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Presentations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../presentations/DSPI_CSP_masters_Jan2023/DSPI_CSP_masters_Jan2023.html" class="sidebar-item-text sidebar-link">From $1.90 to $2.15: the updated International Poverty Line</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">About this site</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../how_to.html" class="sidebar-item-text sidebar-link">How I built this site</a>
  </div>
</li>
          <li class="sidebar-item">
  test_pages/test_passing_r_to_python.qmd
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../test_pages/test_with_shinylive.html" class="sidebar-item-text sidebar-link">Shinylive in Quarto example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../test_pages/test_with_iframe_shiny.html" class="sidebar-item-text sidebar-link">A test notebook with Shiny app mbedded as an iframe</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#method-1-reference-years" id="toc-method-1-reference-years" class="nav-link active" data-scroll-target="#method-1-reference-years">Method 1: Reference years</a>
  <ul class="collapse">
  <li><a href="#mapping-data-to-a-reference-year" id="toc-mapping-data-to-a-reference-year" class="nav-link" data-scroll-target="#mapping-data-to-a-reference-year">Mapping data to a reference year</a></li>
  <li><a href="#obtaining-a-pair-of-observations" id="toc-obtaining-a-pair-of-observations" class="nav-link" data-scroll-target="#obtaining-a-pair-of-observations">Obtaining a pair of observations</a></li>
  <li><a href="#merging-reference-year-aligned-data-from-wid-and-pip-datasets" id="toc-merging-reference-year-aligned-data-from-wid-and-pip-datasets" class="nav-link" data-scroll-target="#merging-reference-year-aligned-data-from-wid-and-pip-datasets">Merging reference year aligned data from WID and PIP datasets</a></li>
  </ul></li>
  <li><a href="#prepare-plot-and-tables" id="toc-prepare-plot-and-tables" class="nav-link" data-scroll-target="#prepare-plot-and-tables">Prepare plot and tables</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1990-2017</a></li>
  <li><a href="#method-2-regression-analysis" id="toc-method-2-regression-analysis" class="nav-link" data-scroll-target="#method-2-regression-analysis">Method 2: regression analysis</a></li>
  <li><a href="#explore-the-date" id="toc-explore-the-date" class="nav-link" data-scroll-target="#explore-the-date">Explore the date</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Appendix 1.B: Analysing global trends in within-country inequality</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Load in the data</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_wid <span class="op">=</span> pd.read_csv(<span class="st">"data/clean/wid.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_pip <span class="op">=</span> pd.read_csv(<span class="st">"data/clean/pip.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_regions <span class="op">=</span> pd.read_csv(<span class="st">"data/clean/WID_region_mapping.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>df_pop <span class="op">=</span> pd.read_csv(<span class="st">"data/clean/population.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># df_wid = pd.read_csv("PhD_pages/data_appendices/data/clean/wid.csv")</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># df_pip = pd.read_csv("PhD_pages/data_appendices/data/clean/pip.csv")</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_regions = pd.read_csv("PhD_pages/data_appendices/data/clean/WID_region_mapping.csv")</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df_pop = pd.read_csv("PhD_pages/data_appendices/data/clean/population.csv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A key difficulty of comparing trends is that the data is incomplete coverage. The paper uses two methods to calculate and compare aggregate within-country trends across incomplete data: using reference years and using year fixed effects in a regression.</p>
<section id="method-1-reference-years" class="level2">
<h2 class="anchored" data-anchor-id="method-1-reference-years">Method 1: Reference years</h2>
<p>I need to allow for the income/consumption issue (currently the data includes both – i.e.&nbsp;multi observations per country year).</p>
<section id="mapping-data-to-a-reference-year" class="level3">
<h3 class="anchored" data-anchor-id="mapping-data-to-a-reference-year">Mapping data to a reference year</h3>
<p>This function grabs the observation, by a grouping variable (e.g.&nbsp;by country), for which a reference variable (e.g.&nbsp;year) is closest to a reference value (e.g.&nbsp;2002). You can specify a maximum distance from the reference value, beyond which no match will be returned. Because there may be tie-breaks – matches equally distant above or below the reference value – there is an argmuent to specify how these tie-breaks should resolved.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Function get matching for ref years</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> closest_to_reference(df, reference_val, max_dist_from_ref, reference_col, group_by_col, value_col, tie_break):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.loc[:, [reference_col, group_by_col, value_col]]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop NAs</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.dropna()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate absolute distance from reference value</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'ref_diff'</span>] <span class="op">=</span> <span class="bu">abs</span>(df[reference_col] <span class="op">-</span> reference_val)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drop any rows with a distance beyond threshold</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> pd.isna(max_dist_from_ref):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      df <span class="op">=</span> df.loc[df[<span class="st">'ref_diff'</span>] <span class="op">&lt;=</span> max_dist_from_ref]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep closest observation to reference value – including tie-breaks (where there is a match above and below the ref value)</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[df.groupby(group_by_col)[<span class="st">'ref_diff'</span>].transform(<span class="st">'min'</span>) <span class="op">==</span> df[<span class="st">'ref_diff'</span>]].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Settle tie-breaks</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tie_break <span class="op">==</span> <span class="st">'below'</span>:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      df <span class="op">=</span> df[df.groupby(group_by_col)[reference_col].transform(<span class="st">'min'</span>) <span class="op">==</span> df[reference_col]].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> tie_break <span class="op">==</span> <span class="st">'above'</span>:</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      df <span class="op">=</span> df[df.groupby(group_by_col)[reference_col].transform(<span class="st">'max'</span>) <span class="op">==</span> df[reference_col]].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(<span class="st">'ref_diff'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I test this function here:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> closest_to_reference(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df_wid, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  reference_val <span class="op">=</span> <span class="dv">2002</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  max_dist_from_ref <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  reference_col <span class="op">=</span> <span class="st">'Year'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  group_by_col <span class="op">=</span> <span class="st">'Entity'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  value_col <span class="op">=</span> <span class="st">'Gini'</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  tie_break <span class="op">=</span> <span class="st">'below'</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Entity</th>
      <th>Gini</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1998</td>
      <td>United Arab Emirates</td>
      <td>0.656802</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>Albania</td>
      <td>0.481698</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2002</td>
      <td>Armenia</td>
      <td>0.535265</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>Angola</td>
      <td>0.682466</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2002</td>
      <td>Argentina</td>
      <td>0.666745</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="obtaining-a-pair-of-observations" class="level3">
<h3 class="anchored" data-anchor-id="obtaining-a-pair-of-observations">Obtaining a pair of observations</h3>
<p>This function runs the <code>closest_to_reference</code> function twice, over a pair of reference values. Tie-breaks are settled so as to maximise the gap between the two reference values. You can also specify a minimum distance between the two observations (e.g.&nbsp;pairs of matches that fall less than X years apart will be dropped).</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge matches for different reference points</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_two_ref_matches(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make sure the pair of reference values are in ascending order</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  reference_vals.sort()</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Maximise distance between two refs by settling tie-breaks below the lowest ref and above the highest ref </span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find matches for lower reference value</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  lower_ref_matches <span class="op">=</span> closest_to_reference(df, reference_vals[<span class="dv">0</span>], max_dist_from_refs[<span class="dv">0</span>], reference_col, group_by_col, value_col, <span class="st">'below'</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find matches for higher reference value</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  higher_ref_matches <span class="op">=</span> closest_to_reference(df, reference_vals[<span class="dv">1</span>], max_dist_from_refs[<span class="dv">1</span>], reference_col, group_by_col, value_col, <span class="st">'above'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge the two sets of matches</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  merged_df <span class="op">=</span> pd.merge(lower_ref_matches, higher_ref_matches, on<span class="op">=</span>group_by_col, suffixes<span class="op">=</span>(reference_vals[<span class="dv">0</span>], reference_vals[<span class="dv">1</span>]))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop obs that do not have data for both ref values</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  merged_df <span class="op">=</span> merged_df.dropna()</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop obs where the matched data does not meet the min distance requirement</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="kw">not</span> pd.isna(min_dist_between):</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store the names of the reference column returned from the two matches</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    ref_var_high <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>reference_col<span class="sc">}{</span>reference_vals[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    ref_var_low <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>reference_col<span class="sc">}{</span>reference_vals[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep only rows &gt;= to the min distance</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    merged_df <span class="op">=</span> merged_df.loc[(merged_df[ref_var_high] <span class="op">-</span> merged_df[ref_var_low]) <span class="op">&gt;=</span> min_dist_between, :]</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> merged_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I test this function here:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> merge_two_ref_matches(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df_wid, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  reference_vals <span class="op">=</span> [<span class="dv">2000</span>, <span class="dv">2010</span>], </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  max_dist_from_refs <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">4</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  min_dist_between <span class="op">=</span> <span class="dv">9</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  reference_col <span class="op">=</span> <span class="st">'Year'</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  group_by_col <span class="op">=</span> <span class="st">'Entity'</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  value_col <span class="op">=</span> <span class="st">'Gini'</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year2000</th>
      <th>Entity</th>
      <th>Gini2000</th>
      <th>Year2010</th>
      <th>Gini2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1998</td>
      <td>United Arab Emirates</td>
      <td>0.656802</td>
      <td>2009</td>
      <td>0.676088</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2002</td>
      <td>Albania</td>
      <td>0.481698</td>
      <td>2012</td>
      <td>0.467515</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1999</td>
      <td>Armenia</td>
      <td>0.552912</td>
      <td>2010</td>
      <td>0.498014</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2001</td>
      <td>Argentina</td>
      <td>0.660888</td>
      <td>2010</td>
      <td>0.570943</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2000</td>
      <td>Australia</td>
      <td>0.474796</td>
      <td>2010</td>
      <td>0.475651</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="allowing-for-the-different-welfare-concepts-in-the-pip-data" class="level4">
<h4 class="anchored" data-anchor-id="allowing-for-the-different-welfare-concepts-in-the-pip-data">Allowing for the different welfare concepts in the PIP data</h4>
<p>As noted in …. (add backlink) … the PIP data contains both income and consumption observations. This function produces matched pairs of observations from that data in which only one pair is selected for each value of the grouping variable (i.e.&nbsp;each country). Priority is given to pairs for which both observations relate to income. Second priority is given to pairs where both observations relate to consumption. Only if neither pair is available then it will return a mixed pair of observations if that is available.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For PIP run this three times – first filtering data for just consumpion only, then with income only, then with a dataset that prefers income over consumption</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pip_welfare_routine(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify the name of the column in which the income/consumption welfare definition is stored</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  welfare_colname <span class="op">=</span> <span class="st">'welfare_type'</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creat dataframes for thee scenarios:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scenario 1: only allow income data</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  df_inc_filter <span class="op">=</span> df.loc[df[welfare_colname] <span class="op">==</span> <span class="st">"income"</span>, :]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  df_inc_filter.name <span class="op">=</span> <span class="st">"Income"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scenario 2: only allow consumption data</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  df_cons_filter <span class="op">=</span> df.loc[df[welfare_colname] <span class="op">==</span> <span class="st">"consumption"</span>, :]</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  df_cons_filter.name <span class="op">=</span> <span class="st">"Consumption"</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Scenario 3: allow a mix – dropping consumption data where income data is available in the same year</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  df_mixed <span class="op">=</span> df.copy()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  df_mixed[<span class="st">'welfare_count'</span>] <span class="op">=</span> df_mixed.groupby([reference_col, group_by_col])[welfare_colname].transform(<span class="st">'count'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  df_mixed <span class="op">=</span> df_mixed.loc[(df_mixed[<span class="st">'welfare_count'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">|</span> (df_mixed[welfare_colname] <span class="op">==</span> <span class="st">"income"</span>)]</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  df_mixed.name <span class="op">=</span> <span class="st">"Mixed"</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  Store the scneario dataframes in a list</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  df_scenarios <span class="op">=</span> [df_inc_filter, df_cons_filter, df_mixed]</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run the matching function on each scenario</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  scenario_matches <span class="op">=</span> [merge_two_ref_matches(</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    df_scenario, </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    reference_vals, </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    max_dist_from_refs, </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    min_dist_between, </span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    reference_col, </span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    group_by_col, </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    value_col) <span class="cf">for</span> df_scenario <span class="kw">in</span> df_scenarios]</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the first two scenarios.</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> pd.concat([scenario_matches[<span class="dv">0</span>], scenario_matches[<span class="dv">1</span>]], keys<span class="op">=</span>[df_scenarios[<span class="dv">0</span>].name, df_scenarios[<span class="dv">1</span>].name])</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tidy up indexes</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches.reset_index()</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches.drop(<span class="st">'level_1'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches<span class="op">\</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"level_0"</span>: <span class="st">"pip_welfare"</span>})</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add in third scenario.</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> pd.concat([df_combined_matches, scenario_matches[<span class="dv">2</span>]])</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add scenario name to te pip_welfare column</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  df_combined_matches[<span class="st">'pip_welfare'</span>] <span class="op">=</span> df_combined_matches[<span class="st">'pip_welfare'</span>].fillna(df_scenarios[<span class="dv">2</span>].name)</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Keep only one match per group (e.g. per Country) - in the priority laid out in the df_scenarios list above (income only -&gt; consumption only -&gt; mixed)</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># First count the matches</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  df_combined_matches[<span class="st">'match_count'</span>] <span class="op">=</span> df_combined_matches.groupby(group_by_col)[<span class="st">'pip_welfare'</span>].transform(<span class="st">'count'</span>)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Then drop any matches from the lowest priority where there are multiple matches</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches.loc[(df_combined_matches[<span class="st">'match_count'</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">|</span> <span class="op">~</span>(df_combined_matches[<span class="st">'pip_welfare'</span>]<span class="op">==</span>df_scenarios[<span class="dv">2</span>].name)]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  Repeat at the next level of priority</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  df_combined_matches[<span class="st">'match_count'</span>] <span class="op">=</span> df_combined_matches.groupby(group_by_col)[<span class="st">'pip_welfare'</span>].transform(<span class="st">'count'</span>)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches.loc[(df_combined_matches[<span class="st">'match_count'</span>]<span class="op">==</span><span class="dv">1</span>) <span class="op">|</span> <span class="op">~</span>(df_combined_matches[<span class="st">'pip_welfare'</span>]<span class="op">==</span>df_scenarios[<span class="dv">1</span>].name)]</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Drop the match count column</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  df_combined_matches <span class="op">=</span> df_combined_matches.drop(<span class="st">'match_count'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df_combined_matches</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I test this function here:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pip_welfare_routine(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> df_pip,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  reference_vals <span class="op">=</span> [<span class="dv">1986</span>, <span class="dv">2016</span>], </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  max_dist_from_refs <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">5</span>], </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  min_dist_between <span class="op">=</span> <span class="dv">30</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  reference_col <span class="op">=</span> <span class="st">'Year'</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  group_by_col <span class="op">=</span> <span class="st">'Entity'</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  value_col <span class="op">=</span> <span class="st">'Gini'</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>pip_welfare</th>
      <th>Year1986</th>
      <th>Entity</th>
      <th>Gini1986</th>
      <th>Year2016</th>
      <th>Gini2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Income</td>
      <td>1986</td>
      <td>Argentina</td>
      <td>0.428089</td>
      <td>2016</td>
      <td>0.420325</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Income</td>
      <td>1985</td>
      <td>Australia</td>
      <td>0.324977</td>
      <td>2016</td>
      <td>0.336858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Income</td>
      <td>1985</td>
      <td>Belgium</td>
      <td>0.252039</td>
      <td>2016</td>
      <td>0.275810</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Income</td>
      <td>1986</td>
      <td>Brazil</td>
      <td>0.584646</td>
      <td>2016</td>
      <td>0.533428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Income</td>
      <td>1987</td>
      <td>Chile</td>
      <td>0.562102</td>
      <td>2017</td>
      <td>0.444410</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="merging-reference-year-aligned-data-from-wid-and-pip-datasets" class="level3">
<h3 class="anchored" data-anchor-id="merging-reference-year-aligned-data-from-wid-and-pip-datasets">Merging reference year aligned data from WID and PIP datasets</h3>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prep_wid_pip_data(reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  pip_matches <span class="op">=</span> pip_welfare_routine(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_pip,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    reference_vals <span class="op">=</span> reference_vals,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    max_dist_from_refs <span class="op">=</span> max_dist_from_refs,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    min_dist_between <span class="op">=</span> min_dist_between,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    reference_col <span class="op">=</span> reference_col,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    group_by_col <span class="op">=</span> group_by_col,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    value_col <span class="op">=</span> value_col</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  wid_matches <span class="op">=</span> merge_two_ref_matches(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df_wid,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    reference_vals <span class="op">=</span> reference_vals,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    max_dist_from_refs <span class="op">=</span> max_dist_from_refs,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    min_dist_between <span class="op">=</span> min_dist_between,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    reference_col <span class="op">=</span> reference_col,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    group_by_col <span class="op">=</span> group_by_col,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    value_col <span class="op">=</span> value_col</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  ref_pairs <span class="op">=</span> pd.concat([pip_matches, wid_matches,], keys<span class="op">=</span>[<span class="st">'pip'</span>, <span class="st">'wid'</span>])</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Tidy up indexes</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  ref_pairs <span class="op">=</span> ref_pairs.reset_index()</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  ref_pairs <span class="op">=</span> ref_pairs.drop(<span class="st">'level_1'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  ref_pairs <span class="op">=</span> ref_pairs<span class="op">\</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    .rename(columns<span class="op">=</span>{<span class="st">"level_0"</span>: <span class="st">"source"</span>})</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ref_pairs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="prepare-plot-and-tables" class="level2">
<h2 class="anchored" data-anchor-id="prepare-plot-and-tables">Prepare plot and tables</h2>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">1990-2017</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifications</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>reference_vals <span class="op">=</span> [<span class="dv">1990</span>, <span class="dv">2017</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>max_dist_from_refs <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">4</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>min_dist_between <span class="op">=</span> <span class="dv">23</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># These parameters are unlikely to change:</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>reference_col <span class="op">=</span> <span class="st">'Year'</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>group_by_col <span class="op">=</span> <span class="st">'Entity'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" aria-current="page">Gini</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Top 10% share</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">All countries</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Countries with data for both sources</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'plot'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="1_B_within_country_trends_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;ggplot: (377945233)&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'summary'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip</th>
      <th>wid</th>
    </tr>
    <tr>
      <th>region_alt</th>
      <th>summary</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">East Asia</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>n</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.04</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.07</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.24</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Eastern Europe &amp; Central Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>9</td>
      <td>19</td>
    </tr>
    <tr>
      <th>n</th>
      <td>14</td>
      <td>21</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.02</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.04</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.06</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Latin America</th>
      <th>fall</th>
      <td>12</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>3</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>n</th>
      <td>16</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.05</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.06</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.09</td>
      <td>nan</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">MENA</th>
      <th>fall</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>n</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.02</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.02</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">North America &amp; Oceania</th>
      <th>fall</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>n</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.02</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.03</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.06</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">South &amp; South-East Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>n</th>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.00</td>
      <td>0.01</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.02</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.36</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Sub-Saharan Africa</th>
      <th>fall</th>
      <td>9</td>
      <td>7</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>n</th>
      <td>15</td>
      <td>13</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.07</td>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.06</td>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Western Europe</th>
      <th>fall</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>7</td>
      <td>11</td>
    </tr>
    <tr>
      <th>n</th>
      <td>15</td>
      <td>17</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.02</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.01</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">World</th>
      <th>fall</th>
      <td>34</td>
      <td>20</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>17</td>
      <td>12</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>30</td>
      <td>45</td>
    </tr>
    <tr>
      <th>n</th>
      <td>81</td>
      <td>77</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.01</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.01</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plot_data_results <span class="op">=</span> plot_and_tables[<span class="st">'table_data'</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plot_data_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip_welfare</th>
      <th>Year1990</th>
      <th>Entity</th>
      <th>Gini1990</th>
      <th>Year2017</th>
      <th>Gini2017</th>
      <th>Unnamed: 0</th>
      <th>WID_region</th>
      <th>sub-region</th>
      <th>region_alt</th>
      <th>population_ref1</th>
      <th>population_ref2</th>
      <th>avg_pop</th>
      <th>change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Argentina</td>
      <td>0.467617</td>
      <td>2017</td>
      <td>0.411345</td>
      <td>9</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.263766e+07</td>
      <td>4.405462e+07</td>
      <td>3.834614e+07</td>
      <td>-0.056273</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Australia</td>
      <td>0.331538</td>
      <td>2018</td>
      <td>0.343338</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>0.011799</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Austria</td>
      <td>0.230445</td>
      <td>2017</td>
      <td>0.297376</td>
      <td>11</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.678732e+06</td>
      <td>8.797497e+06</td>
      <td>8.238114e+06</td>
      <td>0.066931</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pip</td>
      <td>Income</td>
      <td>1988</td>
      <td>Belgium</td>
      <td>0.257147</td>
      <td>2017</td>
      <td>0.273880</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>0.016733</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Bolivia</td>
      <td>0.420357</td>
      <td>2017</td>
      <td>0.446161</td>
      <td>26</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>7.096195e+06</td>
      <td>1.143554e+07</td>
      <td>9.265865e+06</td>
      <td>0.025804</td>
    </tr>
    <tr>
      <th>5</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Brazil</td>
      <td>0.604873</td>
      <td>2017</td>
      <td>0.533341</td>
      <td>27</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.507064e+08</td>
      <td>2.085050e+08</td>
      <td>1.796057e+08</td>
      <td>-0.071532</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Bulgaria</td>
      <td>0.307143</td>
      <td>2017</td>
      <td>0.403790</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>0.096647</td>
    </tr>
    <tr>
      <th>7</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Canada</td>
      <td>0.310211</td>
      <td>2017</td>
      <td>0.333082</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>0.022871</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Chile</td>
      <td>0.572491</td>
      <td>2017</td>
      <td>0.444410</td>
      <td>40</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.334288e+07</td>
      <td>1.836858e+07</td>
      <td>1.585573e+07</td>
      <td>-0.128081</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Colombia</td>
      <td>0.535925</td>
      <td>2017</td>
      <td>0.497155</td>
      <td>43</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.260140e+07</td>
      <td>4.835167e+07</td>
      <td>4.047653e+07</td>
      <td>-0.038770</td>
    </tr>
    <tr>
      <th>10</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Costa Rica</td>
      <td>0.453015</td>
      <td>2017</td>
      <td>0.483465</td>
      <td>44</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>3.158257e+06</td>
      <td>4.993849e+06</td>
      <td>4.076053e+06</td>
      <td>0.030450</td>
    </tr>
    <tr>
      <th>11</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Czechia</td>
      <td>0.207033</td>
      <td>2017</td>
      <td>0.248522</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>0.041489</td>
    </tr>
    <tr>
      <th>12</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Denmark</td>
      <td>0.246938</td>
      <td>2017</td>
      <td>0.287467</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>0.040529</td>
    </tr>
    <tr>
      <th>13</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Dominican Republic</td>
      <td>0.504579</td>
      <td>2017</td>
      <td>0.421956</td>
      <td>56</td>
      <td>Latin America</td>
      <td>Caribbean</td>
      <td>Latin America</td>
      <td>7.129004e+06</td>
      <td>1.064725e+07</td>
      <td>8.888126e+06</td>
      <td>-0.082623</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ecuador</td>
      <td>0.504920</td>
      <td>2017</td>
      <td>0.446730</td>
      <td>58</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.044984e+07</td>
      <td>1.669695e+07</td>
      <td>1.357340e+07</td>
      <td>-0.058189</td>
    </tr>
    <tr>
      <th>15</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>El Salvador</td>
      <td>0.539519</td>
      <td>2017</td>
      <td>0.380072</td>
      <td>194</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>5.367182e+06</td>
      <td>6.266661e+06</td>
      <td>5.816922e+06</td>
      <td>-0.159447</td>
    </tr>
    <tr>
      <th>16</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Estonia</td>
      <td>0.395034</td>
      <td>2017</td>
      <td>0.303550</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>-0.091484</td>
    </tr>
    <tr>
      <th>17</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Finland</td>
      <td>0.228798</td>
      <td>2017</td>
      <td>0.273831</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>0.045033</td>
    </tr>
    <tr>
      <th>18</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>France</td>
      <td>0.321712</td>
      <td>2017</td>
      <td>0.316321</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-0.005392</td>
    </tr>
    <tr>
      <th>19</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Germany</td>
      <td>0.294398</td>
      <td>2017</td>
      <td>0.312019</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>0.017621</td>
    </tr>
    <tr>
      <th>20</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Guatemala</td>
      <td>0.595988</td>
      <td>2014</td>
      <td>0.482786</td>
      <td>82</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>9.084779e+06</td>
      <td>1.657872e+07</td>
      <td>1.283175e+07</td>
      <td>-0.113202</td>
    </tr>
    <tr>
      <th>21</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Honduras</td>
      <td>0.573567</td>
      <td>2017</td>
      <td>0.494455</td>
      <td>87</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>5.053235e+06</td>
      <td>9.626845e+06</td>
      <td>7.340040e+06</td>
      <td>-0.079112</td>
    </tr>
    <tr>
      <th>22</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Hungary</td>
      <td>0.250478</td>
      <td>2017</td>
      <td>0.305841</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>0.055363</td>
    </tr>
    <tr>
      <th>23</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ireland</td>
      <td>0.354662</td>
      <td>2017</td>
      <td>0.313598</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>-0.041064</td>
    </tr>
    <tr>
      <th>24</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Israel</td>
      <td>0.355073</td>
      <td>2017</td>
      <td>0.382021</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>0.026948</td>
    </tr>
    <tr>
      <th>25</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Italy</td>
      <td>0.325733</td>
      <td>2017</td>
      <td>0.359280</td>
      <td>99</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.675656e+07</td>
      <td>6.000402e+07</td>
      <td>5.838029e+07</td>
      <td>0.033547</td>
    </tr>
    <tr>
      <th>26</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Latvia</td>
      <td>0.269931</td>
      <td>2017</td>
      <td>0.355719</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>0.085788</td>
    </tr>
    <tr>
      <th>27</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Lithuania</td>
      <td>0.336411</td>
      <td>2017</td>
      <td>0.372897</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.036486</td>
    </tr>
    <tr>
      <th>28</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>0.267894</td>
      <td>2017</td>
      <td>0.345157</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>0.077263</td>
    </tr>
    <tr>
      <th>29</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>0.461685</td>
      <td>2015</td>
      <td>0.410664</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-0.051021</td>
    </tr>
    <tr>
      <th>30</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Mexico</td>
      <td>0.506317</td>
      <td>2018</td>
      <td>0.467070</td>
      <td>144</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>8.172042e+07</td>
      <td>1.228393e+08</td>
      <td>1.022798e+08</td>
      <td>-0.039247</td>
    </tr>
    <tr>
      <th>31</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>0.310901</td>
      <td>2017</td>
      <td>0.285358</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>-0.025543</td>
    </tr>
    <tr>
      <th>32</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Norway</td>
      <td>0.252276</td>
      <td>2017</td>
      <td>0.269873</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.017597</td>
    </tr>
    <tr>
      <th>33</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Panama</td>
      <td>0.589077</td>
      <td>2017</td>
      <td>0.498885</td>
      <td>159</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>2.449966e+06</td>
      <td>4.096071e+06</td>
      <td>3.273018e+06</td>
      <td>-0.090192</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Paraguay</td>
      <td>0.408393</td>
      <td>2017</td>
      <td>0.485475</td>
      <td>171</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>4.059198e+06</td>
      <td>6.355406e+06</td>
      <td>5.207302e+06</td>
      <td>0.077081</td>
    </tr>
    <tr>
      <th>35</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Poland</td>
      <td>0.268925</td>
      <td>2017</td>
      <td>0.296860</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>0.027936</td>
    </tr>
    <tr>
      <th>36</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Romania</td>
      <td>0.233073</td>
      <td>2017</td>
      <td>0.360168</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>0.127095</td>
    </tr>
    <tr>
      <th>37</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Slovakia</td>
      <td>0.201866</td>
      <td>2017</td>
      <td>0.232378</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>0.030512</td>
    </tr>
    <tr>
      <th>38</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Slovenia</td>
      <td>0.235984</td>
      <td>2017</td>
      <td>0.242193</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.006209</td>
    </tr>
    <tr>
      <th>39</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Spain</td>
      <td>0.320237</td>
      <td>2017</td>
      <td>0.346545</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>0.026308</td>
    </tr>
    <tr>
      <th>40</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Sweden</td>
      <td>0.249087</td>
      <td>2017</td>
      <td>0.287746</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>0.038659</td>
    </tr>
    <tr>
      <th>41</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Switzerland</td>
      <td>0.338564</td>
      <td>2017</td>
      <td>0.326763</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>-0.011801</td>
    </tr>
    <tr>
      <th>42</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Taiwan</td>
      <td>0.299678</td>
      <td>2016</td>
      <td>0.314827</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.015149</td>
    </tr>
    <tr>
      <th>43</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United Kingdom</td>
      <td>0.359274</td>
      <td>2017</td>
      <td>0.351488</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>-0.007786</td>
    </tr>
    <tr>
      <th>44</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United States</td>
      <td>0.380459</td>
      <td>2017</td>
      <td>0.411806</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>0.031346</td>
    </tr>
    <tr>
      <th>45</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Uruguay</td>
      <td>0.423694</td>
      <td>2017</td>
      <td>0.394645</td>
      <td>216</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.117011e+06</td>
      <td>3.422205e+06</td>
      <td>3.269608e+06</td>
      <td>-0.029048</td>
    </tr>
    <tr>
      <th>46</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>0.275708</td>
      <td>2016</td>
      <td>0.323853</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>0.048145</td>
    </tr>
    <tr>
      <th>47</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1994</td>
      <td>Burkina Faso</td>
      <td>0.480725</td>
      <td>2018</td>
      <td>0.473471</td>
      <td>19</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.131362e+06</td>
      <td>1.983586e+07</td>
      <td>1.448361e+07</td>
      <td>-0.007254</td>
    </tr>
    <tr>
      <th>48</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>China</td>
      <td>0.322266</td>
      <td>2017</td>
      <td>0.390758</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>0.068492</td>
    </tr>
    <tr>
      <th>49</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>0.368863</td>
      <td>2018</td>
      <td>0.371836</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>0.002973</td>
    </tr>
    <tr>
      <th>50</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>0.320039</td>
      <td>2017</td>
      <td>0.315340</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>-0.004700</td>
    </tr>
    <tr>
      <th>51</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>0.384372</td>
      <td>2016</td>
      <td>0.435209</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>0.050836</td>
    </tr>
    <tr>
      <th>52</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Guinea</td>
      <td>0.468430</td>
      <td>2018</td>
      <td>0.295920</td>
      <td>79</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6.354146e+06</td>
      <td>1.224079e+07</td>
      <td>9.297468e+06</td>
      <td>-0.172511</td>
    </tr>
    <tr>
      <th>53</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Guinea-Bissau</td>
      <td>0.436102</td>
      <td>2018</td>
      <td>0.347652</td>
      <td>84</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.735570e+05</td>
      <td>1.879835e+06</td>
      <td>1.426696e+06</td>
      <td>-0.088450</td>
    </tr>
    <tr>
      <th>54</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>India</td>
      <td>0.325742</td>
      <td>2017</td>
      <td>0.359430</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>0.033689</td>
    </tr>
    <tr>
      <th>55</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>0.322713</td>
      <td>2017</td>
      <td>0.387853</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>0.065140</td>
    </tr>
    <tr>
      <th>56</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Iran</td>
      <td>0.436048</td>
      <td>2017</td>
      <td>0.408029</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-0.028018</td>
    </tr>
    <tr>
      <th>57</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>0.574610</td>
      <td>2015</td>
      <td>0.407758</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-0.166852</td>
    </tr>
    <tr>
      <th>58</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Laos</td>
      <td>0.343098</td>
      <td>2018</td>
      <td>0.388024</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>0.044927</td>
    </tr>
    <tr>
      <th>59</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1986</td>
      <td>Lesotho</td>
      <td>0.560161</td>
      <td>2017</td>
      <td>0.448797</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-0.111364</td>
    </tr>
    <tr>
      <th>60</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1994</td>
      <td>Mali</td>
      <td>0.504412</td>
      <td>2018</td>
      <td>0.361369</td>
      <td>133</td>
      <td>Sub-Saharan Africa</td>
      <td>Western Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>8.945030e+06</td>
      <td>1.931136e+07</td>
      <td>1.412819e+07</td>
      <td>-0.143043</td>
    </tr>
    <tr>
      <th>61</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>0.439390</td>
      <td>2014</td>
      <td>0.326193</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-0.113197</td>
    </tr>
    <tr>
      <th>62</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Morocco</td>
      <td>0.392069</td>
      <td>2013</td>
      <td>0.395485</td>
      <td>126</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>2.457082e+07</td>
      <td>3.552812e+07</td>
      <td>3.004947e+07</td>
      <td>0.003416</td>
    </tr>
    <tr>
      <th>63</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Niger</td>
      <td>0.360975</td>
      <td>2018</td>
      <td>0.372810</td>
      <td>149</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>8.370650e+06</td>
      <td>2.173792e+07</td>
      <td>1.505429e+07</td>
      <td>0.011835</td>
    </tr>
    <tr>
      <th>64</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>0.449841</td>
      <td>2018</td>
      <td>0.351277</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-0.098563</td>
    </tr>
    <tr>
      <th>65</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>0.332487</td>
      <td>2018</td>
      <td>0.295893</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.036594</td>
    </tr>
    <tr>
      <th>66</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>0.438236</td>
      <td>2018</td>
      <td>0.378117</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-0.060118</td>
    </tr>
    <tr>
      <th>67</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Russia</td>
      <td>0.483757</td>
      <td>2017</td>
      <td>0.372391</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>-0.111367</td>
    </tr>
    <tr>
      <th>68</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Senegal</td>
      <td>0.541374</td>
      <td>2018</td>
      <td>0.381225</td>
      <td>188</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.536003e+06</td>
      <td>1.515779e+07</td>
      <td>1.134690e+07</td>
      <td>-0.160149</td>
    </tr>
    <tr>
      <th>69</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>0.324474</td>
      <td>2016</td>
      <td>0.393458</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>0.068983</td>
    </tr>
    <tr>
      <th>70</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>0.352922</td>
      <td>2018</td>
      <td>0.404912</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>0.051990</td>
    </tr>
    <tr>
      <th>71</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>0.452656</td>
      <td>2017</td>
      <td>0.365288</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-0.087369</td>
    </tr>
    <tr>
      <th>72</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>0.402351</td>
      <td>2015</td>
      <td>0.328159</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-0.074192</td>
    </tr>
    <tr>
      <th>73</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>0.434771</td>
      <td>2017</td>
      <td>0.414057</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-0.020714</td>
    </tr>
    <tr>
      <th>74</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>0.443627</td>
      <td>2016</td>
      <td>0.427537</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>-0.016090</td>
    </tr>
    <tr>
      <th>75</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>0.297089</td>
      <td>2017</td>
      <td>0.260490</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-0.036599</td>
    </tr>
    <tr>
      <th>76</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>0.356546</td>
      <td>2018</td>
      <td>0.357155</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>0.000610</td>
    </tr>
    <tr>
      <th>77</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>0.605062</td>
      <td>2015</td>
      <td>0.571361</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>-0.033701</td>
    </tr>
    <tr>
      <th>78</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>0.216037</td>
      <td>2017</td>
      <td>0.254446</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>0.038409</td>
    </tr>
    <tr>
      <th>79</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>0.326657</td>
      <td>2017</td>
      <td>0.274503</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>-0.052155</td>
    </tr>
    <tr>
      <th>80</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1994</td>
      <td>Peru</td>
      <td>0.440240</td>
      <td>2017</td>
      <td>0.432928</td>
      <td>160</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>2.210910e+07</td>
      <td>3.160549e+07</td>
      <td>2.685730e+07</td>
      <td>-0.007312</td>
    </tr>
    <tr>
      <th>81</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Australia</td>
      <td>0.438550</td>
      <td>2017</td>
      <td>0.496576</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>0.058025</td>
    </tr>
    <tr>
      <th>82</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bosnia and Herzegovina</td>
      <td>0.388557</td>
      <td>2015</td>
      <td>0.483055</td>
      <td>15</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.494314e+06</td>
      <td>3.440025e+06</td>
      <td>3.967170e+06</td>
      <td>0.094498</td>
    </tr>
    <tr>
      <th>83</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>0.492512</td>
      <td>2016</td>
      <td>0.529837</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>0.037326</td>
    </tr>
    <tr>
      <th>84</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Belgium</td>
      <td>0.441805</td>
      <td>2017</td>
      <td>0.436283</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>-0.005522</td>
    </tr>
    <tr>
      <th>85</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bulgaria</td>
      <td>0.359969</td>
      <td>2017</td>
      <td>0.548608</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>0.188639</td>
    </tr>
    <tr>
      <th>86</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>0.388589</td>
      <td>2017</td>
      <td>0.432584</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>0.043995</td>
    </tr>
    <tr>
      <th>87</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Canada</td>
      <td>0.466384</td>
      <td>2017</td>
      <td>0.536084</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>0.069700</td>
    </tr>
    <tr>
      <th>88</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Switzerland</td>
      <td>0.404766</td>
      <td>2017</td>
      <td>0.426631</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>0.021866</td>
    </tr>
    <tr>
      <th>89</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>0.642349</td>
      <td>2015</td>
      <td>0.601207</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>-0.041142</td>
    </tr>
    <tr>
      <th>90</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>China</td>
      <td>0.432298</td>
      <td>2016</td>
      <td>0.553714</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>0.121415</td>
    </tr>
    <tr>
      <th>91</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Cyprus</td>
      <td>0.493387</td>
      <td>2017</td>
      <td>0.472692</td>
      <td>49</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>7.885010e+05</td>
      <td>1.208527e+06</td>
      <td>9.985140e+05</td>
      <td>-0.020694</td>
    </tr>
    <tr>
      <th>92</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Czechia</td>
      <td>0.275696</td>
      <td>2017</td>
      <td>0.385990</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>0.110294</td>
    </tr>
    <tr>
      <th>93</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Germany</td>
      <td>0.437146</td>
      <td>2017</td>
      <td>0.492620</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>0.055474</td>
    </tr>
    <tr>
      <th>94</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Denmark</td>
      <td>0.380379</td>
      <td>2017</td>
      <td>0.440461</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>0.060082</td>
    </tr>
    <tr>
      <th>95</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Estonia</td>
      <td>0.363940</td>
      <td>2017</td>
      <td>0.484636</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>0.120696</td>
    </tr>
    <tr>
      <th>96</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>0.547805</td>
      <td>2017</td>
      <td>0.580786</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>0.032981</td>
    </tr>
    <tr>
      <th>97</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Spain</td>
      <td>0.484323</td>
      <td>2017</td>
      <td>0.458748</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>-0.025575</td>
    </tr>
    <tr>
      <th>98</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Finland</td>
      <td>0.369959</td>
      <td>2017</td>
      <td>0.444810</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>0.074850</td>
    </tr>
    <tr>
      <th>99</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>France</td>
      <td>0.448481</td>
      <td>2017</td>
      <td>0.422795</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-0.025686</td>
    </tr>
    <tr>
      <th>100</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United Kingdom</td>
      <td>0.459973</td>
      <td>2017</td>
      <td>0.467995</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>0.008022</td>
    </tr>
    <tr>
      <th>101</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>0.579370</td>
      <td>2016</td>
      <td>0.607839</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>0.028468</td>
    </tr>
    <tr>
      <th>102</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Gambia</td>
      <td>0.658472</td>
      <td>2015</td>
      <td>0.564250</td>
      <td>78</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.040625e+06</td>
      <td>2.381189e+06</td>
      <td>1.710907e+06</td>
      <td>-0.094221</td>
    </tr>
    <tr>
      <th>103</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Greece</td>
      <td>0.479314</td>
      <td>2017</td>
      <td>0.461731</td>
      <td>81</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.030226e+07</td>
      <td>1.069223e+07</td>
      <td>1.049724e+07</td>
      <td>-0.017583</td>
    </tr>
    <tr>
      <th>104</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Hong Kong</td>
      <td>0.551517</td>
      <td>2016</td>
      <td>0.593198</td>
      <td>86</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>5.838573e+06</td>
      <td>7.461508e+06</td>
      <td>6.650040e+06</td>
      <td>0.041681</td>
    </tr>
    <tr>
      <th>105</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Croatia</td>
      <td>0.436996</td>
      <td>2017</td>
      <td>0.463868</td>
      <td>88</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.873705e+06</td>
      <td>4.192468e+06</td>
      <td>4.533086e+06</td>
      <td>0.026872</td>
    </tr>
    <tr>
      <th>106</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Hungary</td>
      <td>0.297312</td>
      <td>2017</td>
      <td>0.422899</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>0.125587</td>
    </tr>
    <tr>
      <th>107</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>0.568412</td>
      <td>2017</td>
      <td>0.544676</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>-0.023736</td>
    </tr>
    <tr>
      <th>108</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Ireland</td>
      <td>0.417826</td>
      <td>2017</td>
      <td>0.466501</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>0.048675</td>
    </tr>
    <tr>
      <th>109</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Israel</td>
      <td>0.595894</td>
      <td>2016</td>
      <td>0.593649</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>-0.002245</td>
    </tr>
    <tr>
      <th>110</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>India</td>
      <td>0.460675</td>
      <td>2013</td>
      <td>0.627859</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>0.167184</td>
    </tr>
    <tr>
      <th>111</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iran</td>
      <td>0.625909</td>
      <td>2017</td>
      <td>0.600699</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-0.025210</td>
    </tr>
    <tr>
      <th>112</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iceland</td>
      <td>0.417678</td>
      <td>2016</td>
      <td>0.395323</td>
      <td>98</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>2.550260e+05</td>
      <td>3.436410e+05</td>
      <td>2.993335e+05</td>
      <td>-0.022355</td>
    </tr>
    <tr>
      <th>113</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Japan</td>
      <td>0.517664</td>
      <td>2017</td>
      <td>0.536420</td>
      <td>102</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.236863e+08</td>
      <td>1.266625e+08</td>
      <td>1.251744e+08</td>
      <td>0.018755</td>
    </tr>
    <tr>
      <th>114</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>0.744092</td>
      <td>2015</td>
      <td>0.599040</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-0.145052</td>
    </tr>
    <tr>
      <th>115</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>South Korea</td>
      <td>0.442973</td>
      <td>2016</td>
      <td>0.457557</td>
      <td>110</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>4.412004e+07</td>
      <td>5.151164e+07</td>
      <td>4.781584e+07</td>
      <td>0.014584</td>
    </tr>
    <tr>
      <th>116</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>0.471603</td>
      <td>2017</td>
      <td>0.528077</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>0.056474</td>
    </tr>
    <tr>
      <th>117</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Laos</td>
      <td>0.573989</td>
      <td>2018</td>
      <td>0.601271</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>0.027282</td>
    </tr>
    <tr>
      <th>118</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>0.547789</td>
      <td>2016</td>
      <td>0.591144</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>0.043355</td>
    </tr>
    <tr>
      <th>119</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Lesotho</td>
      <td>0.749035</td>
      <td>2017</td>
      <td>0.618875</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-0.130159</td>
    </tr>
    <tr>
      <th>120</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Lithuania</td>
      <td>0.367331</td>
      <td>2017</td>
      <td>0.512239</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.144908</td>
    </tr>
    <tr>
      <th>121</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>0.453629</td>
      <td>2017</td>
      <td>0.489659</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>0.036030</td>
    </tr>
    <tr>
      <th>122</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Latvia</td>
      <td>0.339362</td>
      <td>2017</td>
      <td>0.495720</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>0.156358</td>
    </tr>
    <tr>
      <th>123</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Moldova</td>
      <td>0.356043</td>
      <td>2017</td>
      <td>0.483304</td>
      <td>128</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.480206e+06</td>
      <td>3.180515e+06</td>
      <td>3.830360e+06</td>
      <td>0.127261</td>
    </tr>
    <tr>
      <th>124</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Montenegro</td>
      <td>0.407502</td>
      <td>2017</td>
      <td>0.496558</td>
      <td>129</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>6.214500e+05</td>
      <td>6.324450e+05</td>
      <td>6.269475e+05</td>
      <td>0.089056</td>
    </tr>
    <tr>
      <th>125</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>North Macedonia</td>
      <td>0.387523</td>
      <td>2017</td>
      <td>0.451206</td>
      <td>132</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.044181e+06</td>
      <td>2.111982e+06</td>
      <td>2.078082e+06</td>
      <td>0.063682</td>
    </tr>
    <tr>
      <th>126</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>0.604715</td>
      <td>2014</td>
      <td>0.521352</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-0.083363</td>
    </tr>
    <tr>
      <th>127</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Malta</td>
      <td>0.420386</td>
      <td>2017</td>
      <td>0.462370</td>
      <td>140</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.653960e+05</td>
      <td>4.795070e+05</td>
      <td>4.224515e+05</td>
      <td>0.041985</td>
    </tr>
    <tr>
      <th>128</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>0.574331</td>
      <td>2015</td>
      <td>0.517891</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-0.056440</td>
    </tr>
    <tr>
      <th>129</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>0.604243</td>
      <td>2018</td>
      <td>0.545149</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-0.059094</td>
    </tr>
    <tr>
      <th>130</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>0.379088</td>
      <td>2017</td>
      <td>0.418939</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>0.039851</td>
    </tr>
    <tr>
      <th>131</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Norway</td>
      <td>0.325342</td>
      <td>2017</td>
      <td>0.403046</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.077704</td>
    </tr>
    <tr>
      <th>132</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>New Zealand</td>
      <td>0.503937</td>
      <td>2017</td>
      <td>0.457852</td>
      <td>157</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>3.397388e+06</td>
      <td>4.746253e+06</td>
      <td>4.071820e+06</td>
      <td>-0.046086</td>
    </tr>
    <tr>
      <th>133</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>0.625968</td>
      <td>2018</td>
      <td>0.571721</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-0.054247</td>
    </tr>
    <tr>
      <th>134</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>0.539865</td>
      <td>2018</td>
      <td>0.529781</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.010084</td>
    </tr>
    <tr>
      <th>135</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Poland</td>
      <td>0.352240</td>
      <td>2017</td>
      <td>0.476097</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>0.123857</td>
    </tr>
    <tr>
      <th>136</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Portugal</td>
      <td>0.447282</td>
      <td>2017</td>
      <td>0.490039</td>
      <td>169</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.000735e+07</td>
      <td>1.030753e+07</td>
      <td>1.015744e+07</td>
      <td>0.042757</td>
    </tr>
    <tr>
      <th>137</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Romania</td>
      <td>0.358352</td>
      <td>2017</td>
      <td>0.518624</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>0.160272</td>
    </tr>
    <tr>
      <th>138</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Serbia</td>
      <td>0.431415</td>
      <td>2017</td>
      <td>0.522590</td>
      <td>174</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>7.987530e+06</td>
      <td>7.464882e+06</td>
      <td>7.726206e+06</td>
      <td>0.091175</td>
    </tr>
    <tr>
      <th>139</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Russia</td>
      <td>0.325536</td>
      <td>2017</td>
      <td>0.539676</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>0.214140</td>
    </tr>
    <tr>
      <th>140</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Saudi Arabia</td>
      <td>0.652670</td>
      <td>2017</td>
      <td>0.641671</td>
      <td>177</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>1.600477e+07</td>
      <td>3.419312e+07</td>
      <td>2.509894e+07</td>
      <td>-0.010999</td>
    </tr>
    <tr>
      <th>141</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sweden</td>
      <td>0.357106</td>
      <td>2017</td>
      <td>0.400716</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>0.043609</td>
    </tr>
    <tr>
      <th>142</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Singapore</td>
      <td>0.472960</td>
      <td>2013</td>
      <td>0.537086</td>
      <td>182</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>3.022218e+06</td>
      <td>5.764489e+06</td>
      <td>4.393354e+06</td>
      <td>0.064126</td>
    </tr>
    <tr>
      <th>143</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Slovenia</td>
      <td>0.341919</td>
      <td>2017</td>
      <td>0.409216</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.067297</td>
    </tr>
    <tr>
      <th>144</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Slovakia</td>
      <td>0.334151</td>
      <td>2017</td>
      <td>0.377925</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>0.043774</td>
    </tr>
    <tr>
      <th>145</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Sierra Leone</td>
      <td>0.742024</td>
      <td>2018</td>
      <td>0.571073</td>
      <td>186</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>4.325390e+06</td>
      <td>7.677570e+06</td>
      <td>6.001480e+06</td>
      <td>-0.170951</td>
    </tr>
    <tr>
      <th>146</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>0.675220</td>
      <td>2017</td>
      <td>0.605152</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-0.070069</td>
    </tr>
    <tr>
      <th>147</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>0.588665</td>
      <td>2015</td>
      <td>0.527590</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-0.061075</td>
    </tr>
    <tr>
      <th>148</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>0.678730</td>
      <td>2017</td>
      <td>0.612336</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-0.066394</td>
    </tr>
    <tr>
      <th>149</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Taiwan</td>
      <td>0.506670</td>
      <td>2017</td>
      <td>0.608589</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.101919</td>
    </tr>
    <tr>
      <th>150</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>0.545705</td>
      <td>2017</td>
      <td>0.612527</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>0.066822</td>
    </tr>
    <tr>
      <th>151</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>0.504411</td>
      <td>2017</td>
      <td>0.432704</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-0.071707</td>
    </tr>
    <tr>
      <th>152</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>0.621842</td>
      <td>2016</td>
      <td>0.623879</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>0.002037</td>
    </tr>
    <tr>
      <th>153</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United States</td>
      <td>0.512512</td>
      <td>2017</td>
      <td>0.580764</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>0.068252</td>
    </tr>
    <tr>
      <th>154</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>0.578893</td>
      <td>2018</td>
      <td>0.561584</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-0.017309</td>
    </tr>
    <tr>
      <th>155</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>0.720703</td>
      <td>2015</td>
      <td>0.722217</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>0.001514</td>
    </tr>
    <tr>
      <th>156</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zimbabwe</td>
      <td>0.624443</td>
      <td>2017</td>
      <td>0.635799</td>
      <td>232</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.011390e+07</td>
      <td>1.475110e+07</td>
      <td>1.243250e+07</td>
      <td>0.011355</td>
    </tr>
    <tr>
      <th>157</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Zanzibar</td>
      <td>0.545705</td>
      <td>2017</td>
      <td>0.612527</td>
      <td>233</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6.934105e+05</td>
      <td>1.615755e+06</td>
      <td>1.154583e+06</td>
      <td>0.066822</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'plot'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="1_B_within_country_trends_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;ggplot: (378121325)&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'summary'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip</th>
      <th>wid</th>
    </tr>
    <tr>
      <th>region_alt</th>
      <th>summary</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">East Asia</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>n</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.04</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.07</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.28</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Eastern Europe &amp; Central Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>9</td>
      <td>13</td>
    </tr>
    <tr>
      <th>n</th>
      <td>14</td>
      <td>14</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.02</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.04</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">MENA</th>
      <th>fall</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>n</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.02</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.02</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">North America &amp; Oceania</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>n</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.02</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.03</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">South &amp; South-East Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>n</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.02</td>
      <td>0.09</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.40</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Sub-Saharan Africa</th>
      <th>fall</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>n</th>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.05</td>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-0.06</td>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Western Europe</th>
      <th>fall</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>n</th>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.01</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.01</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">World</th>
      <th>fall</th>
      <td>18</td>
      <td>15</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>13</td>
      <td>7</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>25</td>
      <td>34</td>
    </tr>
    <tr>
      <th>n</th>
      <td>56</td>
      <td>56</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.00</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.02</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plot_data_results <span class="op">=</span> plot_and_tables[<span class="st">'table_data'</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plot_data_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip_welfare</th>
      <th>Year1990</th>
      <th>Entity</th>
      <th>Gini1990</th>
      <th>Year2017</th>
      <th>Gini2017</th>
      <th>Unnamed: 0</th>
      <th>WID_region</th>
      <th>sub-region</th>
      <th>region_alt</th>
      <th>population_ref1</th>
      <th>population_ref2</th>
      <th>avg_pop</th>
      <th>change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Australia</td>
      <td>0.331538</td>
      <td>2018</td>
      <td>0.343338</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>0.011799</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pip</td>
      <td>Income</td>
      <td>1988</td>
      <td>Belgium</td>
      <td>0.257147</td>
      <td>2017</td>
      <td>0.273880</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>0.016733</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Bulgaria</td>
      <td>0.307143</td>
      <td>2017</td>
      <td>0.403790</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>0.096647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Canada</td>
      <td>0.310211</td>
      <td>2017</td>
      <td>0.333082</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>0.022871</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Czechia</td>
      <td>0.207033</td>
      <td>2017</td>
      <td>0.248522</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>0.041489</td>
    </tr>
    <tr>
      <th>5</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Denmark</td>
      <td>0.246938</td>
      <td>2017</td>
      <td>0.287467</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>0.040529</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Estonia</td>
      <td>0.395034</td>
      <td>2017</td>
      <td>0.303550</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>-0.091484</td>
    </tr>
    <tr>
      <th>7</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Finland</td>
      <td>0.228798</td>
      <td>2017</td>
      <td>0.273831</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>0.045033</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>France</td>
      <td>0.321712</td>
      <td>2017</td>
      <td>0.316321</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-0.005392</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Germany</td>
      <td>0.294398</td>
      <td>2017</td>
      <td>0.312019</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>0.017621</td>
    </tr>
    <tr>
      <th>10</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Hungary</td>
      <td>0.250478</td>
      <td>2017</td>
      <td>0.305841</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>0.055363</td>
    </tr>
    <tr>
      <th>11</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ireland</td>
      <td>0.354662</td>
      <td>2017</td>
      <td>0.313598</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>-0.041064</td>
    </tr>
    <tr>
      <th>12</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Israel</td>
      <td>0.355073</td>
      <td>2017</td>
      <td>0.382021</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>0.026948</td>
    </tr>
    <tr>
      <th>13</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Latvia</td>
      <td>0.269931</td>
      <td>2017</td>
      <td>0.355719</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>0.085788</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Lithuania</td>
      <td>0.336411</td>
      <td>2017</td>
      <td>0.372897</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.036486</td>
    </tr>
    <tr>
      <th>15</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>0.267894</td>
      <td>2017</td>
      <td>0.345157</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>0.077263</td>
    </tr>
    <tr>
      <th>16</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>0.461685</td>
      <td>2015</td>
      <td>0.410664</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-0.051021</td>
    </tr>
    <tr>
      <th>17</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>0.310901</td>
      <td>2017</td>
      <td>0.285358</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>-0.025543</td>
    </tr>
    <tr>
      <th>18</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Norway</td>
      <td>0.252276</td>
      <td>2017</td>
      <td>0.269873</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.017597</td>
    </tr>
    <tr>
      <th>19</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Poland</td>
      <td>0.268925</td>
      <td>2017</td>
      <td>0.296860</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>0.027936</td>
    </tr>
    <tr>
      <th>20</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Romania</td>
      <td>0.233073</td>
      <td>2017</td>
      <td>0.360168</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>0.127095</td>
    </tr>
    <tr>
      <th>21</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Slovakia</td>
      <td>0.201866</td>
      <td>2017</td>
      <td>0.232378</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>0.030512</td>
    </tr>
    <tr>
      <th>22</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Slovenia</td>
      <td>0.235984</td>
      <td>2017</td>
      <td>0.242193</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.006209</td>
    </tr>
    <tr>
      <th>23</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Spain</td>
      <td>0.320237</td>
      <td>2017</td>
      <td>0.346545</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>0.026308</td>
    </tr>
    <tr>
      <th>24</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Sweden</td>
      <td>0.249087</td>
      <td>2017</td>
      <td>0.287746</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>0.038659</td>
    </tr>
    <tr>
      <th>25</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Switzerland</td>
      <td>0.338564</td>
      <td>2017</td>
      <td>0.326763</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>-0.011801</td>
    </tr>
    <tr>
      <th>26</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Taiwan</td>
      <td>0.299678</td>
      <td>2016</td>
      <td>0.314827</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.015149</td>
    </tr>
    <tr>
      <th>27</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United Kingdom</td>
      <td>0.359274</td>
      <td>2017</td>
      <td>0.351488</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>-0.007786</td>
    </tr>
    <tr>
      <th>28</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United States</td>
      <td>0.380459</td>
      <td>2017</td>
      <td>0.411806</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>0.031346</td>
    </tr>
    <tr>
      <th>29</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>0.275708</td>
      <td>2016</td>
      <td>0.323853</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>0.048145</td>
    </tr>
    <tr>
      <th>30</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>China</td>
      <td>0.322266</td>
      <td>2017</td>
      <td>0.390758</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>0.068492</td>
    </tr>
    <tr>
      <th>31</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>0.368863</td>
      <td>2018</td>
      <td>0.371836</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>0.002973</td>
    </tr>
    <tr>
      <th>32</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>0.320039</td>
      <td>2017</td>
      <td>0.315340</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>-0.004700</td>
    </tr>
    <tr>
      <th>33</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>0.384372</td>
      <td>2016</td>
      <td>0.435209</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>0.050836</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>India</td>
      <td>0.325742</td>
      <td>2017</td>
      <td>0.359430</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>0.033689</td>
    </tr>
    <tr>
      <th>35</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>0.322713</td>
      <td>2017</td>
      <td>0.387853</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>0.065140</td>
    </tr>
    <tr>
      <th>36</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Iran</td>
      <td>0.436048</td>
      <td>2017</td>
      <td>0.408029</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-0.028018</td>
    </tr>
    <tr>
      <th>37</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>0.574610</td>
      <td>2015</td>
      <td>0.407758</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-0.166852</td>
    </tr>
    <tr>
      <th>38</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Laos</td>
      <td>0.343098</td>
      <td>2018</td>
      <td>0.388024</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>0.044927</td>
    </tr>
    <tr>
      <th>39</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1986</td>
      <td>Lesotho</td>
      <td>0.560161</td>
      <td>2017</td>
      <td>0.448797</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-0.111364</td>
    </tr>
    <tr>
      <th>40</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>0.439390</td>
      <td>2014</td>
      <td>0.326193</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-0.113197</td>
    </tr>
    <tr>
      <th>41</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>0.449841</td>
      <td>2018</td>
      <td>0.351277</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-0.098563</td>
    </tr>
    <tr>
      <th>42</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>0.332487</td>
      <td>2018</td>
      <td>0.295893</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.036594</td>
    </tr>
    <tr>
      <th>43</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>0.438236</td>
      <td>2018</td>
      <td>0.378117</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-0.060118</td>
    </tr>
    <tr>
      <th>44</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Russia</td>
      <td>0.483757</td>
      <td>2017</td>
      <td>0.372391</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>-0.111367</td>
    </tr>
    <tr>
      <th>45</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>0.324474</td>
      <td>2016</td>
      <td>0.393458</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>0.068983</td>
    </tr>
    <tr>
      <th>46</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>0.352922</td>
      <td>2018</td>
      <td>0.404912</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>0.051990</td>
    </tr>
    <tr>
      <th>47</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>0.452656</td>
      <td>2017</td>
      <td>0.365288</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-0.087369</td>
    </tr>
    <tr>
      <th>48</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>0.402351</td>
      <td>2015</td>
      <td>0.328159</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-0.074192</td>
    </tr>
    <tr>
      <th>49</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>0.434771</td>
      <td>2017</td>
      <td>0.414057</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-0.020714</td>
    </tr>
    <tr>
      <th>50</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>0.443627</td>
      <td>2016</td>
      <td>0.427537</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>-0.016090</td>
    </tr>
    <tr>
      <th>51</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>0.297089</td>
      <td>2017</td>
      <td>0.260490</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-0.036599</td>
    </tr>
    <tr>
      <th>52</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>0.356546</td>
      <td>2018</td>
      <td>0.357155</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>0.000610</td>
    </tr>
    <tr>
      <th>53</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>0.605062</td>
      <td>2015</td>
      <td>0.571361</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>-0.033701</td>
    </tr>
    <tr>
      <th>54</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>0.216037</td>
      <td>2017</td>
      <td>0.254446</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>0.038409</td>
    </tr>
    <tr>
      <th>55</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>0.326657</td>
      <td>2017</td>
      <td>0.274503</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>-0.052155</td>
    </tr>
    <tr>
      <th>56</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Australia</td>
      <td>0.438550</td>
      <td>2017</td>
      <td>0.496576</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>0.058025</td>
    </tr>
    <tr>
      <th>57</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>0.492512</td>
      <td>2016</td>
      <td>0.529837</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>0.037326</td>
    </tr>
    <tr>
      <th>58</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Belgium</td>
      <td>0.441805</td>
      <td>2017</td>
      <td>0.436283</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>-0.005522</td>
    </tr>
    <tr>
      <th>59</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bulgaria</td>
      <td>0.359969</td>
      <td>2017</td>
      <td>0.548608</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>0.188639</td>
    </tr>
    <tr>
      <th>60</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>0.388589</td>
      <td>2017</td>
      <td>0.432584</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>0.043995</td>
    </tr>
    <tr>
      <th>61</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Canada</td>
      <td>0.466384</td>
      <td>2017</td>
      <td>0.536084</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>0.069700</td>
    </tr>
    <tr>
      <th>62</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Switzerland</td>
      <td>0.404766</td>
      <td>2017</td>
      <td>0.426631</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>0.021866</td>
    </tr>
    <tr>
      <th>63</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>0.642349</td>
      <td>2015</td>
      <td>0.601207</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>-0.041142</td>
    </tr>
    <tr>
      <th>64</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>China</td>
      <td>0.432298</td>
      <td>2016</td>
      <td>0.553714</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>0.121415</td>
    </tr>
    <tr>
      <th>65</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Czechia</td>
      <td>0.275696</td>
      <td>2017</td>
      <td>0.385990</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>0.110294</td>
    </tr>
    <tr>
      <th>66</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Germany</td>
      <td>0.437146</td>
      <td>2017</td>
      <td>0.492620</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>0.055474</td>
    </tr>
    <tr>
      <th>67</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Denmark</td>
      <td>0.380379</td>
      <td>2017</td>
      <td>0.440461</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>0.060082</td>
    </tr>
    <tr>
      <th>68</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Estonia</td>
      <td>0.363940</td>
      <td>2017</td>
      <td>0.484636</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>0.120696</td>
    </tr>
    <tr>
      <th>69</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>0.547805</td>
      <td>2017</td>
      <td>0.580786</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>0.032981</td>
    </tr>
    <tr>
      <th>70</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Spain</td>
      <td>0.484323</td>
      <td>2017</td>
      <td>0.458748</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>-0.025575</td>
    </tr>
    <tr>
      <th>71</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Finland</td>
      <td>0.369959</td>
      <td>2017</td>
      <td>0.444810</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>0.074850</td>
    </tr>
    <tr>
      <th>72</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>France</td>
      <td>0.448481</td>
      <td>2017</td>
      <td>0.422795</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-0.025686</td>
    </tr>
    <tr>
      <th>73</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United Kingdom</td>
      <td>0.459973</td>
      <td>2017</td>
      <td>0.467995</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>0.008022</td>
    </tr>
    <tr>
      <th>74</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>0.579370</td>
      <td>2016</td>
      <td>0.607839</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>0.028468</td>
    </tr>
    <tr>
      <th>75</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Hungary</td>
      <td>0.297312</td>
      <td>2017</td>
      <td>0.422899</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>0.125587</td>
    </tr>
    <tr>
      <th>76</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>0.568412</td>
      <td>2017</td>
      <td>0.544676</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>-0.023736</td>
    </tr>
    <tr>
      <th>77</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Ireland</td>
      <td>0.417826</td>
      <td>2017</td>
      <td>0.466501</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>0.048675</td>
    </tr>
    <tr>
      <th>78</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Israel</td>
      <td>0.595894</td>
      <td>2016</td>
      <td>0.593649</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>-0.002245</td>
    </tr>
    <tr>
      <th>79</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>India</td>
      <td>0.460675</td>
      <td>2013</td>
      <td>0.627859</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>0.167184</td>
    </tr>
    <tr>
      <th>80</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iran</td>
      <td>0.625909</td>
      <td>2017</td>
      <td>0.600699</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-0.025210</td>
    </tr>
    <tr>
      <th>81</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>0.744092</td>
      <td>2015</td>
      <td>0.599040</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-0.145052</td>
    </tr>
    <tr>
      <th>82</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>0.471603</td>
      <td>2017</td>
      <td>0.528077</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>0.056474</td>
    </tr>
    <tr>
      <th>83</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Laos</td>
      <td>0.573989</td>
      <td>2018</td>
      <td>0.601271</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>0.027282</td>
    </tr>
    <tr>
      <th>84</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>0.547789</td>
      <td>2016</td>
      <td>0.591144</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>0.043355</td>
    </tr>
    <tr>
      <th>85</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Lesotho</td>
      <td>0.749035</td>
      <td>2017</td>
      <td>0.618875</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-0.130159</td>
    </tr>
    <tr>
      <th>86</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Lithuania</td>
      <td>0.367331</td>
      <td>2017</td>
      <td>0.512239</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.144908</td>
    </tr>
    <tr>
      <th>87</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>0.453629</td>
      <td>2017</td>
      <td>0.489659</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>0.036030</td>
    </tr>
    <tr>
      <th>88</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Latvia</td>
      <td>0.339362</td>
      <td>2017</td>
      <td>0.495720</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>0.156358</td>
    </tr>
    <tr>
      <th>89</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>0.604715</td>
      <td>2014</td>
      <td>0.521352</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-0.083363</td>
    </tr>
    <tr>
      <th>90</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>0.574331</td>
      <td>2015</td>
      <td>0.517891</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-0.056440</td>
    </tr>
    <tr>
      <th>91</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>0.604243</td>
      <td>2018</td>
      <td>0.545149</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-0.059094</td>
    </tr>
    <tr>
      <th>92</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>0.379088</td>
      <td>2017</td>
      <td>0.418939</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>0.039851</td>
    </tr>
    <tr>
      <th>93</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Norway</td>
      <td>0.325342</td>
      <td>2017</td>
      <td>0.403046</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.077704</td>
    </tr>
    <tr>
      <th>94</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>0.625968</td>
      <td>2018</td>
      <td>0.571721</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-0.054247</td>
    </tr>
    <tr>
      <th>95</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>0.539865</td>
      <td>2018</td>
      <td>0.529781</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.010084</td>
    </tr>
    <tr>
      <th>96</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Poland</td>
      <td>0.352240</td>
      <td>2017</td>
      <td>0.476097</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>0.123857</td>
    </tr>
    <tr>
      <th>97</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Romania</td>
      <td>0.358352</td>
      <td>2017</td>
      <td>0.518624</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>0.160272</td>
    </tr>
    <tr>
      <th>98</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Russia</td>
      <td>0.325536</td>
      <td>2017</td>
      <td>0.539676</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>0.214140</td>
    </tr>
    <tr>
      <th>99</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sweden</td>
      <td>0.357106</td>
      <td>2017</td>
      <td>0.400716</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>0.043609</td>
    </tr>
    <tr>
      <th>100</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Slovenia</td>
      <td>0.341919</td>
      <td>2017</td>
      <td>0.409216</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.067297</td>
    </tr>
    <tr>
      <th>101</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Slovakia</td>
      <td>0.334151</td>
      <td>2017</td>
      <td>0.377925</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>0.043774</td>
    </tr>
    <tr>
      <th>102</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>0.675220</td>
      <td>2017</td>
      <td>0.605152</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-0.070069</td>
    </tr>
    <tr>
      <th>103</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>0.588665</td>
      <td>2015</td>
      <td>0.527590</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-0.061075</td>
    </tr>
    <tr>
      <th>104</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>0.678730</td>
      <td>2017</td>
      <td>0.612336</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-0.066394</td>
    </tr>
    <tr>
      <th>105</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Taiwan</td>
      <td>0.506670</td>
      <td>2017</td>
      <td>0.608589</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.101919</td>
    </tr>
    <tr>
      <th>106</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>0.545705</td>
      <td>2017</td>
      <td>0.612527</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>0.066822</td>
    </tr>
    <tr>
      <th>107</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>0.504411</td>
      <td>2017</td>
      <td>0.432704</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-0.071707</td>
    </tr>
    <tr>
      <th>108</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>0.621842</td>
      <td>2016</td>
      <td>0.623879</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>0.002037</td>
    </tr>
    <tr>
      <th>109</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United States</td>
      <td>0.512512</td>
      <td>2017</td>
      <td>0.580764</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>0.068252</td>
    </tr>
    <tr>
      <th>110</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>0.578893</td>
      <td>2018</td>
      <td>0.561584</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-0.017309</td>
    </tr>
    <tr>
      <th>111</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>0.720703</td>
      <td>2015</td>
      <td>0.722217</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>0.001514</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">All countries</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Countries with data for both sources</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'plot'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="1_B_within_country_trends_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>&lt;ggplot: (378220319)&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'summary'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip</th>
      <th>wid</th>
    </tr>
    <tr>
      <th>region_alt</th>
      <th>summary</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">East Asia</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>n</th>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>2.51</td>
      <td>6.06</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>4.02</td>
      <td>9.97</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.24</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Eastern Europe &amp; Central Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>7</td>
      <td>19</td>
    </tr>
    <tr>
      <th>n</th>
      <td>14</td>
      <td>21</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.35</td>
      <td>8.47</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-3.41</td>
      <td>12.61</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.06</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Latin America</th>
      <th>fall</th>
      <td>12</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>2</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>n</th>
      <td>16</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-4.22</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-4.99</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.09</td>
      <td>nan</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">MENA</th>
      <th>fall</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>n</th>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-1.52</td>
      <td>-2.34</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-1.43</td>
      <td>-2.10</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">North America &amp; Oceania</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>n</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>2.14</td>
      <td>5.38</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>2.62</td>
      <td>6.64</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.06</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">South &amp; South-East Asia</th>
      <th>fall</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>n</th>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.27</td>
      <td>1.47</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>1.68</td>
      <td>11.99</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.36</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Sub-Saharan Africa</th>
      <th>fall</th>
      <td>9</td>
      <td>7</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>n</th>
      <td>15</td>
      <td>13</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-4.54</td>
      <td>-3.66</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-3.63</td>
      <td>-2.99</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Western Europe</th>
      <th>fall</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>8</td>
      <td>12</td>
    </tr>
    <tr>
      <th>n</th>
      <td>15</td>
      <td>17</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>1.17</td>
      <td>2.94</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.90</td>
      <td>2.21</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">World</th>
      <th>fall</th>
      <td>35</td>
      <td>19</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>15</td>
      <td>6</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>31</td>
      <td>52</td>
    </tr>
    <tr>
      <th>n</th>
      <td>81</td>
      <td>77</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-1.40</td>
      <td>3.04</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.83</td>
      <td>8.71</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>plot_data_results <span class="op">=</span> plot_and_tables[<span class="st">'table_data'</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plot_data_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip_welfare</th>
      <th>Year1990</th>
      <th>Entity</th>
      <th>Top_10_share1990</th>
      <th>Year2017</th>
      <th>Top_10_share2017</th>
      <th>Unnamed: 0</th>
      <th>WID_region</th>
      <th>sub-region</th>
      <th>region_alt</th>
      <th>population_ref1</th>
      <th>population_ref2</th>
      <th>avg_pop</th>
      <th>change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Argentina</td>
      <td>36.609291</td>
      <td>2017</td>
      <td>29.704420</td>
      <td>9</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.263766e+07</td>
      <td>4.405462e+07</td>
      <td>3.834614e+07</td>
      <td>-6.904872</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Australia</td>
      <td>24.666855</td>
      <td>2018</td>
      <td>26.613391</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>1.946536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Austria</td>
      <td>19.288321</td>
      <td>2017</td>
      <td>22.992014</td>
      <td>11</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.678732e+06</td>
      <td>8.797497e+06</td>
      <td>8.238114e+06</td>
      <td>3.703693</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pip</td>
      <td>Income</td>
      <td>1988</td>
      <td>Belgium</td>
      <td>21.071658</td>
      <td>2017</td>
      <td>21.946776</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>0.875118</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Bolivia</td>
      <td>31.740870</td>
      <td>2017</td>
      <td>32.004725</td>
      <td>26</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>7.096195e+06</td>
      <td>1.143554e+07</td>
      <td>9.265865e+06</td>
      <td>0.263855</td>
    </tr>
    <tr>
      <th>5</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Brazil</td>
      <td>48.078114</td>
      <td>2017</td>
      <td>41.983027</td>
      <td>27</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.507064e+08</td>
      <td>2.085050e+08</td>
      <td>1.796057e+08</td>
      <td>-6.095087</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Bulgaria</td>
      <td>24.742362</td>
      <td>2017</td>
      <td>31.880406</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>7.138044</td>
    </tr>
    <tr>
      <th>7</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Canada</td>
      <td>23.601062</td>
      <td>2017</td>
      <td>25.317583</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>1.716522</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Chile</td>
      <td>47.050512</td>
      <td>2017</td>
      <td>36.341904</td>
      <td>40</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.334288e+07</td>
      <td>1.836858e+07</td>
      <td>1.585573e+07</td>
      <td>-10.708608</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Colombia</td>
      <td>42.312397</td>
      <td>2017</td>
      <td>38.983412</td>
      <td>43</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.260140e+07</td>
      <td>4.835167e+07</td>
      <td>4.047653e+07</td>
      <td>-3.328985</td>
    </tr>
    <tr>
      <th>10</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Costa Rica</td>
      <td>33.003209</td>
      <td>2017</td>
      <td>36.962493</td>
      <td>44</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>3.158257e+06</td>
      <td>4.993849e+06</td>
      <td>4.076053e+06</td>
      <td>3.959284</td>
    </tr>
    <tr>
      <th>11</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Czechia</td>
      <td>19.577514</td>
      <td>2017</td>
      <td>21.455507</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>1.877992</td>
    </tr>
    <tr>
      <th>12</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Denmark</td>
      <td>20.517957</td>
      <td>2017</td>
      <td>24.040751</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>3.522794</td>
    </tr>
    <tr>
      <th>13</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Dominican Republic</td>
      <td>39.810565</td>
      <td>2017</td>
      <td>33.501580</td>
      <td>56</td>
      <td>Latin America</td>
      <td>Caribbean</td>
      <td>Latin America</td>
      <td>7.129004e+06</td>
      <td>1.064725e+07</td>
      <td>8.888126e+06</td>
      <td>-6.308985</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ecuador</td>
      <td>38.442447</td>
      <td>2017</td>
      <td>33.804095</td>
      <td>58</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>1.044984e+07</td>
      <td>1.669695e+07</td>
      <td>1.357340e+07</td>
      <td>-4.638353</td>
    </tr>
    <tr>
      <th>15</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>El Salvador</td>
      <td>41.385584</td>
      <td>2017</td>
      <td>29.142637</td>
      <td>194</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>5.367182e+06</td>
      <td>6.266661e+06</td>
      <td>5.816922e+06</td>
      <td>-12.242947</td>
    </tr>
    <tr>
      <th>16</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Estonia</td>
      <td>31.345717</td>
      <td>2017</td>
      <td>22.486769</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>-8.858948</td>
    </tr>
    <tr>
      <th>17</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Finland</td>
      <td>19.624914</td>
      <td>2017</td>
      <td>22.649171</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>3.024256</td>
    </tr>
    <tr>
      <th>18</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>France</td>
      <td>24.729253</td>
      <td>2017</td>
      <td>25.800171</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>1.070918</td>
    </tr>
    <tr>
      <th>19</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Germany</td>
      <td>23.101566</td>
      <td>2017</td>
      <td>24.557855</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>1.456289</td>
    </tr>
    <tr>
      <th>20</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Guatemala</td>
      <td>46.783414</td>
      <td>2014</td>
      <td>38.050490</td>
      <td>82</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>9.084779e+06</td>
      <td>1.657872e+07</td>
      <td>1.283175e+07</td>
      <td>-8.732924</td>
    </tr>
    <tr>
      <th>21</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Honduras</td>
      <td>45.466254</td>
      <td>2017</td>
      <td>36.555548</td>
      <td>87</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>5.053235e+06</td>
      <td>9.626845e+06</td>
      <td>7.340040e+06</td>
      <td>-8.910705</td>
    </tr>
    <tr>
      <th>22</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Hungary</td>
      <td>21.628846</td>
      <td>2017</td>
      <td>23.903954</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>2.275108</td>
    </tr>
    <tr>
      <th>23</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ireland</td>
      <td>27.226717</td>
      <td>2017</td>
      <td>25.379254</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>-1.847463</td>
    </tr>
    <tr>
      <th>24</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Israel</td>
      <td>26.870716</td>
      <td>2017</td>
      <td>26.950802</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>0.080086</td>
    </tr>
    <tr>
      <th>25</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Italy</td>
      <td>25.110493</td>
      <td>2017</td>
      <td>26.661869</td>
      <td>99</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.675656e+07</td>
      <td>6.000402e+07</td>
      <td>5.838029e+07</td>
      <td>1.551375</td>
    </tr>
    <tr>
      <th>26</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Latvia</td>
      <td>22.065264</td>
      <td>2017</td>
      <td>26.903405</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>4.838140</td>
    </tr>
    <tr>
      <th>27</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Lithuania</td>
      <td>27.989356</td>
      <td>2017</td>
      <td>28.426225</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.436869</td>
    </tr>
    <tr>
      <th>28</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>22.241200</td>
      <td>2017</td>
      <td>25.592769</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>3.351569</td>
    </tr>
    <tr>
      <th>29</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>36.410957</td>
      <td>2015</td>
      <td>31.273352</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-5.137605</td>
    </tr>
    <tr>
      <th>30</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Mexico</td>
      <td>40.588241</td>
      <td>2018</td>
      <td>37.059124</td>
      <td>144</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>8.172042e+07</td>
      <td>1.228393e+08</td>
      <td>1.022798e+08</td>
      <td>-3.529117</td>
    </tr>
    <tr>
      <th>31</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>24.479009</td>
      <td>2017</td>
      <td>23.336959</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>-1.142050</td>
    </tr>
    <tr>
      <th>32</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Norway</td>
      <td>21.159599</td>
      <td>2017</td>
      <td>21.630730</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.471131</td>
    </tr>
    <tr>
      <th>33</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Panama</td>
      <td>42.863552</td>
      <td>2017</td>
      <td>37.707785</td>
      <td>159</td>
      <td>Latin America</td>
      <td>Central America</td>
      <td>Latin America</td>
      <td>2.449966e+06</td>
      <td>4.096071e+06</td>
      <td>3.273018e+06</td>
      <td>-5.155767</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Paraguay</td>
      <td>30.752231</td>
      <td>2017</td>
      <td>39.070560</td>
      <td>171</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>4.059198e+06</td>
      <td>6.355406e+06</td>
      <td>5.207302e+06</td>
      <td>8.318329</td>
    </tr>
    <tr>
      <th>35</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Poland</td>
      <td>21.599154</td>
      <td>2017</td>
      <td>23.519889</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>1.920735</td>
    </tr>
    <tr>
      <th>36</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Romania</td>
      <td>19.211834</td>
      <td>2017</td>
      <td>24.873175</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>5.661341</td>
    </tr>
    <tr>
      <th>37</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Slovakia</td>
      <td>18.606993</td>
      <td>2017</td>
      <td>18.449941</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>-0.157052</td>
    </tr>
    <tr>
      <th>38</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Slovenia</td>
      <td>20.400511</td>
      <td>2017</td>
      <td>20.440395</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.039884</td>
    </tr>
    <tr>
      <th>39</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Spain</td>
      <td>24.847831</td>
      <td>2017</td>
      <td>25.407197</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>0.559366</td>
    </tr>
    <tr>
      <th>40</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Sweden</td>
      <td>20.053599</td>
      <td>2017</td>
      <td>22.328605</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>2.275006</td>
    </tr>
    <tr>
      <th>41</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Switzerland</td>
      <td>26.355646</td>
      <td>2017</td>
      <td>25.547965</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>-0.807681</td>
    </tr>
    <tr>
      <th>42</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Taiwan</td>
      <td>24.180195</td>
      <td>2016</td>
      <td>25.124975</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.944780</td>
    </tr>
    <tr>
      <th>43</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United Kingdom</td>
      <td>27.107619</td>
      <td>2017</td>
      <td>26.668131</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>-0.439489</td>
    </tr>
    <tr>
      <th>44</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United States</td>
      <td>27.495398</td>
      <td>2017</td>
      <td>30.258826</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>2.763428</td>
    </tr>
    <tr>
      <th>45</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Uruguay</td>
      <td>32.229199</td>
      <td>2017</td>
      <td>29.638697</td>
      <td>216</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>3.117011e+06</td>
      <td>3.422205e+06</td>
      <td>3.269608e+06</td>
      <td>-2.590502</td>
    </tr>
    <tr>
      <th>46</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>23.287869</td>
      <td>2016</td>
      <td>26.835072</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>3.547203</td>
    </tr>
    <tr>
      <th>47</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1994</td>
      <td>Burkina Faso</td>
      <td>39.468914</td>
      <td>2018</td>
      <td>37.523679</td>
      <td>19</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.131362e+06</td>
      <td>1.983586e+07</td>
      <td>1.448361e+07</td>
      <td>-1.945235</td>
    </tr>
    <tr>
      <th>48</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>China</td>
      <td>25.795242</td>
      <td>2017</td>
      <td>29.864735</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>4.069493</td>
    </tr>
    <tr>
      <th>49</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>28.332842</td>
      <td>2018</td>
      <td>28.996185</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>0.663344</td>
    </tr>
    <tr>
      <th>50</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>26.732103</td>
      <td>2017</td>
      <td>26.916700</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>0.184597</td>
    </tr>
    <tr>
      <th>51</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>30.133824</td>
      <td>2016</td>
      <td>32.211169</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>2.077345</td>
    </tr>
    <tr>
      <th>52</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Guinea</td>
      <td>31.735661</td>
      <td>2018</td>
      <td>23.085351</td>
      <td>79</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6.354146e+06</td>
      <td>1.224079e+07</td>
      <td>9.297468e+06</td>
      <td>-8.650310</td>
    </tr>
    <tr>
      <th>53</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Guinea-Bissau</td>
      <td>34.396048</td>
      <td>2018</td>
      <td>27.600140</td>
      <td>84</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.735570e+05</td>
      <td>1.879835e+06</td>
      <td>1.426696e+06</td>
      <td>-6.795908</td>
    </tr>
    <tr>
      <th>54</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>India</td>
      <td>27.534791</td>
      <td>2017</td>
      <td>30.498487</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>2.963696</td>
    </tr>
    <tr>
      <th>55</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>26.986605</td>
      <td>2017</td>
      <td>30.177678</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>3.191073</td>
    </tr>
    <tr>
      <th>56</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Iran</td>
      <td>33.546338</td>
      <td>2017</td>
      <td>31.272775</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-2.273563</td>
    </tr>
    <tr>
      <th>57</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>47.869562</td>
      <td>2015</td>
      <td>31.561483</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-16.308079</td>
    </tr>
    <tr>
      <th>58</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Laos</td>
      <td>28.081853</td>
      <td>2018</td>
      <td>31.247059</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>3.165206</td>
    </tr>
    <tr>
      <th>59</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1986</td>
      <td>Lesotho</td>
      <td>43.568520</td>
      <td>2017</td>
      <td>32.898341</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-10.670179</td>
    </tr>
    <tr>
      <th>60</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1994</td>
      <td>Mali</td>
      <td>40.439091</td>
      <td>2018</td>
      <td>28.190943</td>
      <td>133</td>
      <td>Sub-Saharan Africa</td>
      <td>Western Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>8.945030e+06</td>
      <td>1.931136e+07</td>
      <td>1.412819e+07</td>
      <td>-12.248148</td>
    </tr>
    <tr>
      <th>61</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>31.956178</td>
      <td>2014</td>
      <td>24.929604</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-7.026574</td>
    </tr>
    <tr>
      <th>62</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Morocco</td>
      <td>30.674148</td>
      <td>2013</td>
      <td>31.885165</td>
      <td>126</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>2.457082e+07</td>
      <td>3.552812e+07</td>
      <td>3.004947e+07</td>
      <td>1.211017</td>
    </tr>
    <tr>
      <th>63</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Niger</td>
      <td>29.441762</td>
      <td>2018</td>
      <td>31.137697</td>
      <td>149</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>8.370650e+06</td>
      <td>2.173792e+07</td>
      <td>1.505429e+07</td>
      <td>1.695935</td>
    </tr>
    <tr>
      <th>64</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>31.363259</td>
      <td>2018</td>
      <td>26.743194</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-4.620065</td>
    </tr>
    <tr>
      <th>65</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>27.055213</td>
      <td>2018</td>
      <td>25.536437</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-1.518776</td>
    </tr>
    <tr>
      <th>66</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>34.695039</td>
      <td>2018</td>
      <td>29.811293</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-4.883747</td>
    </tr>
    <tr>
      <th>67</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Russia</td>
      <td>38.285299</td>
      <td>2017</td>
      <td>29.217903</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>-9.067396</td>
    </tr>
    <tr>
      <th>68</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Senegal</td>
      <td>42.815300</td>
      <td>2018</td>
      <td>30.514855</td>
      <td>188</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.536003e+06</td>
      <td>1.515779e+07</td>
      <td>1.134690e+07</td>
      <td>-12.300445</td>
    </tr>
    <tr>
      <th>69</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>27.489825</td>
      <td>2016</td>
      <td>32.562684</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>5.072860</td>
    </tr>
    <tr>
      <th>70</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>27.121081</td>
      <td>2018</td>
      <td>33.120758</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>5.999677</td>
    </tr>
    <tr>
      <th>71</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>36.362177</td>
      <td>2017</td>
      <td>28.426270</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-7.935907</td>
    </tr>
    <tr>
      <th>72</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>30.694111</td>
      <td>2015</td>
      <td>25.571884</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-5.122228</td>
    </tr>
    <tr>
      <th>73</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>35.131699</td>
      <td>2017</td>
      <td>31.911129</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-3.220570</td>
    </tr>
    <tr>
      <th>74</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>33.696381</td>
      <td>2016</td>
      <td>34.211038</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>0.514656</td>
    </tr>
    <tr>
      <th>75</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>22.854835</td>
      <td>2017</td>
      <td>21.684636</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-1.170199</td>
    </tr>
    <tr>
      <th>76</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>28.639120</td>
      <td>2018</td>
      <td>27.461965</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-1.177155</td>
    </tr>
    <tr>
      <th>77</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>42.931461</td>
      <td>2015</td>
      <td>44.380894</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>1.449433</td>
    </tr>
    <tr>
      <th>78</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>19.404814</td>
      <td>2017</td>
      <td>21.279413</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>1.874600</td>
    </tr>
    <tr>
      <th>79</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>24.937888</td>
      <td>2017</td>
      <td>22.979251</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>-1.958637</td>
    </tr>
    <tr>
      <th>80</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1994</td>
      <td>Peru</td>
      <td>33.212212</td>
      <td>2017</td>
      <td>32.299620</td>
      <td>160</td>
      <td>Latin America</td>
      <td>South America</td>
      <td>Latin America</td>
      <td>2.210910e+07</td>
      <td>3.160549e+07</td>
      <td>2.685730e+07</td>
      <td>-0.912592</td>
    </tr>
    <tr>
      <th>81</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Australia</td>
      <td>26.710000</td>
      <td>2017</td>
      <td>33.560000</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>6.850000</td>
    </tr>
    <tr>
      <th>82</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bosnia and Herzegovina</td>
      <td>27.360000</td>
      <td>2015</td>
      <td>34.690000</td>
      <td>15</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.494314e+06</td>
      <td>3.440025e+06</td>
      <td>3.967170e+06</td>
      <td>7.330000</td>
    </tr>
    <tr>
      <th>83</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>38.540000</td>
      <td>2016</td>
      <td>42.390000</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>3.850000</td>
    </tr>
    <tr>
      <th>84</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Belgium</td>
      <td>32.380000</td>
      <td>2017</td>
      <td>31.830000</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>-0.550000</td>
    </tr>
    <tr>
      <th>85</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bulgaria</td>
      <td>25.560000</td>
      <td>2017</td>
      <td>44.340000</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>18.780000</td>
    </tr>
    <tr>
      <th>86</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>29.920000</td>
      <td>2017</td>
      <td>32.990000</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>3.070000</td>
    </tr>
    <tr>
      <th>87</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Canada</td>
      <td>34.240000</td>
      <td>2017</td>
      <td>40.820000</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>6.580000</td>
    </tr>
    <tr>
      <th>88</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Switzerland</td>
      <td>30.280000</td>
      <td>2017</td>
      <td>32.150000</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>1.870000</td>
    </tr>
    <tr>
      <th>89</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>54.660000</td>
      <td>2015</td>
      <td>48.650000</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>-6.010000</td>
    </tr>
    <tr>
      <th>90</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>China</td>
      <td>30.850000</td>
      <td>2016</td>
      <td>41.800000</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>10.950000</td>
    </tr>
    <tr>
      <th>91</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Cyprus</td>
      <td>37.170000</td>
      <td>2017</td>
      <td>35.370000</td>
      <td>49</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>7.885010e+05</td>
      <td>1.208527e+06</td>
      <td>9.985140e+05</td>
      <td>-1.800000</td>
    </tr>
    <tr>
      <th>92</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Czechia</td>
      <td>18.500000</td>
      <td>2017</td>
      <td>29.640000</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>11.140000</td>
    </tr>
    <tr>
      <th>93</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Germany</td>
      <td>32.550000</td>
      <td>2017</td>
      <td>37.810000</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>5.260000</td>
    </tr>
    <tr>
      <th>94</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Denmark</td>
      <td>27.420000</td>
      <td>2017</td>
      <td>33.510000</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>6.090000</td>
    </tr>
    <tr>
      <th>95</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Estonia</td>
      <td>23.720000</td>
      <td>2017</td>
      <td>35.390000</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>11.670000</td>
    </tr>
    <tr>
      <th>96</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>46.200000</td>
      <td>2017</td>
      <td>48.320000</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>2.120000</td>
    </tr>
    <tr>
      <th>97</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Spain</td>
      <td>36.700000</td>
      <td>2017</td>
      <td>35.070000</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>-1.630000</td>
    </tr>
    <tr>
      <th>98</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Finland</td>
      <td>25.210000</td>
      <td>2017</td>
      <td>33.860000</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>8.650000</td>
    </tr>
    <tr>
      <th>99</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>France</td>
      <td>33.560000</td>
      <td>2017</td>
      <td>32.000000</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-1.560000</td>
    </tr>
    <tr>
      <th>100</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United Kingdom</td>
      <td>32.910000</td>
      <td>2017</td>
      <td>36.120000</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>3.210000</td>
    </tr>
    <tr>
      <th>101</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>47.050000</td>
      <td>2016</td>
      <td>48.910000</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>1.860000</td>
    </tr>
    <tr>
      <th>102</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Gambia</td>
      <td>55.250000</td>
      <td>2015</td>
      <td>45.870000</td>
      <td>78</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.040625e+06</td>
      <td>2.381189e+06</td>
      <td>1.710907e+06</td>
      <td>-9.380000</td>
    </tr>
    <tr>
      <th>103</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Greece</td>
      <td>33.150000</td>
      <td>2017</td>
      <td>33.920000</td>
      <td>81</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.030226e+07</td>
      <td>1.069223e+07</td>
      <td>1.049724e+07</td>
      <td>0.770000</td>
    </tr>
    <tr>
      <th>104</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Hong Kong</td>
      <td>45.480000</td>
      <td>2016</td>
      <td>48.180000</td>
      <td>86</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>5.838573e+06</td>
      <td>7.461508e+06</td>
      <td>6.650040e+06</td>
      <td>2.700000</td>
    </tr>
    <tr>
      <th>105</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Croatia</td>
      <td>29.680000</td>
      <td>2017</td>
      <td>33.220000</td>
      <td>88</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.873705e+06</td>
      <td>4.192468e+06</td>
      <td>4.533086e+06</td>
      <td>3.540000</td>
    </tr>
    <tr>
      <th>106</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Hungary</td>
      <td>22.710000</td>
      <td>2017</td>
      <td>32.990000</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>10.280000</td>
    </tr>
    <tr>
      <th>107</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>44.770000</td>
      <td>2017</td>
      <td>41.730000</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>-3.040000</td>
    </tr>
    <tr>
      <th>108</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Ireland</td>
      <td>30.980000</td>
      <td>2017</td>
      <td>34.760000</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>3.780000</td>
    </tr>
    <tr>
      <th>109</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Israel</td>
      <td>48.270000</td>
      <td>2016</td>
      <td>47.800000</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>-0.470000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>India</td>
      <td>34.400000</td>
      <td>2013</td>
      <td>56.270000</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>21.870000</td>
    </tr>
    <tr>
      <th>111</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iran</td>
      <td>53.610000</td>
      <td>2017</td>
      <td>50.940000</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-2.670000</td>
    </tr>
    <tr>
      <th>112</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iceland</td>
      <td>29.920000</td>
      <td>2016</td>
      <td>29.290000</td>
      <td>98</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>2.550260e+05</td>
      <td>3.436410e+05</td>
      <td>2.993335e+05</td>
      <td>-0.630000</td>
    </tr>
    <tr>
      <th>113</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Japan</td>
      <td>41.270000</td>
      <td>2017</td>
      <td>44.240000</td>
      <td>102</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.236863e+08</td>
      <td>1.266625e+08</td>
      <td>1.251744e+08</td>
      <td>2.970000</td>
    </tr>
    <tr>
      <th>114</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>66.340000</td>
      <td>2015</td>
      <td>48.720000</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-17.620000</td>
    </tr>
    <tr>
      <th>115</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>South Korea</td>
      <td>32.010000</td>
      <td>2016</td>
      <td>34.620000</td>
      <td>110</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>4.412004e+07</td>
      <td>5.151164e+07</td>
      <td>4.781584e+07</td>
      <td>2.610000</td>
    </tr>
    <tr>
      <th>116</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>35.290000</td>
      <td>2017</td>
      <td>40.770000</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>5.480000</td>
    </tr>
    <tr>
      <th>117</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Laos</td>
      <td>45.680000</td>
      <td>2018</td>
      <td>48.300000</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>2.620000</td>
    </tr>
    <tr>
      <th>118</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>44.620000</td>
      <td>2016</td>
      <td>48.980000</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>4.360000</td>
    </tr>
    <tr>
      <th>119</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Lesotho</td>
      <td>63.940000</td>
      <td>2017</td>
      <td>49.510000</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-14.430000</td>
    </tr>
    <tr>
      <th>120</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Lithuania</td>
      <td>24.920000</td>
      <td>2017</td>
      <td>38.800000</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>13.880000</td>
    </tr>
    <tr>
      <th>121</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>35.330000</td>
      <td>2017</td>
      <td>37.120000</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>1.790000</td>
    </tr>
    <tr>
      <th>122</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Latvia</td>
      <td>22.370000</td>
      <td>2017</td>
      <td>36.270000</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>13.900000</td>
    </tr>
    <tr>
      <th>123</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Moldova</td>
      <td>24.780000</td>
      <td>2017</td>
      <td>34.590000</td>
      <td>128</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>4.480206e+06</td>
      <td>3.180515e+06</td>
      <td>3.830360e+06</td>
      <td>9.810000</td>
    </tr>
    <tr>
      <th>124</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Montenegro</td>
      <td>28.280000</td>
      <td>2017</td>
      <td>34.970000</td>
      <td>129</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>6.214500e+05</td>
      <td>6.324450e+05</td>
      <td>6.269475e+05</td>
      <td>6.690000</td>
    </tr>
    <tr>
      <th>125</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>North Macedonia</td>
      <td>27.050000</td>
      <td>2017</td>
      <td>32.290000</td>
      <td>132</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.044181e+06</td>
      <td>2.111982e+06</td>
      <td>2.078082e+06</td>
      <td>5.240000</td>
    </tr>
    <tr>
      <th>126</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>48.330000</td>
      <td>2014</td>
      <td>40.480000</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-7.850000</td>
    </tr>
    <tr>
      <th>127</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Malta</td>
      <td>30.140000</td>
      <td>2017</td>
      <td>34.640000</td>
      <td>140</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.653960e+05</td>
      <td>4.795070e+05</td>
      <td>4.224515e+05</td>
      <td>4.500000</td>
    </tr>
    <tr>
      <th>128</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>46.100000</td>
      <td>2015</td>
      <td>40.270000</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-5.830000</td>
    </tr>
    <tr>
      <th>129</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>46.800000</td>
      <td>2018</td>
      <td>42.720000</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-4.080000</td>
    </tr>
    <tr>
      <th>130</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>27.200000</td>
      <td>2017</td>
      <td>29.880000</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>2.680000</td>
    </tr>
    <tr>
      <th>131</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Norway</td>
      <td>23.460000</td>
      <td>2017</td>
      <td>30.960000</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>7.500000</td>
    </tr>
    <tr>
      <th>132</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>New Zealand</td>
      <td>33.080000</td>
      <td>2017</td>
      <td>34.450000</td>
      <td>157</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>3.397388e+06</td>
      <td>4.746253e+06</td>
      <td>4.071820e+06</td>
      <td>1.370000</td>
    </tr>
    <tr>
      <th>133</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>51.450000</td>
      <td>2018</td>
      <td>45.400000</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-6.050000</td>
    </tr>
    <tr>
      <th>134</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>43.040000</td>
      <td>2018</td>
      <td>42.810000</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.230000</td>
    </tr>
    <tr>
      <th>135</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Poland</td>
      <td>24.320000</td>
      <td>2017</td>
      <td>37.100000</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>12.780000</td>
    </tr>
    <tr>
      <th>136</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Portugal</td>
      <td>33.170000</td>
      <td>2017</td>
      <td>37.640000</td>
      <td>169</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.000735e+07</td>
      <td>1.030753e+07</td>
      <td>1.015744e+07</td>
      <td>4.470000</td>
    </tr>
    <tr>
      <th>137</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Romania</td>
      <td>25.950000</td>
      <td>2017</td>
      <td>39.360000</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>13.410000</td>
    </tr>
    <tr>
      <th>138</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Serbia</td>
      <td>30.640000</td>
      <td>2017</td>
      <td>37.340000</td>
      <td>174</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>7.987530e+06</td>
      <td>7.464882e+06</td>
      <td>7.726206e+06</td>
      <td>6.700000</td>
    </tr>
    <tr>
      <th>139</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Russia</td>
      <td>23.950000</td>
      <td>2017</td>
      <td>45.090000</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>21.140000</td>
    </tr>
    <tr>
      <th>140</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Saudi Arabia</td>
      <td>53.430000</td>
      <td>2017</td>
      <td>52.570000</td>
      <td>177</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>1.600477e+07</td>
      <td>3.419312e+07</td>
      <td>2.509894e+07</td>
      <td>-0.860000</td>
    </tr>
    <tr>
      <th>141</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sweden</td>
      <td>26.550000</td>
      <td>2017</td>
      <td>30.270000</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>3.720000</td>
    </tr>
    <tr>
      <th>142</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Singapore</td>
      <td>37.660000</td>
      <td>2013</td>
      <td>45.260000</td>
      <td>182</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>3.022218e+06</td>
      <td>5.764489e+06</td>
      <td>4.393354e+06</td>
      <td>7.600000</td>
    </tr>
    <tr>
      <th>143</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Slovenia</td>
      <td>23.570000</td>
      <td>2017</td>
      <td>29.470000</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>5.900000</td>
    </tr>
    <tr>
      <th>144</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Slovakia</td>
      <td>23.380000</td>
      <td>2017</td>
      <td>27.470000</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>4.090000</td>
    </tr>
    <tr>
      <th>145</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Sierra Leone</td>
      <td>59.370000</td>
      <td>2018</td>
      <td>47.000000</td>
      <td>186</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>4.325390e+06</td>
      <td>7.677570e+06</td>
      <td>6.001480e+06</td>
      <td>-12.370000</td>
    </tr>
    <tr>
      <th>146</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>57.060000</td>
      <td>2017</td>
      <td>50.130000</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-6.930000</td>
    </tr>
    <tr>
      <th>147</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>47.010000</td>
      <td>2015</td>
      <td>41.370000</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-5.640000</td>
    </tr>
    <tr>
      <th>148</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>59.680000</td>
      <td>2017</td>
      <td>53.170000</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-6.510000</td>
    </tr>
    <tr>
      <th>149</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Taiwan</td>
      <td>37.030000</td>
      <td>2017</td>
      <td>48.120000</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>11.090000</td>
    </tr>
    <tr>
      <th>150</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>43.130000</td>
      <td>2017</td>
      <td>51.370000</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>8.240000</td>
    </tr>
    <tr>
      <th>151</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>38.260000</td>
      <td>2017</td>
      <td>33.050000</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-5.210000</td>
    </tr>
    <tr>
      <th>152</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>50.470000</td>
      <td>2016</td>
      <td>52.070000</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>1.600000</td>
    </tr>
    <tr>
      <th>153</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United States</td>
      <td>38.760000</td>
      <td>2017</td>
      <td>45.460000</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>6.700000</td>
    </tr>
    <tr>
      <th>154</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>45.820000</td>
      <td>2018</td>
      <td>43.750000</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-2.070000</td>
    </tr>
    <tr>
      <th>155</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>58.810000</td>
      <td>2015</td>
      <td>61.740000</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>2.930000</td>
    </tr>
    <tr>
      <th>156</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zimbabwe</td>
      <td>51.330000</td>
      <td>2017</td>
      <td>52.570000</td>
      <td>232</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.011390e+07</td>
      <td>1.475110e+07</td>
      <td>1.243250e+07</td>
      <td>1.240000</td>
    </tr>
    <tr>
      <th>157</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Zanzibar</td>
      <td>43.130000</td>
      <td>2017</td>
      <td>51.370000</td>
      <td>233</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>6.934105e+05</td>
      <td>1.615755e+06</td>
      <td>1.154583e+06</td>
      <td>8.240000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Summary</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Data</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'plot'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="1_B_within_country_trends_files/figure-html/cell-30-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>&lt;ggplot: (378327013)&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plot_and_tables[<span class="st">'summary'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip</th>
      <th>wid</th>
    </tr>
    <tr>
      <th>region_alt</th>
      <th>summary</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">East Asia</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>n</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>2.51</td>
      <td>11.02</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>4.02</td>
      <td>10.95</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.28</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Eastern Europe &amp; Central Asia</th>
      <th>fall</th>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>7</td>
      <td>13</td>
    </tr>
    <tr>
      <th>n</th>
      <td>14</td>
      <td>14</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.35</td>
      <td>10.02</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-3.41</td>
      <td>13.08</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">MENA</th>
      <th>fall</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>n</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-2.07</td>
      <td>-2.63</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-1.77</td>
      <td>-2.23</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.05</td>
      <td>0.05</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">North America &amp; Oceania</th>
      <th>fall</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>n</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>2.14</td>
      <td>6.71</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>2.62</td>
      <td>6.70</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">South &amp; South-East Asia</th>
      <th>fall</th>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>5</td>
      <td>4</td>
    </tr>
    <tr>
      <th>n</th>
      <td>10</td>
      <td>10</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.27</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>1.68</td>
      <td>12.00</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.40</td>
      <td>0.40</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Sub-Saharan Africa</th>
      <th>fall</th>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>n</th>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-3.10</td>
      <td>-3.93</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>-3.10</td>
      <td>-2.98</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Western Europe</th>
      <th>fall</th>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>6</td>
      <td>10</td>
    </tr>
    <tr>
      <th>n</th>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>0.95</td>
      <td>3.14</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>0.70</td>
      <td>2.19</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">World</th>
      <th>fall</th>
      <td>18</td>
      <td>16</td>
    </tr>
    <tr>
      <th>stable</th>
      <td>13</td>
      <td>3</td>
    </tr>
    <tr>
      <th>rise</th>
      <td>25</td>
      <td>37</td>
    </tr>
    <tr>
      <th>n</th>
      <td>56</td>
      <td>56</td>
    </tr>
    <tr>
      <th>avg change</th>
      <td>-0.22</td>
      <td>3.27</td>
    </tr>
    <tr>
      <th>Regional pop-weighted avg change</th>
      <td>1.49</td>
      <td>9.08</td>
    </tr>
    <tr>
      <th>Global pop weights</th>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_data_results <span class="op">=</span> plot_and_tables[<span class="st">'table_data'</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plot_data_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>source</th>
      <th>pip_welfare</th>
      <th>Year1990</th>
      <th>Entity</th>
      <th>Top_10_share1990</th>
      <th>Year2017</th>
      <th>Top_10_share2017</th>
      <th>Unnamed: 0</th>
      <th>WID_region</th>
      <th>sub-region</th>
      <th>region_alt</th>
      <th>population_ref1</th>
      <th>population_ref2</th>
      <th>avg_pop</th>
      <th>change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Australia</td>
      <td>24.666855</td>
      <td>2018</td>
      <td>26.613391</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>1.946536</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pip</td>
      <td>Income</td>
      <td>1988</td>
      <td>Belgium</td>
      <td>21.071658</td>
      <td>2017</td>
      <td>21.946776</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>0.875118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Bulgaria</td>
      <td>24.742362</td>
      <td>2017</td>
      <td>31.880406</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>7.138044</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Canada</td>
      <td>23.601062</td>
      <td>2017</td>
      <td>25.317583</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>1.716522</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Czechia</td>
      <td>19.577514</td>
      <td>2017</td>
      <td>21.455507</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>1.877992</td>
    </tr>
    <tr>
      <th>5</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Denmark</td>
      <td>20.517957</td>
      <td>2017</td>
      <td>24.040751</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>3.522794</td>
    </tr>
    <tr>
      <th>6</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Estonia</td>
      <td>31.345717</td>
      <td>2017</td>
      <td>22.486769</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>-8.858948</td>
    </tr>
    <tr>
      <th>7</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Finland</td>
      <td>19.624914</td>
      <td>2017</td>
      <td>22.649171</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>3.024256</td>
    </tr>
    <tr>
      <th>8</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>France</td>
      <td>24.729253</td>
      <td>2017</td>
      <td>25.800171</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>1.070918</td>
    </tr>
    <tr>
      <th>9</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Germany</td>
      <td>23.101566</td>
      <td>2017</td>
      <td>24.557855</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>1.456289</td>
    </tr>
    <tr>
      <th>10</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Hungary</td>
      <td>21.628846</td>
      <td>2017</td>
      <td>23.903954</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>2.275108</td>
    </tr>
    <tr>
      <th>11</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Ireland</td>
      <td>27.226717</td>
      <td>2017</td>
      <td>25.379254</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>-1.847463</td>
    </tr>
    <tr>
      <th>12</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Israel</td>
      <td>26.870716</td>
      <td>2017</td>
      <td>26.950802</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>0.080086</td>
    </tr>
    <tr>
      <th>13</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Latvia</td>
      <td>22.065264</td>
      <td>2017</td>
      <td>26.903405</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>4.838140</td>
    </tr>
    <tr>
      <th>14</th>
      <td>pip</td>
      <td>Income</td>
      <td>1993</td>
      <td>Lithuania</td>
      <td>27.989356</td>
      <td>2017</td>
      <td>28.426225</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>0.436869</td>
    </tr>
    <tr>
      <th>15</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>22.241200</td>
      <td>2017</td>
      <td>25.592769</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>3.351569</td>
    </tr>
    <tr>
      <th>16</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>36.410957</td>
      <td>2015</td>
      <td>31.273352</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-5.137605</td>
    </tr>
    <tr>
      <th>17</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>24.479009</td>
      <td>2017</td>
      <td>23.336959</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>-1.142050</td>
    </tr>
    <tr>
      <th>18</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Norway</td>
      <td>21.159599</td>
      <td>2017</td>
      <td>21.630730</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>0.471131</td>
    </tr>
    <tr>
      <th>19</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Poland</td>
      <td>21.599154</td>
      <td>2017</td>
      <td>23.519889</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>1.920735</td>
    </tr>
    <tr>
      <th>20</th>
      <td>pip</td>
      <td>Income</td>
      <td>1989</td>
      <td>Romania</td>
      <td>19.211834</td>
      <td>2017</td>
      <td>24.873175</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>5.661341</td>
    </tr>
    <tr>
      <th>21</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Slovakia</td>
      <td>18.606993</td>
      <td>2017</td>
      <td>18.449941</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>-0.157052</td>
    </tr>
    <tr>
      <th>22</th>
      <td>pip</td>
      <td>Income</td>
      <td>1987</td>
      <td>Slovenia</td>
      <td>20.400511</td>
      <td>2017</td>
      <td>20.440395</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>0.039884</td>
    </tr>
    <tr>
      <th>23</th>
      <td>pip</td>
      <td>Income</td>
      <td>1990</td>
      <td>Spain</td>
      <td>24.847831</td>
      <td>2017</td>
      <td>25.407197</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>0.559366</td>
    </tr>
    <tr>
      <th>24</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Sweden</td>
      <td>20.053599</td>
      <td>2017</td>
      <td>22.328605</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>2.275006</td>
    </tr>
    <tr>
      <th>25</th>
      <td>pip</td>
      <td>Income</td>
      <td>1992</td>
      <td>Switzerland</td>
      <td>26.355646</td>
      <td>2017</td>
      <td>25.547965</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>-0.807681</td>
    </tr>
    <tr>
      <th>26</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>Taiwan</td>
      <td>24.180195</td>
      <td>2016</td>
      <td>25.124975</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>0.944780</td>
    </tr>
    <tr>
      <th>27</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United Kingdom</td>
      <td>27.107619</td>
      <td>2017</td>
      <td>26.668131</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>-0.439489</td>
    </tr>
    <tr>
      <th>28</th>
      <td>pip</td>
      <td>Income</td>
      <td>1991</td>
      <td>United States</td>
      <td>27.495398</td>
      <td>2017</td>
      <td>30.258826</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>2.763428</td>
    </tr>
    <tr>
      <th>29</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>23.287869</td>
      <td>2016</td>
      <td>26.835072</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>3.547203</td>
    </tr>
    <tr>
      <th>30</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>China</td>
      <td>25.795242</td>
      <td>2017</td>
      <td>29.864735</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>4.069493</td>
    </tr>
    <tr>
      <th>31</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>28.332842</td>
      <td>2018</td>
      <td>28.996185</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>0.663344</td>
    </tr>
    <tr>
      <th>32</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>26.732103</td>
      <td>2017</td>
      <td>26.916700</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>0.184597</td>
    </tr>
    <tr>
      <th>33</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>30.133824</td>
      <td>2016</td>
      <td>32.211169</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>2.077345</td>
    </tr>
    <tr>
      <th>34</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>India</td>
      <td>27.534791</td>
      <td>2017</td>
      <td>30.498487</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>2.963696</td>
    </tr>
    <tr>
      <th>35</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>26.986605</td>
      <td>2017</td>
      <td>30.177678</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>3.191073</td>
    </tr>
    <tr>
      <th>36</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Iran</td>
      <td>33.546338</td>
      <td>2017</td>
      <td>31.272775</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-2.273563</td>
    </tr>
    <tr>
      <th>37</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>47.869562</td>
      <td>2015</td>
      <td>31.561483</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-16.308079</td>
    </tr>
    <tr>
      <th>38</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Laos</td>
      <td>28.081853</td>
      <td>2018</td>
      <td>31.247059</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>3.165206</td>
    </tr>
    <tr>
      <th>39</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1986</td>
      <td>Lesotho</td>
      <td>43.568520</td>
      <td>2017</td>
      <td>32.898341</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-10.670179</td>
    </tr>
    <tr>
      <th>40</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>31.956178</td>
      <td>2014</td>
      <td>24.929604</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-7.026574</td>
    </tr>
    <tr>
      <th>41</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>31.363259</td>
      <td>2018</td>
      <td>26.743194</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-4.620065</td>
    </tr>
    <tr>
      <th>42</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>27.055213</td>
      <td>2018</td>
      <td>25.536437</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-1.518776</td>
    </tr>
    <tr>
      <th>43</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>34.695039</td>
      <td>2018</td>
      <td>29.811293</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-4.883747</td>
    </tr>
    <tr>
      <th>44</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1993</td>
      <td>Russia</td>
      <td>38.285299</td>
      <td>2017</td>
      <td>29.217903</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>-9.067396</td>
    </tr>
    <tr>
      <th>45</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>27.489825</td>
      <td>2016</td>
      <td>32.562684</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>5.072860</td>
    </tr>
    <tr>
      <th>46</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>27.121081</td>
      <td>2018</td>
      <td>33.120758</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>5.999677</td>
    </tr>
    <tr>
      <th>47</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>36.362177</td>
      <td>2017</td>
      <td>28.426270</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-7.935907</td>
    </tr>
    <tr>
      <th>48</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>30.694111</td>
      <td>2015</td>
      <td>25.571884</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-5.122228</td>
    </tr>
    <tr>
      <th>49</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>35.131699</td>
      <td>2017</td>
      <td>31.911129</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-3.220570</td>
    </tr>
    <tr>
      <th>50</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>33.696381</td>
      <td>2016</td>
      <td>34.211038</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>0.514656</td>
    </tr>
    <tr>
      <th>51</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>22.854835</td>
      <td>2017</td>
      <td>21.684636</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-1.170199</td>
    </tr>
    <tr>
      <th>52</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>28.639120</td>
      <td>2018</td>
      <td>27.461965</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-1.177155</td>
    </tr>
    <tr>
      <th>53</th>
      <td>pip</td>
      <td>Consumption</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>42.931461</td>
      <td>2015</td>
      <td>44.380894</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>1.449433</td>
    </tr>
    <tr>
      <th>54</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>19.404814</td>
      <td>2017</td>
      <td>21.279413</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>1.874600</td>
    </tr>
    <tr>
      <th>55</th>
      <td>pip</td>
      <td>Mixed</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>24.937888</td>
      <td>2017</td>
      <td>22.979251</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>-1.958637</td>
    </tr>
    <tr>
      <th>56</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Australia</td>
      <td>26.710000</td>
      <td>2017</td>
      <td>33.560000</td>
      <td>12</td>
      <td>North America &amp; Oceania</td>
      <td>Australia and New Zealand</td>
      <td>North America &amp; Oceania</td>
      <td>1.704800e+07</td>
      <td>2.459034e+07</td>
      <td>2.081917e+07</td>
      <td>6.850000</td>
    </tr>
    <tr>
      <th>57</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Bangladesh</td>
      <td>38.540000</td>
      <td>2016</td>
      <td>42.390000</td>
      <td>17</td>
      <td>South &amp; South-East Asia</td>
      <td>Southern Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.071477e+08</td>
      <td>1.617940e+08</td>
      <td>1.344708e+08</td>
      <td>3.850000</td>
    </tr>
    <tr>
      <th>58</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Belgium</td>
      <td>32.380000</td>
      <td>2017</td>
      <td>31.830000</td>
      <td>18</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>9.959565e+06</td>
      <td>1.138449e+07</td>
      <td>1.067203e+07</td>
      <td>-0.550000</td>
    </tr>
    <tr>
      <th>59</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Bulgaria</td>
      <td>25.560000</td>
      <td>2017</td>
      <td>44.340000</td>
      <td>20</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>8.767778e+06</td>
      <td>7.182430e+06</td>
      <td>7.975104e+06</td>
      <td>18.780000</td>
    </tr>
    <tr>
      <th>60</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Belarus</td>
      <td>29.920000</td>
      <td>2017</td>
      <td>32.990000</td>
      <td>31</td>
      <td>Russia &amp; Central Asia</td>
      <td>Western Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.042853e+07</td>
      <td>9.707874e+06</td>
      <td>1.006820e+07</td>
      <td>3.070000</td>
    </tr>
    <tr>
      <th>61</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Canada</td>
      <td>34.240000</td>
      <td>2017</td>
      <td>40.820000</td>
      <td>33</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.765721e+07</td>
      <td>3.655434e+07</td>
      <td>3.210578e+07</td>
      <td>6.580000</td>
    </tr>
    <tr>
      <th>62</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Switzerland</td>
      <td>30.280000</td>
      <td>2017</td>
      <td>32.150000</td>
      <td>37</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>6.711685e+06</td>
      <td>8.451688e+06</td>
      <td>7.581686e+06</td>
      <td>1.870000</td>
    </tr>
    <tr>
      <th>63</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Cote d'Ivoire</td>
      <td>54.660000</td>
      <td>2015</td>
      <td>48.650000</td>
      <td>38</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.191054e+07</td>
      <td>2.484802e+07</td>
      <td>1.837928e+07</td>
      <td>-6.010000</td>
    </tr>
    <tr>
      <th>64</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>China</td>
      <td>30.850000</td>
      <td>2016</td>
      <td>41.800000</td>
      <td>42</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>1.153704e+09</td>
      <td>1.410276e+09</td>
      <td>1.281990e+09</td>
      <td>10.950000</td>
    </tr>
    <tr>
      <th>65</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Czechia</td>
      <td>18.500000</td>
      <td>2017</td>
      <td>29.640000</td>
      <td>50</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.030119e+07</td>
      <td>1.053132e+07</td>
      <td>1.041625e+07</td>
      <td>11.140000</td>
    </tr>
    <tr>
      <th>66</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Germany</td>
      <td>32.550000</td>
      <td>2017</td>
      <td>37.810000</td>
      <td>52</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>7.937019e+07</td>
      <td>8.262437e+07</td>
      <td>8.099728e+07</td>
      <td>5.260000</td>
    </tr>
    <tr>
      <th>67</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Denmark</td>
      <td>27.420000</td>
      <td>2017</td>
      <td>33.510000</td>
      <td>54</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.144626e+06</td>
      <td>5.737286e+06</td>
      <td>5.440956e+06</td>
      <td>6.090000</td>
    </tr>
    <tr>
      <th>68</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Estonia</td>
      <td>23.720000</td>
      <td>2017</td>
      <td>35.390000</td>
      <td>59</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.570676e+06</td>
      <td>1.317550e+06</td>
      <td>1.444113e+06</td>
      <td>11.670000</td>
    </tr>
    <tr>
      <th>69</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Egypt</td>
      <td>46.200000</td>
      <td>2017</td>
      <td>48.320000</td>
      <td>60</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>5.721463e+07</td>
      <td>1.017894e+08</td>
      <td>7.950201e+07</td>
      <td>2.120000</td>
    </tr>
    <tr>
      <th>70</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Spain</td>
      <td>36.700000</td>
      <td>2017</td>
      <td>35.070000</td>
      <td>63</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.888989e+07</td>
      <td>4.658417e+07</td>
      <td>4.273703e+07</td>
      <td>-1.630000</td>
    </tr>
    <tr>
      <th>71</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Finland</td>
      <td>25.210000</td>
      <td>2017</td>
      <td>33.860000</td>
      <td>65</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.986551e+06</td>
      <td>5.508146e+06</td>
      <td>5.247348e+06</td>
      <td>8.650000</td>
    </tr>
    <tr>
      <th>72</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>France</td>
      <td>33.560000</td>
      <td>2017</td>
      <td>32.000000</td>
      <td>70</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.641290e+07</td>
      <td>6.414409e+07</td>
      <td>6.027849e+07</td>
      <td>-1.560000</td>
    </tr>
    <tr>
      <th>73</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United Kingdom</td>
      <td>32.910000</td>
      <td>2017</td>
      <td>36.120000</td>
      <td>72</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>5.721044e+07</td>
      <td>6.606481e+07</td>
      <td>6.163763e+07</td>
      <td>3.210000</td>
    </tr>
    <tr>
      <th>74</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Ghana</td>
      <td>47.050000</td>
      <td>2016</td>
      <td>48.910000</td>
      <td>75</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.544699e+07</td>
      <td>3.022227e+07</td>
      <td>2.283463e+07</td>
      <td>1.860000</td>
    </tr>
    <tr>
      <th>75</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Hungary</td>
      <td>22.710000</td>
      <td>2017</td>
      <td>32.990000</td>
      <td>90</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.037599e+07</td>
      <td>9.788940e+06</td>
      <td>1.008246e+07</td>
      <td>10.280000</td>
    </tr>
    <tr>
      <th>76</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Indonesia</td>
      <td>44.770000</td>
      <td>2017</td>
      <td>41.730000</td>
      <td>91</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.821599e+08</td>
      <td>2.644988e+08</td>
      <td>2.233294e+08</td>
      <td>-3.040000</td>
    </tr>
    <tr>
      <th>77</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Ireland</td>
      <td>30.980000</td>
      <td>2017</td>
      <td>34.760000</td>
      <td>92</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.485370e+06</td>
      <td>4.771860e+06</td>
      <td>4.128615e+06</td>
      <td>3.780000</td>
    </tr>
    <tr>
      <th>78</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Israel</td>
      <td>48.270000</td>
      <td>2016</td>
      <td>47.800000</td>
      <td>93</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>4.803255e+06</td>
      <td>8.309256e+06</td>
      <td>6.556256e+06</td>
      <td>-0.470000</td>
    </tr>
    <tr>
      <th>79</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>India</td>
      <td>34.400000</td>
      <td>2013</td>
      <td>56.270000</td>
      <td>95</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>8.704522e+08</td>
      <td>1.354196e+09</td>
      <td>1.112324e+09</td>
      <td>21.870000</td>
    </tr>
    <tr>
      <th>80</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Iran</td>
      <td>53.610000</td>
      <td>2017</td>
      <td>50.940000</td>
      <td>97</td>
      <td>MENA</td>
      <td>South Asia</td>
      <td>MENA</td>
      <td>5.579363e+07</td>
      <td>8.450508e+07</td>
      <td>7.014935e+07</td>
      <td>-2.670000</td>
    </tr>
    <tr>
      <th>81</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Kenya</td>
      <td>66.340000</td>
      <td>2015</td>
      <td>48.720000</td>
      <td>103</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.316227e+07</td>
      <td>4.894814e+07</td>
      <td>3.605520e+07</td>
      <td>-17.620000</td>
    </tr>
    <tr>
      <th>82</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Kazakhstan</td>
      <td>35.290000</td>
      <td>2017</td>
      <td>40.770000</td>
      <td>114</td>
      <td>Russia &amp; Central Asia</td>
      <td>Central Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.686657e+07</td>
      <td>1.831482e+07</td>
      <td>1.759070e+07</td>
      <td>5.480000</td>
    </tr>
    <tr>
      <th>83</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Laos</td>
      <td>45.680000</td>
      <td>2018</td>
      <td>48.300000</td>
      <td>115</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>4.314442e+06</td>
      <td>6.997925e+06</td>
      <td>5.656184e+06</td>
      <td>2.620000</td>
    </tr>
    <tr>
      <th>84</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sri Lanka</td>
      <td>44.620000</td>
      <td>2016</td>
      <td>48.980000</td>
      <td>119</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.720410e+07</td>
      <td>2.150682e+07</td>
      <td>1.935546e+07</td>
      <td>4.360000</td>
    </tr>
    <tr>
      <th>85</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1993</td>
      <td>Lesotho</td>
      <td>63.940000</td>
      <td>2017</td>
      <td>49.510000</td>
      <td>121</td>
      <td>Sub-Saharan Africa</td>
      <td>South Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.799004e+06</td>
      <td>2.170622e+06</td>
      <td>1.984813e+06</td>
      <td>-14.430000</td>
    </tr>
    <tr>
      <th>86</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Lithuania</td>
      <td>24.920000</td>
      <td>2017</td>
      <td>38.800000</td>
      <td>122</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.785851e+06</td>
      <td>2.904452e+06</td>
      <td>3.345152e+06</td>
      <td>13.880000</td>
    </tr>
    <tr>
      <th>87</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Luxembourg</td>
      <td>35.330000</td>
      <td>2017</td>
      <td>37.120000</td>
      <td>123</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>3.812750e+05</td>
      <td>5.962900e+05</td>
      <td>4.887825e+05</td>
      <td>1.790000</td>
    </tr>
    <tr>
      <th>88</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Latvia</td>
      <td>22.370000</td>
      <td>2017</td>
      <td>36.270000</td>
      <td>124</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.689398e+06</td>
      <td>1.954861e+06</td>
      <td>2.322130e+06</td>
      <td>13.900000</td>
    </tr>
    <tr>
      <th>89</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Mauritania</td>
      <td>48.330000</td>
      <td>2014</td>
      <td>40.480000</td>
      <td>138</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.006035e+06</td>
      <td>4.160018e+06</td>
      <td>3.083026e+06</td>
      <td>-7.850000</td>
    </tr>
    <tr>
      <th>90</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Malaysia</td>
      <td>46.100000</td>
      <td>2015</td>
      <td>40.270000</td>
      <td>145</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.751706e+07</td>
      <td>3.197581e+07</td>
      <td>2.474644e+07</td>
      <td>-5.830000</td>
    </tr>
    <tr>
      <th>91</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Nigeria</td>
      <td>46.800000</td>
      <td>2018</td>
      <td>42.720000</td>
      <td>150</td>
      <td>Sub-Saharan Africa</td>
      <td>West Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>9.521426e+07</td>
      <td>1.934959e+08</td>
      <td>1.443551e+08</td>
      <td>-4.080000</td>
    </tr>
    <tr>
      <th>92</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Netherlands</td>
      <td>27.200000</td>
      <td>2017</td>
      <td>29.880000</td>
      <td>152</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>1.494455e+07</td>
      <td>1.720720e+07</td>
      <td>1.607588e+07</td>
      <td>2.680000</td>
    </tr>
    <tr>
      <th>93</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Norway</td>
      <td>23.460000</td>
      <td>2017</td>
      <td>30.960000</td>
      <td>153</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>4.241637e+06</td>
      <td>5.277396e+06</td>
      <td>4.759516e+06</td>
      <td>7.500000</td>
    </tr>
    <tr>
      <th>94</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Philippines</td>
      <td>51.450000</td>
      <td>2018</td>
      <td>45.400000</td>
      <td>163</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.155890e+07</td>
      <td>1.067385e+08</td>
      <td>8.414870e+07</td>
      <td>-6.050000</td>
    </tr>
    <tr>
      <th>95</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Pakistan</td>
      <td>43.040000</td>
      <td>2018</td>
      <td>42.810000</td>
      <td>164</td>
      <td>South &amp; South-East Asia</td>
      <td>South Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>1.154141e+08</td>
      <td>2.163796e+08</td>
      <td>1.658969e+08</td>
      <td>-0.230000</td>
    </tr>
    <tr>
      <th>96</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Poland</td>
      <td>24.320000</td>
      <td>2017</td>
      <td>37.100000</td>
      <td>165</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>3.806425e+07</td>
      <td>3.853282e+07</td>
      <td>3.829853e+07</td>
      <td>12.780000</td>
    </tr>
    <tr>
      <th>97</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Romania</td>
      <td>25.950000</td>
      <td>2017</td>
      <td>39.360000</td>
      <td>173</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>2.283623e+07</td>
      <td>1.969885e+07</td>
      <td>2.126754e+07</td>
      <td>13.410000</td>
    </tr>
    <tr>
      <th>98</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Russia</td>
      <td>23.950000</td>
      <td>2017</td>
      <td>45.090000</td>
      <td>175</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.480057e+08</td>
      <td>1.454525e+08</td>
      <td>1.467291e+08</td>
      <td>21.140000</td>
    </tr>
    <tr>
      <th>99</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Sweden</td>
      <td>26.550000</td>
      <td>2017</td>
      <td>30.270000</td>
      <td>181</td>
      <td>Europe</td>
      <td>Western Europe</td>
      <td>Western Europe</td>
      <td>8.548407e+06</td>
      <td>1.005819e+07</td>
      <td>9.303299e+06</td>
      <td>3.720000</td>
    </tr>
    <tr>
      <th>100</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Slovenia</td>
      <td>23.570000</td>
      <td>2017</td>
      <td>29.470000</td>
      <td>184</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>1.986030e+06</td>
      <td>2.098396e+06</td>
      <td>2.042213e+06</td>
      <td>5.900000</td>
    </tr>
    <tr>
      <th>101</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1988</td>
      <td>Slovakia</td>
      <td>23.380000</td>
      <td>2017</td>
      <td>27.470000</td>
      <td>185</td>
      <td>Europe</td>
      <td>Eastern Europe</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.261310e+06</td>
      <td>5.439418e+06</td>
      <td>5.350364e+06</td>
      <td>4.090000</td>
    </tr>
    <tr>
      <th>102</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Thailand</td>
      <td>57.060000</td>
      <td>2017</td>
      <td>50.130000</td>
      <td>201</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>5.522841e+07</td>
      <td>7.089821e+07</td>
      <td>6.306331e+07</td>
      <td>-6.930000</td>
    </tr>
    <tr>
      <th>103</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Tunisia</td>
      <td>47.010000</td>
      <td>2015</td>
      <td>41.370000</td>
      <td>206</td>
      <td>MENA</td>
      <td>North Africa</td>
      <td>MENA</td>
      <td>8.440035e+06</td>
      <td>1.181144e+07</td>
      <td>1.012574e+07</td>
      <td>-5.640000</td>
    </tr>
    <tr>
      <th>104</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1987</td>
      <td>Turkey</td>
      <td>59.680000</td>
      <td>2017</td>
      <td>53.170000</td>
      <td>208</td>
      <td>MENA</td>
      <td>West Asia</td>
      <td>MENA</td>
      <td>5.432414e+07</td>
      <td>8.208982e+07</td>
      <td>6.820698e+07</td>
      <td>-6.510000</td>
    </tr>
    <tr>
      <th>105</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>Taiwan</td>
      <td>37.030000</td>
      <td>2017</td>
      <td>48.120000</td>
      <td>211</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>East Asia</td>
      <td>2.058618e+07</td>
      <td>2.366503e+07</td>
      <td>2.212560e+07</td>
      <td>11.090000</td>
    </tr>
    <tr>
      <th>106</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Tanzania</td>
      <td>43.130000</td>
      <td>2017</td>
      <td>51.370000</td>
      <td>212</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>2.620602e+07</td>
      <td>5.626704e+07</td>
      <td>4.123653e+07</td>
      <td>8.240000</td>
    </tr>
    <tr>
      <th>107</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Ukraine</td>
      <td>38.260000</td>
      <td>2017</td>
      <td>33.050000</td>
      <td>213</td>
      <td>Russia &amp; Central Asia</td>
      <td>West Asia</td>
      <td>Eastern Europe &amp; Central Asia</td>
      <td>5.158982e+07</td>
      <td>4.465726e+07</td>
      <td>4.812354e+07</td>
      <td>-5.210000</td>
    </tr>
    <tr>
      <th>108</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1989</td>
      <td>Uganda</td>
      <td>50.470000</td>
      <td>2016</td>
      <td>52.070000</td>
      <td>214</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>1.758663e+07</td>
      <td>4.012710e+07</td>
      <td>2.885686e+07</td>
      <td>1.600000</td>
    </tr>
    <tr>
      <th>109</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1990</td>
      <td>United States</td>
      <td>38.760000</td>
      <td>2017</td>
      <td>45.460000</td>
      <td>215</td>
      <td>North America &amp; Oceania</td>
      <td>North America</td>
      <td>North America &amp; Oceania</td>
      <td>2.480837e+08</td>
      <td>3.297912e+08</td>
      <td>2.889375e+08</td>
      <td>6.700000</td>
    </tr>
    <tr>
      <th>110</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1992</td>
      <td>Vietnam</td>
      <td>45.820000</td>
      <td>2018</td>
      <td>43.750000</td>
      <td>223</td>
      <td>South &amp; South-East Asia</td>
      <td>South-East Asia</td>
      <td>South &amp; South-East Asia</td>
      <td>6.691262e+07</td>
      <td>9.403305e+07</td>
      <td>8.047283e+07</td>
      <td>-2.070000</td>
    </tr>
    <tr>
      <th>111</th>
      <td>wid</td>
      <td>NaN</td>
      <td>1991</td>
      <td>Zambia</td>
      <td>58.810000</td>
      <td>2015</td>
      <td>61.740000</td>
      <td>231</td>
      <td>Sub-Saharan Africa</td>
      <td>East Africa</td>
      <td>Sub-Saharan Africa</td>
      <td>7.686405e+06</td>
      <td>1.729806e+07</td>
      <td>1.249223e+07</td>
      <td>2.930000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Next measure</p>
</div>
</div>
</div>
</section>
<section id="method-2-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="method-2-regression-analysis">Method 2: regression analysis</h2>
</section>
<section id="explore-the-date" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-date">Explore the date</h2>
<p>I plan to build a Shiny app to help compare trends across datasets (using Shinylive – built on Shiny for Python - ).</p>
<p>Here is a test app just so I can test the wiring of how such an app works.</p>
<pre class="shinylive-python"><code>#| standalone: true
#| viewerHeight: 420

from shiny import *
from plotnine import *
from pyodide.http import open_url
import pandas as pd
import numpy as np





#  ---------------------------------
#  ---------- Data prep functions -------------
#  ----------------------------------

#  Function get matching for ref years
def closest_to_reference(df, reference_val, max_dist_from_ref, reference_col, group_by_col, value_col, tie_break):
  
  df = df.loc[:, [reference_col, group_by_col, value_col]]

  # Drop NAs
  df = df.dropna()

  # Calculate absolute distance from reference value
  df['ref_diff'] = abs(df[reference_col] - reference_val)

  # Drop any rows with a distance beyond threshold
  if not pd.isna(max_dist_from_ref):
    df = df.loc[df['ref_diff'] &lt;= max_dist_from_ref]

  # Keep closest observation to reference value – including tie-breaks (where there is a match above and below the ref value)
  df = df[df.groupby(group_by_col)['ref_diff'].transform('min') == df['ref_diff']].reset_index(drop=True)

  # Settle tie-breaks
  if tie_break == 'below':
    df = df[df.groupby(group_by_col)[reference_col].transform('min') == df[reference_col]].reset_index(drop=True)
    
  elif tie_break == 'above':
    df = df[df.groupby(group_by_col)[reference_col].transform('max') == df[reference_col]].reset_index(drop=True)

  df = df.drop('ref_diff', axis=1)

  return df




# Merge matches for different reference points
def merge_two_ref_matches(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):

# Make sure the pair of reference values are in ascending order
  reference_vals.sort()

# Maximise distance between two refs by settling tie-breaks below the lowest ref and above the highest ref 

# Find matches for lower reference value
  lower_ref_matches = closest_to_reference(df, reference_vals[0], max_dist_from_refs, reference_col, group_by_col, value_col, 'below')

# Find matches for higher reference value
  higher_ref_matches = closest_to_reference(df, reference_vals[1], max_dist_from_refs, reference_col, group_by_col, value_col, 'above')

# Merge the two sets of matches
  merged_df = pd.merge(lower_ref_matches, higher_ref_matches, on=group_by_col, suffixes=(reference_vals[0], reference_vals[1]))

# Drop obs that do not have data for both ref values
  merged_df = merged_df.dropna()

# Drop obs where the matched data does not meet the min distance requirement
  if not pd.isna(min_dist_between):
  
  # Store the names of the reference column returned from the two matches
    ref_var_high = f'{reference_col}{reference_vals[1]}'
    ref_var_low = f'{reference_col}{reference_vals[0]}'

  # Keep only rows &gt;= to the min distance
    merged_df = merged_df.loc[(merged_df[ref_var_high] - merged_df[ref_var_low]) &gt;= min_dist_between, :]


  return merged_df



  # For PIP run this three times – first filtering data for just consumpion only, then with income only, then with a dataset that prefers income over consumption
def pip_welfare_routine(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):

    # Specify the name of the column in which the income/consumption welfare definition is stored
    welfare_colname = 'welfare_type'

    # Creat dataframes for thee scenarios:
    # Scenario 1: only allow income data
    df_inc_filter = df.loc[df[welfare_colname] == "income", :]
    df_inc_filter.name = "Income"

    # Scenario 2: only allow consumption data
    df_cons_filter = df.loc[df[welfare_colname] == "consumption", :]
    df_cons_filter.name = "Consumption"
    # Scenario 3: allow a mix – dropping consumption data where income data is available in the same year
    df_mixed = df.copy()

    df_mixed['welfare_count'] = df_mixed.groupby([reference_col, group_by_col])[welfare_colname].transform('count')

    df_mixed = df_mixed.loc[(df_mixed['welfare_count'] == 1) | (df_mixed[welfare_colname] == "income")]

    df_mixed.name = "Mixed"
    #  Store the scneario dataframes in a list
    df_scenarios = [df_inc_filter, df_cons_filter, df_mixed]

    # Run the matching function on each scenario
    scenario_matches = [merge_two_ref_matches(
      df_scenario, 
      reference_vals, 
      max_dist_from_refs, 
      min_dist_between, 
      reference_col, 
      group_by_col, 
      value_col) for df_scenario in df_scenarios]
    
    # Combine the first two scenarios.
    df_combined_matches = pd.concat([scenario_matches[0], scenario_matches[1]], keys=[df_scenarios[0].name, df_scenarios[1].name])

    # Tidy up indexes
    df_combined_matches = df_combined_matches.reset_index()
    
    df_combined_matches = df_combined_matches.drop('level_1', axis=1)

    df_combined_matches = df_combined_matches\
      .rename(columns={"level_0": "pip_welfare"})

    # Add in third scenario.
    df_combined_matches = pd.concat([df_combined_matches, scenario_matches[2]])

    # add scenario name to te pip_welfare column
    df_combined_matches['pip_welfare'] = df_combined_matches['pip_welfare'].fillna(df_scenarios[2].name)

    # Keep only one match per group (e.g. per Country) - in the priority laid out in the df_scenarios list above (income only -&gt; consumption only -&gt; mixed)
      # First count the matches
    df_combined_matches['match_count'] = df_combined_matches.groupby(group_by_col)['pip_welfare'].transform('count')
      # Then drop any matches from the lowest priority where there are multiple matches
    df_combined_matches = df_combined_matches.loc[(df_combined_matches['match_count']==1) | ~(df_combined_matches['pip_welfare']==df_scenarios[2].name)]
      #  Repeat at the next level of priority
    df_combined_matches['match_count'] = df_combined_matches.groupby(group_by_col)['pip_welfare'].transform('count')
    df_combined_matches = df_combined_matches.loc[(df_combined_matches['match_count']==1) | ~(df_combined_matches['pip_welfare']==df_scenarios[1].name)]
    
    # Drop the match count column
    df_combined_matches = df_combined_matches.drop('match_count', axis=1)

    return df_combined_matches


#  ---------------------------------
#  ---------- Specifications -------------
#  ----------------------------------

# These parameters are not controlled in the app.
reference_col = 'Year'
group_by_col = 'Entity'

tolerance = 1
outlier_cut_off_upper = None

source_count_requirement = 2





#  ---------------------------------
#  ---------- App code -------------
#  ----------------------------------

def panel_box(*args, **kwargs):
    return ui.div(
        ui.div(*args, class_="card-body"),
        **kwargs,
        class_="card mb-3",
    )

app_ui = ui.page_fluid(
    {"class": "p-4"},
    ui.row(
        ui.column(
            4,
            panel_box(
                ui.input_slider("reference_vals", "Reference years", 1975, 2020, value=[1990,2018]),
                ui.input_numeric(
                            "max_dist_from_refs",
                            "=/- (years)",
                            4,
                        ),
                ui.input_numeric(
                            "min_dist_between",
                            "Min distance between observations (years)",
                            23,
                        ),
                ui.input_action_button(
                    "download", "Download data and image", class_="btn-primary w-100"
                ),
            ),
            ui.navset_tab_card(
                ui.nav(
                    "Compare sources",
                    ui.input_select(
                "metric",
                "Metric",
                {
                    "Gini": "Gini",
                    "Top_10_share": "Top 10p.c. share",
                },
            ),
            ),
                ui.nav(
                  "Compare metrics"),
            ),
        ),
        ui.column(
            8,
            ui.output_plot("example_plot")
            ),
    ),
)


def server(input, output, session):
    @output
    @render.plot
    def example_plot():
    
      url = 'https://raw.githubusercontent.com/JoeHasell/personal_site/main/PhD_pages/data_appendices/data/clean/pip.csv'
        
      df_pip = pd.read_csv(open_url(url))


      url = 'https://raw.githubusercontent.com/JoeHasell/personal_site/main/PhD_pages/data_appendices/data/clean/wid.csv'

      df_wid = pd.read_csv(open_url(url))

      url = 'https://raw.githubusercontent.com/JoeHasell/personal_site/main/PhD_pages/data_appendices/data/clean/WID_region_mapping.csv'

      df_regions = pd.read_csv(open_url(url))


      url = 'https://raw.githubusercontent.com/JoeHasell/personal_site/main/PhD_pages/data_appendices/data/clean/population.csv'

      df_pop = pd.read_csv(open_url(url))













      def prep_wid_pip_data(reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):
        
        pip_matches = pip_welfare_routine(
          df = df_pip,
          reference_vals = reference_vals,
          max_dist_from_refs = max_dist_from_refs,
          min_dist_between = min_dist_between,
          reference_col = reference_col,
          group_by_col = group_by_col,
          value_col = value_col
        )

        wid_matches = merge_two_ref_matches(
          df = df_wid,
          reference_vals = reference_vals,
          max_dist_from_refs = max_dist_from_refs,
          min_dist_between = min_dist_between,
          reference_col = reference_col,
          group_by_col = group_by_col,
          value_col = value_col
        )

        ref_pairs = pd.concat([pip_matches, wid_matches,], keys=['pip', 'wid'])

        # Tidy up indexes
        ref_pairs = ref_pairs.reset_index()
        
        ref_pairs = ref_pairs.drop('level_1', axis=1)

        ref_pairs = ref_pairs\
          .rename(columns={"level_0": "source"})

        return ref_pairs




      def prep_plot_and_tables(
        reference_vals, 
        max_dist_from_refs,
        min_dist_between,
        reference_col,
        group_by_col,
        value_col,
        tolerance,
        outlier_cut_off_upper,
        source_count_requirement):

        # Other spec:
        region_col = 'region_alt'

        # ---- Prep data ---------

        plot_data = prep_wid_pip_data(
          reference_vals = reference_vals, 
          max_dist_from_refs = max_dist_from_refs,
          min_dist_between = min_dist_between,
          reference_col = reference_col,
          group_by_col = group_by_col,
          value_col = value_col,
        )

        # Store the names of the columns to be used onthe X and Y axis
        x_axis = f'{value_col}{reference_vals[0]}'
        y_axis = f'{value_col}{reference_vals[1]}'

        x_ref_val = f'{reference_col}{reference_vals[0]}'
        y_ref_val = f'{reference_col}{reference_vals[1]}'


        # Apply outlier cut off, if specified
        if not pd.isna(outlier_cut_off_upper):
          plot_data = plot_data.loc[plot_data[x_axis] &lt;= outlier_cut_off_upper]
          plot_data = plot_data.loc[plot_data[y_axis] &lt;= outlier_cut_off_upper]


        # Add a count by country – showing whether data is available from both sources or not
        plot_data['source_count'] = plot_data.groupby(group_by_col)['source'].transform('count')

        # Apply source requirement (whether to include only observations with data from both sources)
        plot_data = plot_data.loc[plot_data['source_count'] &gt;= source_count_requirement]

        # Drop source_count column
        plot_data = plot_data.drop('source_count', axis=1)

        # Add in region classification
        plot_data = pd.merge(plot_data, df_regions, how = 'left')

        # Add in population data
          # For first ref
        df_pop_ref = df_pop.loc[df_pop['Year'] == reference_vals[0], ['Entity', 'population'] ]

        plot_data = pd.merge(plot_data, df_pop_ref, how = 'left')

        plot_data = plot_data.rename(columns={'population':'population_ref1'})

          # For second ref
        df_pop_ref = df_pop.loc[df_pop['Year'] == reference_vals[1], ['Entity', 'population'] ]

        plot_data = pd.merge(plot_data, df_pop_ref, how = 'left')

        plot_data = plot_data.rename(columns={'population':'population_ref2'})

          # Calculate average population two reference periods
        plot_data['avg_pop'] = (plot_data['population_ref1'] + plot_data['population_ref2'])/2



        # ----- Prep plot ------

        # I grab what I am guessing to be the max and min tick marks on the x axist, in order to define the coordinates of a 'tolerance' ribbon.
        x_min = plot_data[x_axis].min()
        x_min_floor = np.floor(x_min * 10) / 10

        x_max = plot_data[x_axis].max()
        x_max_ceiling = np.ceil(x_max * 10) / 10

        # Set the coordinates of the shaded ribbon
        shaded_coord = pd.DataFrame({'x': [x_min_floor, x_max_ceiling, x_max_ceiling, x_min_floor], 
          'y': [x_min_floor-tolerance, x_max_ceiling-tolerance, x_max_ceiling+tolerance , x_min_floor+tolerance]})


        plot = (ggplot(plot_data
        , aes(x_axis, y_axis, alpha=0.5))
        + geom_point(aes(color=region_col, size='avg_pop', alpha = 0.6))
        + facet_wrap('~ source')
        + geom_polygon(aes(x='x', y='y', alpha = 0.2), data=shaded_coord)
        + theme_light()
        + theme(legend_position='none')
        )


        # ---- Prep summary table ----


        # Calculate the change between the two ref periods
        plot_data['change'] = (plot_data[y_axis] - plot_data[x_axis])


        group_yes_vars = ['source', region_col]
        group_no_vars = ['source']

        group_scenarios = [group_no_vars, group_yes_vars] 

        aggs = []
        
        for group_vars in group_scenarios:
        
        # Prepare pop-weighted average change
          agg_level = plot_data.copy()

          # Calulate pop weights by source and region
          agg_level['regional_pop_weights'] = agg_level.groupby(group_vars)['avg_pop'].transform(lambda x: x/x.sum()) 

          agg_level['global_pop_weights'] = agg_level.groupby('source')['avg_pop'].transform(lambda x: x/x.sum()) 

          # Multiply the change by the pop weights 
          agg_level['region_weighted_change'] = agg_level['change'] * agg_level['regional_pop_weights']


        # Prepare fall/stable/rise categories
          agg_level['fall'] = agg_level['change'] &lt; -tolerance

          agg_level['stable'] = (agg_level['change'] &lt;= tolerance) &amp; (agg_level['change'] &gt;= -tolerance)

          agg_level['rise'] = agg_level['change'] &gt; tolerance

          agg_level[['fall', 'stable', 'rise']] = agg_level[['fall', 'stable', 'rise']].astype(int)

          agg_level = agg_level.groupby(group_vars)[['change', 'region_weighted_change', 'global_pop_weights', 'fall', 'stable', 'rise']]\
            .agg(['sum', 'mean', 'count'])

        # Aggregate by source and region
          if group_vars == group_yes_vars:

            agg_level = agg_level\
              .unstack().T.reset_index()

          elif group_vars == group_no_vars: 

            agg_level = agg_level\
              .T.reset_index()

            agg_level[region_col] = "World"

          aggs.append(agg_level) 

        
        df_summary = pd.concat(aggs)

          # filter for the aggregations we need and label in the 'summary' column
        df_summary.loc[(df_summary['level_0'] == 'change') &amp; (df_summary['level_1'] == 'mean'), 'summary'] = 'avg change'

        df_summary.loc[(df_summary['level_0'] == 'region_weighted_change') &amp; (df_summary['level_1'] == 'sum'), 'summary'] = 'Regional pop-weighted avg change'

        df_summary.loc[(df_summary['level_0'] == 'global_pop_weights') &amp; (df_summary['level_1'] == 'sum'), 'summary'] = 'Global pop weights'

        df_summary.loc[(df_summary['level_0'] == 'change') &amp; (df_summary['level_1'] == 'count'), 'summary'] = 'n'

        df_summary.loc[(df_summary['level_0'] == 'fall') &amp; (df_summary['level_1'] == 'sum'), 'summary'] = 'fall'

        df_summary.loc[(df_summary['level_0'] == 'stable') &amp; (df_summary['level_1'] == 'sum'), 'summary'] = 'stable'

        df_summary.loc[(df_summary['level_0'] == 'rise') &amp; (df_summary['level_1'] == 'sum'), 'summary'] = 'rise'

        df_summary = df_summary[df_summary['summary'].notnull()]


        df_summary = df_summary.drop(['level_0', 'level_1'], axis = 1)


        df_summary['summary'] = pd.Categorical(df_summary['summary'], categories=['fall', 'stable', 'rise','n', 'avg change', 'Regional pop-weighted avg change', 'Global pop weights'], ordered=True)


        df_summary = df_summary.sort_values([region_col,'summary']).set_index([region_col,'summary'])
        
        
        # format to show appropriate d.p. I run a loop over each row for want of figuring out a better way!
        repeat_length = 7
        for i in range(0, len(df_summary.index.levels[0].unique())):
          df_summary.iloc[i*repeat_length,:] = df_summary.iloc[i*repeat_length,:].map('{:.0f}'.format)
          df_summary.iloc[1 + i*repeat_length,:] = df_summary.iloc[1 + i*repeat_length,:].map('{:.0f}'.format)
          df_summary.iloc[2 + i*repeat_length,:] = df_summary.iloc[2 + i*repeat_length,:].map('{:.0f}'.format)
          df_summary.iloc[3 + i*repeat_length,:] = df_summary.iloc[3 + i*repeat_length,:].map('{:.0f}'.format)
          df_summary.iloc[4 + i*repeat_length,:] = df_summary.iloc[4 + i*repeat_length,:].map('{:.2f}'.format)
          df_summary.iloc[5 + i*repeat_length,:] = df_summary.iloc[5 + i*repeat_length,:].map('{:.2f}'.format)
          df_summary.iloc[6 + i*repeat_length,:] = df_summary.iloc[6 + i*repeat_length,:].map('{:.2f}'.format)



        # ----- Return outputs ------
        plot_and_tables = {
          "table_data": plot_data,
          "plot": plot,
          "summary": df_summary
        }
        
        return plot_and_tables















      

      plot_and_tables = prep_plot_and_tables(
          reference_vals = list(input.reference_vals()), 
          max_dist_from_refs = input.max_dist_from_refs(),
          min_dist_between = input.min_dist_between(),
          reference_col = reference_col,
          group_by_col = group_by_col,
          value_col = input.metric(),
          tolerance = tolerance,
          outlier_cut_off_upper = outlier_cut_off_upper,
          source_count_requirement = source_count_requirement
          )

      plot = plot_and_tables['plot']

      return plot


app = App(app_ui, server)
</code></pre>
<pre class="shinylive-python"><code>#| standalone: true
#| viewerHeight: 420

from shiny import *
from plotnine import *
from pyodide.http import open_url
import pandas as pd



app_ui = ui.page_fluid(
    ui.output_plot("example_plot"),
)


def server(input, output, session):
    @output
    @render.plot
    def example_plot():
    
        url = 'https://raw.githubusercontent.com/owid/notebooks/main/BetterDataDocs/JoeHasell/PIP/data/ppp_2017/final/PIP_data_public_download/full_dataset/cons_only/poverty_cons_only.csv'
        
        df = pd.read_csv(open_url(url))

        plot = (ggplot(df, aes('Year', 'headcount_ratio_365', color = 'Entity'))
        + geom_line())

        # d = {'col1': [1, 2], 'col2': [3, 4]}
        # df = pd.DataFrame(data=d)
        # plot = (ggplot(df, aes('col1', 'col2'))
        # + geom_point())


        return plot


app = App(app_ui, server)
</code></pre>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #  -----------------------------------</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #  ------- Data prep functions -------</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #  -----------------------------------</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #  Function get matching for ref years</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># def closest_to_reference(df, reference_val, max_dist_from_ref, reference_col, group_by_col, value_col, tie_break):</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df = df.loc[:, [reference_col, group_by_col, value_col]]</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Drop NAs</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df = df.dropna()</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Calculate absolute distance from reference value</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df['ref_diff'] = abs(df[reference_col] - reference_val)</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Drop any rows with a distance beyond threshold</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     if not pd.isna(max_dist_from_ref):</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       df = df.loc[df['ref_diff'] &lt;= max_dist_from_ref]</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Keep closest observation to reference value – including tie-breaks (where there is a match above and below the ref value)</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df = df[df.groupby(group_by_col)['ref_diff'].transform('min') == df['ref_diff']].reset_index(drop=True)</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Settle tie-breaks</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     if tie_break == 'below':</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       df = df[df.groupby(group_by_col)[reference_col].transform('min') == df[reference_col]].reset_index(drop=True)</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     elif tie_break == 'above':</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       df = df[df.groupby(group_by_col)[reference_col].transform('max') == df[reference_col]].reset_index(drop=True)</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df = df.drop('ref_diff', axis=1)</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     return df</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   def merge_two_ref_matches(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Make sure the pair of reference values are in ascending order</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     reference_vals.sort()</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Maximise distance between two refs by settling tie-breaks below the lowest ref and above the highest ref </span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Find matches for lower reference value</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     lower_ref_matches = closest_to_reference(df, reference_vals[0], max_dist_from_refs[0], reference_col, group_by_col, value_col, 'below')</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Find matches for higher reference value</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     higher_ref_matches = closest_to_reference(df, reference_vals[1], max_dist_from_refs[1], reference_col, group_by_col, value_col, 'above')</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Merge the two sets of matches</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     merged_df = pd.merge(lower_ref_matches, higher_ref_matches, on=group_by_col, suffixes=(reference_vals[0], reference_vals[1]))</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Drop obs that do not have data for both ref values</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     merged_df = merged_df.dropna()</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Drop obs where the matched data does not meet the min distance requirement</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     if not pd.isna(min_dist_between):</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       # Store the names of the reference column returned from the two matches</span></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       ref_var_high = f'{reference_col}{reference_vals[1]}'</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       ref_var_low = f'{reference_col}{reference_vals[0]}'</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      # Keep only rows &gt;= to the min distance</span></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       merged_df = merged_df.loc[(merged_df[ref_var_high] - merged_df[ref_var_low]) &gt;= min_dist_between, :]</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     return merged_df</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   def pip_welfare_routine(df, reference_vals, max_dist_from_refs, min_dist_between, reference_col, group_by_col, value_col):</span></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Specify the name of the column in which the income/consumption welfare definition is stored</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     welfare_colname = 'welfare_type'</span></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Creat dataframes for thee scenarios:</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Scenario 1: only allow income data</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_inc_filter = df.loc[df[welfare_colname] == "income", :]</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_inc_filter.name = "Income"</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Scenario 2: only allow consumption data</span></span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_cons_filter = df.loc[df[welfare_colname] == "consumption", :]</span></span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_cons_filter.name = "Consumption"</span></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Scenario 3: allow a mix – dropping consumption data where income data is available in the same year</span></span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_mixed = df.copy()</span></span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_mixed['welfare_count'] = df_mixed.groupby([reference_col, group_by_col])[welfare_colname].transform('count')</span></span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_mixed = df_mixed.loc[(df_mixed['welfare_count'] == 1) | (df_mixed[welfare_colname] == "income")]</span></span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_mixed.name = "Mixed"</span></span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     #  Store the scneario dataframes in a list</span></span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_scenarios = [df_inc_filter, df_cons_filter, df_mixed]</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Run the matching function on each scenario</span></span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     scenario_matches = [merge_two_ref_matches(</span></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       df_scenario, </span></span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       reference_vals, </span></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       max_dist_from_refs, </span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       min_dist_between, </span></span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       reference_col, </span></span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       group_by_col, </span></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>      <span class="co">#       value_col) for df_scenario in df_scenarios]</span></span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Combine the first two scenarios.</span></span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = pd.concat([scenario_matches[0], scenario_matches[1]], keys=[df_scenarios[0].name, df_scenarios[1].name])</span></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Tidy up indexes</span></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches.reset_index()</span></span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches.drop('level_1', axis=1)</span></span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches\</span></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>      <span class="co">#         .rename(columns={"level_0": "pip_welfare"})</span></span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Add in third scenario.</span></span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = pd.concat([df_combined_matches, scenario_matches[2]])</span></span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # add scenario name to te pip_welfare column</span></span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches['pip_welfare'] = df_combined_matches['pip_welfare'].fillna(df_scenarios[2].name)</span></span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Keep only one match per group (e.g. per Country) - in the priority laid out in the df_scenarios list above (income only -&gt; consumption only -&gt; mixed)</span></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # First count the matches</span></span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches['match_count'] =        df_combined_matches.groupby(group_by_col)['pip_welfare'].transform('count')</span></span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Then drop any matches from the lowest priority where there are multiple matches</span></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches.loc[(df_combined_matches['match_count']==1) | ~(df_combined_matches['pip_welfare']==df_scenarios[2].name)]</span></span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     #  Repeat at the next level of priority</span></span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches['match_count'] = df_combined_matches.groupby(group_by_col)['pip_welfare'].transform('count')</span></span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches.loc[(df_combined_matches['match_count']==1) | ~(df_combined_matches['pip_welfare']==df_scenarios[1].name)]</span></span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     # Drop the match count column</span></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     df_combined_matches = df_combined_matches.drop('match_count', axis=1)</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>      <span class="co">#     return df_combined_matches</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>